{
  "doc_name": "earthmover.pdf",
  "doc_description": "The document focuses on optimizing the refinement phase of Earth Mover’s Distance (EMD)-based similarity search in large-scale databases. EMD is a powerful similarity measure for multidimensional histograms, widely used in multimedia, computer vision, and probabilistic databases, but its high computational cost poses scalability challenges. While prior work emphasizes filtering techniques to reduce the number of EMD computations, the refinement step remains a bottleneck. The paper proposes three key contributions: (i) adapting an efficient min-cost flow algorithm (SIA) for faster EMD computation, (ii) introducing a dynamic distance bound to terminate refinement early, and (iii) proposing a dynamic refinement order with concurrent execution to minimize redundant calculations. These techniques are orthogonal to existing filtering methods and together significantly reduce the overall cost of EMD-based similarity queries, enabling scalability to large datasets with high-dimensional histograms.",
  "structure": [
    {
      "title": "Earth Mover’s Distance based Similarity Search at Scale",
      "start_index": 1,
      "end_index": 1,
      "nodes": [],
      "node_id": "0000",
      "text": "Earth Mover’s Distance based Similarity Search at Scale\nYu Tang†, Leong Hou U‡, Yilun Cai†, Nikos Mamoulis†, Reynold Cheng†\n†TheUniversityofHongKong ‡UniversityofMacau\n†{ytang, ylcai, nikos, ckcheng}@cs.hku.hk ‡ryanlhu@umac.mo\nABSTRACT EMD-basedsimilaritysearchhasbeenextensivelystudiedin[5,\n25,30,32].Givenaqueryhistogramqandadatabaseofhistogram\nEarth Mover’s Distance (EMD), as a similarity measure, has re-\nobjectsD,theobjectiveistofindthek nearestneighborsofqin\nceivedalotofattentioninthefieldsofmultimediaandprobabilis-\nD. Alltheseworksadoptthefilter-and-refinementframework; to\nticdatabases,computervision,imageretrieval,machinelearning,\nevaluate a query, unpromising objects (or object groups) are fil-\netc. EMDonmultidimensionalhistogramsprovidesbetterdistin-\nteredout,byutilizingvariouseffectiveEMDlowerboundestima-\nguishability between the objects approximated by the histograms\ntions, based on centroids and projections [7], dimensionality re-\n(e.g., images), compared to classic measures like Euclidean dis-\nduction[30],primal-dualspace[32],normaldistributions[25],etc.\ntance. Despiteitsusefulness,EMDhasahighcomputationalcost;\nActualEMDcalculations1 areappliedonlybetweenqandallob-\ntherefore, a number of effective filtering methods have been pro-\njectsthatsurvivethefilterstep.Thus,theprimaryfocusofprevious\nposed,toreducethepairsofhistogramsforwhichtheexactEMD\nresearchhasbeenintighteningthelowerboundssuchthatmoreob-\nhas to be computed, during similarity search. Still, EMD calcu-\njectscanbeprunedatthefilterstep.Forinstance,[25]demonstrate\nlations in the refinement step remain the bottleneck of the whole\nthattheprojection-basedlowerboundcanbeupto90%oftheac-\nsimilaritysearchprocess.Inthispaper,wefocusonoptimizingthe\ntual EMD. However, the effectiveness of a lower bound largely\nrefinementphaseofEMD-basedsimilaritysearchby(i)adapting\ndepends on various factors, such as the dimensionality and gran-\nanefficientmin-costflowalgorithm(SIA)forEMDcomputation,\nularityofhistograms, thedatadistribution, andtheparametersof\n(ii)proposingadynamicdistancebound,whichcanbeusedtoter-\nthesimilarityquery(e.g.,k). Inparticular,forlarge-scaledatasets\nminateanEMDrefinementearly,and(iii)proposingadynamicre-\n(e.g.,1Mcardinalityand/or1Khistogramdimensionality),thecur-\nfinementorderforthecandidateswhich,pairedwithaconcurrent\nrentstate-of-the-artsolution[25]isnotfeasible,duetotheextreme\nEMDrefinementstrategy,reducestheamountofneedlesscompu-\ncostoftherefinementstep.Forinstance,basedontheexperiments\ntations.Ourproposedtechniquesareorthogonaltoandcanbeeas-\nin[25],itmaytake10minutes2tocompleteonek-NNqueryona\nilyintegratedwiththestate-of-the-artfilteringtechniques,reducing\ndatasetwith1Mobjectsevenwhen99%ofobjectsarefilteredout.\nthecostofEMD-basedsimilarityqueriesbyordersofmagnitude.\nIn view of this, we focus on optimizing the refinement phase\nof EMD-based similarity search. Calculating the EMD between\n1. INTRODUCTION\ntwo object histograms is equivalent to finding the minimum-cost\nGiven two histograms (e.g., probability distributions), their flow (MCF) in a bipartite network, where each vertex indicates a\nEarthMover’sDistance(EMD)isdefinedastheminimumamount histogram bin and edges connect bins from different object his-\nofworktotransformonehistogramintotheother. EMDisrobust tograms.Techniquesfromoperationsresearch[1],suchasnetwork\nto outliers and small shifts of values among histogram bins [20], simplex,primal-dual,successiveshortestpath,andcost-scalingcan\nimprovingthequality ofsimilaritysearchindifferent domain ar- beusedtosolveMCF. However,thesesolutionsdonotscalewell\neas,suchascomputervision[19,21],machinelearning[6,9],in- with the number of histogram bins since their computations rely\nformationretrieval[23,24], probabilistic[25,32]andmultimedia on a complete bipartite network. For example, consider two his-\ndatabases[5,30]. Typically,theEMDbetweentwohistogramsis tograms having 1K bins each, and the corresponding flow graph\nmodeledandsolvedasalinearoptimizationproblem,themin-cost (bipartitenetwork)with1M(1K×1K)edgesintotal.Constructing\nflowproblem,whichrequiressuper-cubictime. Thehighcompu- andusingthisgraphforsolvingMCFrequireshighcomputational\ntationalcostofEMDrestrictsitsapplicabilitytodatasetsoflow- resources. Toalleviatethisproblem, weadaptasimplifiedgraph\nscale. Forexample,incomputervisionapplications,thequalityof incrementalalgorithm(SIA),originallyproposedforassignment-\nresultsistypicallycompromisedbytheuseoflow-granularityhis- joinsinspatialdatabases[29],whichincrementallyconstructsthe\ntograms,torenderEMD-basedsimilarityretrievalfeasible[22,30]. flowgraphduringtheflowcalculationsbasedontheedgeweights.\nOuradaptationsignificantlyreducestheEMDcomputationtime.\nMin-cost flow algorithms, such as SIA, only aim at efficiently\nevaluatingasingleEMDcomputationbuttheydonotexploitthe\nThis work is licensed under the Creative Commons Attribution-\nNonCommercial-NoDerivs3.0UnportedLicense.Toviewacopyofthisli- executionplanofEMD-basedsimilarityqueries. Inotherwords,\ncense,visithttp://creativecommons.org/licenses/by-nc-nd/3.0/.Obtainper- by integrating SIA into the filter-and-refinement framework as a\nmission prior to any use beyond those covered by the license. Contact black-boxmodule,thenumberofEMDcalculationsisnotaffected,\ncopyright holder by emailing info@vldb.org. Articles from this volume\nwereinvitedtopresenttheirresultsatthe40thInternationalConferenceon 1ByEMDcalculationwerefertotheentirerunofanalgorithmic\nVeryLargeDataBases,September1st-5th2014,Hangzhou,China.\nprocessthatcomputestheEMDbetweentwohistograms.\nProceedingsoftheVLDBEndowment,Vol.7,No.4\nCopyright2013VLDBEndowment2150-8097/13/12.\n2AlinearestimationderivedfromtheIRMAexperimentin[25].\n313\n",
      "summary": "This paper optimizes the refinement phase of Earth Mover’s Distance (EMD)-based similarity search in large-scale, high-dimensional histogram databases by adapting an efficient min-cost flow algorithm, proposing a dynamic distance bound for early termination, and introducing a dynamic refinement order with concurrent processing to reduce computational overhead."
    },
    {
      "title": "ABSTRACT",
      "start_index": 1,
      "end_index": 1,
      "nodes": [],
      "node_id": "0001",
      "text": "Earth Mover’s Distance based Similarity Search at Scale\nYu Tang†, Leong Hou U‡, Yilun Cai†, Nikos Mamoulis†, Reynold Cheng†\n†TheUniversityofHongKong ‡UniversityofMacau\n†{ytang, ylcai, nikos, ckcheng}@cs.hku.hk ‡ryanlhu@umac.mo\nABSTRACT EMD-basedsimilaritysearchhasbeenextensivelystudiedin[5,\n25,30,32].Givenaqueryhistogramqandadatabaseofhistogram\nEarth Mover’s Distance (EMD), as a similarity measure, has re-\nobjectsD,theobjectiveistofindthek nearestneighborsofqin\nceivedalotofattentioninthefieldsofmultimediaandprobabilis-\nD. Alltheseworksadoptthefilter-and-refinementframework; to\nticdatabases,computervision,imageretrieval,machinelearning,\nevaluate a query, unpromising objects (or object groups) are fil-\netc. EMDonmultidimensionalhistogramsprovidesbetterdistin-\nteredout,byutilizingvariouseffectiveEMDlowerboundestima-\nguishability between the objects approximated by the histograms\ntions, based on centroids and projections [7], dimensionality re-\n(e.g., images), compared to classic measures like Euclidean dis-\nduction[30],primal-dualspace[32],normaldistributions[25],etc.\ntance. Despiteitsusefulness,EMDhasahighcomputationalcost;\nActualEMDcalculations1 areappliedonlybetweenqandallob-\ntherefore, a number of effective filtering methods have been pro-\njectsthatsurvivethefilterstep.Thus,theprimaryfocusofprevious\nposed,toreducethepairsofhistogramsforwhichtheexactEMD\nresearchhasbeenintighteningthelowerboundssuchthatmoreob-\nhas to be computed, during similarity search. Still, EMD calcu-\njectscanbeprunedatthefilterstep.Forinstance,[25]demonstrate\nlations in the refinement step remain the bottleneck of the whole\nthattheprojection-basedlowerboundcanbeupto90%oftheac-\nsimilaritysearchprocess.Inthispaper,wefocusonoptimizingthe\ntual EMD. However, the effectiveness of a lower bound largely\nrefinementphaseofEMD-basedsimilaritysearchby(i)adapting\ndepends on various factors, such as the dimensionality and gran-\nanefficientmin-costflowalgorithm(SIA)forEMDcomputation,\nularityofhistograms, thedatadistribution, andtheparametersof\n(ii)proposingadynamicdistancebound,whichcanbeusedtoter-\nthesimilarityquery(e.g.,k). Inparticular,forlarge-scaledatasets\nminateanEMDrefinementearly,and(iii)proposingadynamicre-\n(e.g.,1Mcardinalityand/or1Khistogramdimensionality),thecur-\nfinementorderforthecandidateswhich,pairedwithaconcurrent\nrentstate-of-the-artsolution[25]isnotfeasible,duetotheextreme\nEMDrefinementstrategy,reducestheamountofneedlesscompu-\ncostoftherefinementstep.Forinstance,basedontheexperiments\ntations.Ourproposedtechniquesareorthogonaltoandcanbeeas-\nin[25],itmaytake10minutes2tocompleteonek-NNqueryona\nilyintegratedwiththestate-of-the-artfilteringtechniques,reducing\ndatasetwith1Mobjectsevenwhen99%ofobjectsarefilteredout.\nthecostofEMD-basedsimilarityqueriesbyordersofmagnitude.\nIn view of this, we focus on optimizing the refinement phase\nof EMD-based similarity search. Calculating the EMD between\n1. INTRODUCTION\ntwo object histograms is equivalent to finding the minimum-cost\nGiven two histograms (e.g., probability distributions), their flow (MCF) in a bipartite network, where each vertex indicates a\nEarthMover’sDistance(EMD)isdefinedastheminimumamount histogram bin and edges connect bins from different object his-\nofworktotransformonehistogramintotheother. EMDisrobust tograms.Techniquesfromoperationsresearch[1],suchasnetwork\nto outliers and small shifts of values among histogram bins [20], simplex,primal-dual,successiveshortestpath,andcost-scalingcan\nimprovingthequality ofsimilaritysearchindifferent domain ar- beusedtosolveMCF. However,thesesolutionsdonotscalewell\neas,suchascomputervision[19,21],machinelearning[6,9],in- with the number of histogram bins since their computations rely\nformationretrieval[23,24], probabilistic[25,32]andmultimedia on a complete bipartite network. For example, consider two his-\ndatabases[5,30]. Typically,theEMDbetweentwohistogramsis tograms having 1K bins each, and the corresponding flow graph\nmodeledandsolvedasalinearoptimizationproblem,themin-cost (bipartitenetwork)with1M(1K×1K)edgesintotal.Constructing\nflowproblem,whichrequiressuper-cubictime. Thehighcompu- andusingthisgraphforsolvingMCFrequireshighcomputational\ntationalcostofEMDrestrictsitsapplicabilitytodatasetsoflow- resources. Toalleviatethisproblem, weadaptasimplifiedgraph\nscale. Forexample,incomputervisionapplications,thequalityof incrementalalgorithm(SIA),originallyproposedforassignment-\nresultsistypicallycompromisedbytheuseoflow-granularityhis- joinsinspatialdatabases[29],whichincrementallyconstructsthe\ntograms,torenderEMD-basedsimilarityretrievalfeasible[22,30]. flowgraphduringtheflowcalculationsbasedontheedgeweights.\nOuradaptationsignificantlyreducestheEMDcomputationtime.\nMin-cost flow algorithms, such as SIA, only aim at efficiently\nevaluatingasingleEMDcomputationbuttheydonotexploitthe\nThis work is licensed under the Creative Commons Attribution-\nNonCommercial-NoDerivs3.0UnportedLicense.Toviewacopyofthisli- executionplanofEMD-basedsimilarityqueries. Inotherwords,\ncense,visithttp://creativecommons.org/licenses/by-nc-nd/3.0/.Obtainper- by integrating SIA into the filter-and-refinement framework as a\nmission prior to any use beyond those covered by the license. Contact black-boxmodule,thenumberofEMDcalculationsisnotaffected,\ncopyright holder by emailing info@vldb.org. Articles from this volume\nwereinvitedtopresenttheirresultsatthe40thInternationalConferenceon 1ByEMDcalculationwerefertotheentirerunofanalgorithmic\nVeryLargeDataBases,September1st-5th2014,Hangzhou,China.\nprocessthatcomputestheEMDbetweentwohistograms.\nProceedingsoftheVLDBEndowment,Vol.7,No.4\nCopyright2013VLDBEndowment2150-8097/13/12.\n2AlinearestimationderivedfromtheIRMAexperimentin[25].\n313\n",
      "summary": "This paper optimizes the refinement phase of Earth Mover’s Distance (EMD)-based similarity search by adapting an efficient min-cost flow algorithm, proposing a dynamic distance bound for early termination, and introducing a dynamic refinement order with concurrent processing to reduce computational overhead, especially for large-scale, high-dimensional datasets."
    },
    {
      "title": "1. INTRODUCTION",
      "start_index": 1,
      "end_index": 2,
      "nodes": [],
      "node_id": "0002",
      "text": "Earth Mover’s Distance based Similarity Search at Scale\nYu Tang†, Leong Hou U‡, Yilun Cai†, Nikos Mamoulis†, Reynold Cheng†\n†TheUniversityofHongKong ‡UniversityofMacau\n†{ytang, ylcai, nikos, ckcheng}@cs.hku.hk ‡ryanlhu@umac.mo\nABSTRACT EMD-basedsimilaritysearchhasbeenextensivelystudiedin[5,\n25,30,32].Givenaqueryhistogramqandadatabaseofhistogram\nEarth Mover’s Distance (EMD), as a similarity measure, has re-\nobjectsD,theobjectiveistofindthek nearestneighborsofqin\nceivedalotofattentioninthefieldsofmultimediaandprobabilis-\nD. Alltheseworksadoptthefilter-and-refinementframework; to\nticdatabases,computervision,imageretrieval,machinelearning,\nevaluate a query, unpromising objects (or object groups) are fil-\netc. EMDonmultidimensionalhistogramsprovidesbetterdistin-\nteredout,byutilizingvariouseffectiveEMDlowerboundestima-\nguishability between the objects approximated by the histograms\ntions, based on centroids and projections [7], dimensionality re-\n(e.g., images), compared to classic measures like Euclidean dis-\nduction[30],primal-dualspace[32],normaldistributions[25],etc.\ntance. Despiteitsusefulness,EMDhasahighcomputationalcost;\nActualEMDcalculations1 areappliedonlybetweenqandallob-\ntherefore, a number of effective filtering methods have been pro-\njectsthatsurvivethefilterstep.Thus,theprimaryfocusofprevious\nposed,toreducethepairsofhistogramsforwhichtheexactEMD\nresearchhasbeenintighteningthelowerboundssuchthatmoreob-\nhas to be computed, during similarity search. Still, EMD calcu-\njectscanbeprunedatthefilterstep.Forinstance,[25]demonstrate\nlations in the refinement step remain the bottleneck of the whole\nthattheprojection-basedlowerboundcanbeupto90%oftheac-\nsimilaritysearchprocess.Inthispaper,wefocusonoptimizingthe\ntual EMD. However, the effectiveness of a lower bound largely\nrefinementphaseofEMD-basedsimilaritysearchby(i)adapting\ndepends on various factors, such as the dimensionality and gran-\nanefficientmin-costflowalgorithm(SIA)forEMDcomputation,\nularityofhistograms, thedatadistribution, andtheparametersof\n(ii)proposingadynamicdistancebound,whichcanbeusedtoter-\nthesimilarityquery(e.g.,k). Inparticular,forlarge-scaledatasets\nminateanEMDrefinementearly,and(iii)proposingadynamicre-\n(e.g.,1Mcardinalityand/or1Khistogramdimensionality),thecur-\nfinementorderforthecandidateswhich,pairedwithaconcurrent\nrentstate-of-the-artsolution[25]isnotfeasible,duetotheextreme\nEMDrefinementstrategy,reducestheamountofneedlesscompu-\ncostoftherefinementstep.Forinstance,basedontheexperiments\ntations.Ourproposedtechniquesareorthogonaltoandcanbeeas-\nin[25],itmaytake10minutes2tocompleteonek-NNqueryona\nilyintegratedwiththestate-of-the-artfilteringtechniques,reducing\ndatasetwith1Mobjectsevenwhen99%ofobjectsarefilteredout.\nthecostofEMD-basedsimilarityqueriesbyordersofmagnitude.\nIn view of this, we focus on optimizing the refinement phase\nof EMD-based similarity search. Calculating the EMD between\n1. INTRODUCTION\ntwo object histograms is equivalent to finding the minimum-cost\nGiven two histograms (e.g., probability distributions), their flow (MCF) in a bipartite network, where each vertex indicates a\nEarthMover’sDistance(EMD)isdefinedastheminimumamount histogram bin and edges connect bins from different object his-\nofworktotransformonehistogramintotheother. EMDisrobust tograms.Techniquesfromoperationsresearch[1],suchasnetwork\nto outliers and small shifts of values among histogram bins [20], simplex,primal-dual,successiveshortestpath,andcost-scalingcan\nimprovingthequality ofsimilaritysearchindifferent domain ar- beusedtosolveMCF. However,thesesolutionsdonotscalewell\neas,suchascomputervision[19,21],machinelearning[6,9],in- with the number of histogram bins since their computations rely\nformationretrieval[23,24], probabilistic[25,32]andmultimedia on a complete bipartite network. For example, consider two his-\ndatabases[5,30]. Typically,theEMDbetweentwohistogramsis tograms having 1K bins each, and the corresponding flow graph\nmodeledandsolvedasalinearoptimizationproblem,themin-cost (bipartitenetwork)with1M(1K×1K)edgesintotal.Constructing\nflowproblem,whichrequiressuper-cubictime. Thehighcompu- andusingthisgraphforsolvingMCFrequireshighcomputational\ntationalcostofEMDrestrictsitsapplicabilitytodatasetsoflow- resources. Toalleviatethisproblem, weadaptasimplifiedgraph\nscale. Forexample,incomputervisionapplications,thequalityof incrementalalgorithm(SIA),originallyproposedforassignment-\nresultsistypicallycompromisedbytheuseoflow-granularityhis- joinsinspatialdatabases[29],whichincrementallyconstructsthe\ntograms,torenderEMD-basedsimilarityretrievalfeasible[22,30]. flowgraphduringtheflowcalculationsbasedontheedgeweights.\nOuradaptationsignificantlyreducestheEMDcomputationtime.\nMin-cost flow algorithms, such as SIA, only aim at efficiently\nevaluatingasingleEMDcomputationbuttheydonotexploitthe\nThis work is licensed under the Creative Commons Attribution-\nNonCommercial-NoDerivs3.0UnportedLicense.Toviewacopyofthisli- executionplanofEMD-basedsimilarityqueries. Inotherwords,\ncense,visithttp://creativecommons.org/licenses/by-nc-nd/3.0/.Obtainper- by integrating SIA into the filter-and-refinement framework as a\nmission prior to any use beyond those covered by the license. Contact black-boxmodule,thenumberofEMDcalculationsisnotaffected,\ncopyright holder by emailing info@vldb.org. Articles from this volume\nwereinvitedtopresenttheirresultsatthe40thInternationalConferenceon 1ByEMDcalculationwerefertotheentirerunofanalgorithmic\nVeryLargeDataBases,September1st-5th2014,Hangzhou,China.\nprocessthatcomputestheEMDbetweentwohistograms.\nProceedingsoftheVLDBEndowment,Vol.7,No.4\nCopyright2013VLDBEndowment2150-8097/13/12.\n2AlinearestimationderivedfromtheIRMAexperimentin[25].\n313\nandeverycalculationisstillconductedatitsentirety. Inourstudy, emd(q,p)istheminimumcostneededtotransformqtop;to\nwe observe that it is possible to incrementally derive and tighten doso,wedistributetheflow(i.e.,earth)fromeachbinq toaset\ni\na running lower bound for the EMD during the SIA calculation. ofinitiallyemptybinsforp,suchthattheresultinghistogramwill\nBasedonthis,weintroduceaprogressivebounding(PB)technique, be equal to p. As moving earth f from q to the j-th bin of\ni,j i\nwhichcanterminatetheSIAcalculationsearlyforhistogramsthat pbearsacostf c ,theobjectiveistofindtheflowdistribution\ni,j i,j\nare no longer promising to the similarity query. In addition, we thatresultsintheminimumtotalcost.Notethatemd(q,p)isequal\npropose a dynamic refinement ordering (DRO) technique, which toemd(p,q)whenthecostmatrixCissymmetric.\nconcurrentlyhandlesanddynamicallyre-ordersmultipleEMDcal- WedemonstratethecalculationandapplicabilityofEMDviaa\nculations.Thesetwotechniquesgreatlyreducethecomputationsat realexamplefromwebdataanalysis.Figure1(a)and1(b)illustrate\ntherefinementphaseofEMD-basedsimilaritysearch,boostingthe thedownloadratesoffourmusicgenresbytwocustomers,qand\nsearchperformance. p,inanonlinestore. Theratesarenormalizedsuchthatallvalues\nPBandDROcanbeseamlesslyintegratedwithanyexisting(and ofeachhistogramsumto10. Tocalculatethedistanceemd(q,p)\nfuture)filteringtechniques. Weshowbyexperimentationthatour betweenthetwocustomers,weshouldidentifytheminimumwork\ntechniquescancomputeEMD-basedsimilarityqueriesonetotwo totransformgenredistributionqtodistributionp.Assumethatthe\norders of magnitude faster, compared to the current state-of-the- costmatrixCofthemusicgenresisasshowninTable1, where\nart [25]. To the best of our knowledge, ours is the first study on indices1,2,3,4denotethefourmusicgenres(i.e.,R&B,Samba,\nthis subject that considers datasets of million-scale on the object Jazz,andHouse,respectively).Figure1(c)illustratesthebesttrans-\ncardinalityandthousand-scaleonthehistogramdimensionality. formation of q to p in terms of the total cost among all feasible\nTherestofthepaperisorganizedasfollows.Section2formally transformations. Forinstance,thereare3unitsinq’sR&Bgenre.\ndefines EMD, presents a min-cost flow algorithm for its compu- Inthetransformation,f = 2unitsaremovedtop’sR&B(with\n1,1\ntation,anddiscussesthestandardfilter-and-refinementframework cost2·c =0)andf =1unitismovedtop’sJazz(withcost\n1,1 1,3\nusedforEMD-basedsimilarityqueries.Section3describesSIA,an 1·c =0.1).Thus,basedonthebesttransformation,emd(q,p)\n1,3\noptimizedimplementationofthesuccessiveshortestpathMCFal- is0.1+2.4+0+0=2.5,providingaquantitativemeasureforthe\ngorithm.Section4presentsourprogressiveboundinganddynamic dissimilaritybetweenthesetwocustomers. Thisexampledemon-\nrefinementorderingtechniques.Section5includesanextensiveex- strates an application of EMD to viral marketing analysis, which\nperimentalevaluationwhichdemonstratestheeffectivenessofour enablesenterprisestoderivesimilaritiesbetweencustomersinor-\ntechniques. RelatedworkispresentedinSection6. Finally,Sec- dertopromotetheirproducts.\ntion7concludesthepaperwithadiscussionaboutfuturework.\n2. PRELIMINARIES\nTheEarthMover’sDistance(EMD),firstintroducedbythecom-\n4\nputervisioncommunityin[23,24],isadistancefunctionthatmea- 3\nsuresthedissimilarityoftwohistograms(e.g.,probabilityorfea- 2\n1\nture distributions). Given two histograms q = (q ,...,q ) and\n1 n p=(p ,...,p ),eachhavingnbins,aflowmatrixF,wheref 1 n i,j\nindicatesflow(i.e.,earth)tomovefromq top ,andacostmatrix\ni j\nC,wherec modelscostofmovingflowfromthei-thbintothe i,j\nj-thbin,wecandefinethetotalcostofmovingunitflowaccording\ntoFandCbetweenqandpas\nn n\n(cid:88)(cid:88)\nd(q,p)= f c (1)\ni,j i,j\ni=1j=1\nThe cost matrix (a.k.a., ground distance) C can be designed by\ndomain experts and/or derived from a mathematical formula [25,\n32]. Intuitively,c =0andthelargerthedistancebetweeniand\ni,i\nj inthebinspace, thelargerc is.3 Assumingthatqandpare\ni,j\nnormalized such that\n(cid:80)n\nq =\n(cid:80)n\np , the EMD between q\ni=1 i i=1 i\nandpisformallydefinedasfollows:\nemd(q,p)=mind(q,p),\nF\nsuchthat ∀i,j ∈[1,n]:f ≥0, i,j\nn\n(cid:88) ∀i∈[1,n]: f =q ,\ni,j i\nj=1\nn\n(cid:88)\nand ∀j ∈[1,n]: f =p (2) i,j j\ni=1\n3Themotivatingexampleof[32]partitionsa2-dimensionalfeature\nspace(humidityandtemperature)into4×4cellsbasedontherange\nofdomainvalues.Thecostc betweenbinsiandjisrepresented\ni,j\nbytheirEuclideandistanceofthecorrespondingcells.\nsetar\ndaolnwoD\nR & B Sam ba Jazz H ou se\n(a) q’sdistribution\nsetar\ndaolnwoD\n4\n3\n2\n1\nR & B Sam ba Jazz H ou se\n(b) p’sdistribution\nsetar\ndaolnwoD\nR & B Sam ba Jazz H ou se\n(c) emd(q,p)\nFigure1:Aconcreteexampleofonlinemusiclibraryanalysis\nTable1:CostmatrixCof4musicgenres\np1 p2 p3 p4\nq1 0 0.9 0.1 0.7\nq2 0.9 0 0.6 0.9\nq3 0.1 0.6 0 0.3\nq4 0.7 0.9 0.3 0\nq p q p q p\n3 q 1 p 1 2 0 q 1 2/2 p 1 0 1 q 1 2/2 p 1 0\n1/3 0/3\n4 q 2 p 2 1 0 q 2 1/1 p 2 0 0 q 2 1/1 p 2 0\n2/31/4 1/32/4\n2 q 3 p 3 4 0 q 3 2/2 p 3 0 0 q 3 2/2 p 3 0\n1 q 4 p 4 3 0 q 4 1/1 p 4 0 0 q 4 1/1 p 4 1\n(a) Flowgraph (b) Min-costflow (c) Feasiblepath\nFigure2:Theflownetworkofthemusicexample\n314\n",
      "summary": "This paper optimizes the refinement phase of Earth Mover’s Distance (EMD)-based similarity search by adapting an efficient min-cost flow algorithm, proposing a dynamic distance bound for early termination, and introducing a dynamic refinement order with concurrent processing to reduce computational overhead, especially for large-scale, high-dimensional datasets."
    },
    {
      "title": "2. PRELIMINARIES",
      "start_index": 2,
      "end_index": 3,
      "nodes": [],
      "node_id": "0003",
      "text": "andeverycalculationisstillconductedatitsentirety. Inourstudy, emd(q,p)istheminimumcostneededtotransformqtop;to\nwe observe that it is possible to incrementally derive and tighten doso,wedistributetheflow(i.e.,earth)fromeachbinq toaset\ni\na running lower bound for the EMD during the SIA calculation. ofinitiallyemptybinsforp,suchthattheresultinghistogramwill\nBasedonthis,weintroduceaprogressivebounding(PB)technique, be equal to p. As moving earth f from q to the j-th bin of\ni,j i\nwhichcanterminatetheSIAcalculationsearlyforhistogramsthat pbearsacostf c ,theobjectiveistofindtheflowdistribution\ni,j i,j\nare no longer promising to the similarity query. In addition, we thatresultsintheminimumtotalcost.Notethatemd(q,p)isequal\npropose a dynamic refinement ordering (DRO) technique, which toemd(p,q)whenthecostmatrixCissymmetric.\nconcurrentlyhandlesanddynamicallyre-ordersmultipleEMDcal- WedemonstratethecalculationandapplicabilityofEMDviaa\nculations.Thesetwotechniquesgreatlyreducethecomputationsat realexamplefromwebdataanalysis.Figure1(a)and1(b)illustrate\ntherefinementphaseofEMD-basedsimilaritysearch,boostingthe thedownloadratesoffourmusicgenresbytwocustomers,qand\nsearchperformance. p,inanonlinestore. Theratesarenormalizedsuchthatallvalues\nPBandDROcanbeseamlesslyintegratedwithanyexisting(and ofeachhistogramsumto10. Tocalculatethedistanceemd(q,p)\nfuture)filteringtechniques. Weshowbyexperimentationthatour betweenthetwocustomers,weshouldidentifytheminimumwork\ntechniquescancomputeEMD-basedsimilarityqueriesonetotwo totransformgenredistributionqtodistributionp.Assumethatthe\norders of magnitude faster, compared to the current state-of-the- costmatrixCofthemusicgenresisasshowninTable1, where\nart [25]. To the best of our knowledge, ours is the first study on indices1,2,3,4denotethefourmusicgenres(i.e.,R&B,Samba,\nthis subject that considers datasets of million-scale on the object Jazz,andHouse,respectively).Figure1(c)illustratesthebesttrans-\ncardinalityandthousand-scaleonthehistogramdimensionality. formation of q to p in terms of the total cost among all feasible\nTherestofthepaperisorganizedasfollows.Section2formally transformations. Forinstance,thereare3unitsinq’sR&Bgenre.\ndefines EMD, presents a min-cost flow algorithm for its compu- Inthetransformation,f = 2unitsaremovedtop’sR&B(with\n1,1\ntation,anddiscussesthestandardfilter-and-refinementframework cost2·c =0)andf =1unitismovedtop’sJazz(withcost\n1,1 1,3\nusedforEMD-basedsimilarityqueries.Section3describesSIA,an 1·c =0.1).Thus,basedonthebesttransformation,emd(q,p)\n1,3\noptimizedimplementationofthesuccessiveshortestpathMCFal- is0.1+2.4+0+0=2.5,providingaquantitativemeasureforthe\ngorithm.Section4presentsourprogressiveboundinganddynamic dissimilaritybetweenthesetwocustomers. Thisexampledemon-\nrefinementorderingtechniques.Section5includesanextensiveex- strates an application of EMD to viral marketing analysis, which\nperimentalevaluationwhichdemonstratestheeffectivenessofour enablesenterprisestoderivesimilaritiesbetweencustomersinor-\ntechniques. RelatedworkispresentedinSection6. Finally,Sec- dertopromotetheirproducts.\ntion7concludesthepaperwithadiscussionaboutfuturework.\n2. PRELIMINARIES\nTheEarthMover’sDistance(EMD),firstintroducedbythecom-\n4\nputervisioncommunityin[23,24],isadistancefunctionthatmea- 3\nsuresthedissimilarityoftwohistograms(e.g.,probabilityorfea- 2\n1\nture distributions). Given two histograms q = (q ,...,q ) and\n1 n p=(p ,...,p ),eachhavingnbins,aflowmatrixF,wheref 1 n i,j\nindicatesflow(i.e.,earth)tomovefromq top ,andacostmatrix\ni j\nC,wherec modelscostofmovingflowfromthei-thbintothe i,j\nj-thbin,wecandefinethetotalcostofmovingunitflowaccording\ntoFandCbetweenqandpas\nn n\n(cid:88)(cid:88)\nd(q,p)= f c (1)\ni,j i,j\ni=1j=1\nThe cost matrix (a.k.a., ground distance) C can be designed by\ndomain experts and/or derived from a mathematical formula [25,\n32]. Intuitively,c =0andthelargerthedistancebetweeniand\ni,i\nj inthebinspace, thelargerc is.3 Assumingthatqandpare\ni,j\nnormalized such that\n(cid:80)n\nq =\n(cid:80)n\np , the EMD between q\ni=1 i i=1 i\nandpisformallydefinedasfollows:\nemd(q,p)=mind(q,p),\nF\nsuchthat ∀i,j ∈[1,n]:f ≥0, i,j\nn\n(cid:88) ∀i∈[1,n]: f =q ,\ni,j i\nj=1\nn\n(cid:88)\nand ∀j ∈[1,n]: f =p (2) i,j j\ni=1\n3Themotivatingexampleof[32]partitionsa2-dimensionalfeature\nspace(humidityandtemperature)into4×4cellsbasedontherange\nofdomainvalues.Thecostc betweenbinsiandjisrepresented\ni,j\nbytheirEuclideandistanceofthecorrespondingcells.\nsetar\ndaolnwoD\nR & B Sam ba Jazz H ou se\n(a) q’sdistribution\nsetar\ndaolnwoD\n4\n3\n2\n1\nR & B Sam ba Jazz H ou se\n(b) p’sdistribution\nsetar\ndaolnwoD\nR & B Sam ba Jazz H ou se\n(c) emd(q,p)\nFigure1:Aconcreteexampleofonlinemusiclibraryanalysis\nTable1:CostmatrixCof4musicgenres\np1 p2 p3 p4\nq1 0 0.9 0.1 0.7\nq2 0.9 0 0.6 0.9\nq3 0.1 0.6 0 0.3\nq4 0.7 0.9 0.3 0\nq p q p q p\n3 q 1 p 1 2 0 q 1 2/2 p 1 0 1 q 1 2/2 p 1 0\n1/3 0/3\n4 q 2 p 2 1 0 q 2 1/1 p 2 0 0 q 2 1/1 p 2 0\n2/31/4 1/32/4\n2 q 3 p 3 4 0 q 3 2/2 p 3 0 0 q 3 2/2 p 3 0\n1 q 4 p 4 3 0 q 4 1/1 p 4 0 0 q 4 1/1 p 4 1\n(a) Flowgraph (b) Min-costflow (c) Feasiblepath\nFigure2:Theflownetworkofthemusicexample\n314\n2.1 ComputingtheEMD Forinstance, thereverseedgee(p ,q )inFigure3(b)isfeasi-\n4 2\nEMDcanbecomputedusinglinearprogramming[12]andnet- ble. Itscostisc f (p 4 ,q 2 ) = −c 2,4 = −0.9sincee(p 4 ,q 2 )isnot\nwork flow algorithms [1]. We now explain how EMD computa- aphysicaledge. Tocalculatethemin-costflow(i.e., EMD),SSP\ntion can be modeled and solved as a network flow problem. We iterativelysearchesforthefeasiblepathhavingtheminimumcost.\nfirstconstructabipartiteflownetwork(seeFigure2(a)fortheex- Asdiscussedabove,afeasiblepathstartsfromavertexinq,which\nample of Figure 1), where the vertices are derived from the his- still has positive flow capacity, ends at a vertex in p with posi-\ntogram bins (e.g., music genres) and the edges connect the bins tiveflowcapacityandincludesonlyfeasibleedges. Forinstance,\nbetween the two histograms. Each edge carries a cost according there is a feasible path highlighted by three dashed lines in Fig-\nto the corresponding cell of the cost matrix. The flow capacity ure2(c);thepathstartsatq 1 ,passesp 3 andq 2 ,andfinallyreaches\nofeachvertexcorrespondstothevalueofthecorrespondinghis- p 4 .Thecostofthispathisc f (q 1 ,p 3 )+c f (p 3 ,q 2 )+c f (q 2 ,p 4 )=\ntogrambin. Forinstance,theflowcapacityofvertexq (i.e.,R&B 0.1+(−0.6)+0.9 = 0.4. SSP selects the feasible path with\n1\nofq)inFigure2(a)issetto3accordingtoFigure1(a). Finding thelowestcostandaugmentsthemaximumpossibleflowalongthe\ntheminimum-costflowinthisbipartitegraphisequivalenttofind- path. The augmented flow is determined by the minimum of the\ning the EMD from q to p. Each vertex of q should send total followingquantities: (i)theremainingflowcapacityatthesource\nflowequaltoitscapacityandeachvertexofpshouldreceivetotal node, (ii) the remaining flow capacity at the destination, (iii) the\nflowequaltoitscapacity.Theminimum-costflowisshowninFig- minimumremainingcapacityofalledgesonthepath. Forexam-\nure2(b). Oneachedgee(q ,p ), thelabelf /cap showsthe ple,Figure2(b)showstheresultofaugmentingthepathshownby\ni j i,j i,j\nflowf sentfromtheoriginvertexq andthecapacitycap of thethreedashedlinesinFigure2(c).Theaugmentationadds1flow\ni,j i i,j\nthat edge (i.e., the maximum flow which could possibly be sent unittoallphysicaledgesonthepath(i.e.,e(q 1 ,p 3 )ande(q 2 ,p 4 )),\nfrom q to p ). The edge capacity cap is the minimum ca- subtracts 1 flow unit from the edges, for which the reverse edge\ni j i,j\npacityofthetwoend-vertices; e.g., thecapacityofe(q 2 ,p 4 )is3 is on the path (i.e., e(q 2 ,p 3 )), and updates the capacities of path\n(= T m he in su { c c c a e p s q s 2 iv , e ca sh p o p r 4 t } es = tp m at i h n ( { S 4 S , P 3 ) } a ) l . gorithm[1]isthemostrep- edg C e o s m ,q p 1 u , t a in n g d t p h 4 e . EMD,usingSSPrequiresO(F|E|log|V|)time,\nresentativealgorithminthecategoryofthenetworkflowbasedso- where F is the total number of flows we need to augment and\nlutions. SSPiterativelycomputesandaugmentspathsthat(i)start O(|E|log|V|) is the cost of a shortest path search on a bipartite\nfromavertexq whichhasremainingflowcapacity,(ii)terminateto graphwith|V|verticesand|E|edges. Aftereachpathaugmenta-\ni\navertexp whichalsohasremainingflowcapacity,and(iii)nodes tion,thechangesinthegraphrenderthesubsequentshortestpath\ni\nfromqandparealternatedinthesepaths. Avalidpathshouldin- searchindependentfromthepreviousone,therefore,alargenum-\ncludefeasibleedgesonly.Givenaflowgraph,anedgeisfeasibleif berofshortestpathcomputationsshouldbeapplied. Asweshall\nthereisremainingflowcapacityontheedge. Whenaugmentinga seeinSection3,wecangreatlyreducethecostofSSPbyamethod\nflowf onanedgee(q ,p ),wesubtractf fromthecapacityof whichbuildsandsearchestheflowgraphincrementally.\ni,j i j i,j\ne(q ,p )andaddf totheflowcapacityofe(p ,q ). Inourrun-\ni j i,j j i\n2.2 Filter-and-RefinementFramework\nningexample, initially, noflowhasbeenaugmentedonanyedge\n(i.e.,thef labelsofalledgesaresetto0);thus,edgee(q ,p )\ni,j 2 4\n(illustratedinFigure3(a))isfeasiblesincetheremainingflowca-\nfilter phase refinement phase\npacityfromq 2 top 4 is3(illustratedbythenumberonthedashed Normal distribution index\nline).Ifweaugment1unitofflowone(q 2 ,p 4 ),wesubtract1from Dimensionality\nthecapacityofe(q ,p )andadd1tothecapacityofe(p ,q )(as reduction\n2 4 4 2\nshowninFigure3(b)). Notethate(p ,q )isnotaphysicaledge Black-box EMD\n4 2 calculation\nin G, as there are only directed edges from q to p but not vice- Independent\nFull projections\nversa. However, during path computation, SSP traverses also re- minimization\nverseedgesprovidedthattheyarefeasible. Aformaldefinitionof\nquick-and-dirty slow-and-accurate\nfeasibleedgesisgivenbelow.Thecapacityofanon-physicaledge\n(i.e.,reverseedge)e(p ,q )alwaysequalstotheflowf currently\nj i i,j\nFigure4:Filter-and-refinementframework\nonedgee(q ,p ).\ni j\nDEFINITION1 (FEASIBLEEDGE). Given a flow graph, a\nphysicaledgee(q ,p )isfeasibleiff <cap ;anon-physical\nGivenacollectionDofhistogramsandaqueryhistogramq,a\ni j i,j i,j\n(reverse)edgee(p ,q )isfeasibleiff >0. k-nearest neighbor (k-NN) query, finds a subset S of D contain-\nj i i,j ingkhistograms,suchthat∀p ∈ S,∀p(cid:48) ∈ D\\S,emd(q,p) ≤\nemd(q,p(cid:48)).Thek-NNqueryisthemostpopularsimilaritysearch\nq 3 p q 2 p type, as the number of results is controlled by k and there is no\n4 q 2 0/3 p 4 3 3 q 2 1/3 p 4 2 requirement for setting a similarity threshold prior to search. In\n0 1 previousstudies[5,7,25,30],k-NNqueriesareevaluatedbasedon\n(a)Beforeaugmentation (b) Afteraugmentation afilter-and-refinementframework. TheEMDemd(q,p)between\nthe query histogram q and every histogram p ∈ D is estimated\nwiththehelpoflowerboundfilteringtechniques,suchasthenor-\nFigure3:Augmenting1flowonedgee(q ,p )\ns h maldistributionindex[25],thefullprojectionlowerbound[7],the\nreduceddimensionlowerbound[30], andindependentminimiza-\nBesides,thecostc (u,v)ofanedgee(u,v)isdeterminedbyits\nf tion [5]. In general, these filters are applied in an order starting\nphysicalexistenceintheflowgraphandthecostmatrixC:\nfromquick-and-dirtyonestoslow-and-accurateones,asshownin\nDEFINITION2 (COSTOFFEASIBLEEDGE). The cost of a Figure4.Forhistogramspthatcannotbeprunedbythefilters,the\nphysical edge e(q ,p ) is c (q ,p ) = c , while the cost of a actualemd(q,p)iscalculatedbyablack-boxcomputationmod-\ni j f i j i,j\nnon-physical(reverse)edgee(p ,q )isc (p ,q )=−c . ule,suchasSSPortransportationsimplex[12].\nj i f j i i,j\n315\n",
      "summary": "The study introduces progressive bounding (PB) and dynamic refinement ordering (DRO) techniques to accelerate EMD-based similarity search by enabling early termination and efficient computation, achieving up to two orders of magnitude speedup over state-of-the-art methods while being applicable to large-scale datasets."
    },
    {
      "title": "2.1 Computing the EMD",
      "start_index": 3,
      "end_index": 3,
      "nodes": [],
      "node_id": "0004",
      "text": "2.1 ComputingtheEMD Forinstance, thereverseedgee(p ,q )inFigure3(b)isfeasi-\n4 2\nEMDcanbecomputedusinglinearprogramming[12]andnet- ble. Itscostisc f (p 4 ,q 2 ) = −c 2,4 = −0.9sincee(p 4 ,q 2 )isnot\nwork flow algorithms [1]. We now explain how EMD computa- aphysicaledge. Tocalculatethemin-costflow(i.e., EMD),SSP\ntion can be modeled and solved as a network flow problem. We iterativelysearchesforthefeasiblepathhavingtheminimumcost.\nfirstconstructabipartiteflownetwork(seeFigure2(a)fortheex- Asdiscussedabove,afeasiblepathstartsfromavertexinq,which\nample of Figure 1), where the vertices are derived from the his- still has positive flow capacity, ends at a vertex in p with posi-\ntogram bins (e.g., music genres) and the edges connect the bins tiveflowcapacityandincludesonlyfeasibleedges. Forinstance,\nbetween the two histograms. Each edge carries a cost according there is a feasible path highlighted by three dashed lines in Fig-\nto the corresponding cell of the cost matrix. The flow capacity ure2(c);thepathstartsatq 1 ,passesp 3 andq 2 ,andfinallyreaches\nofeachvertexcorrespondstothevalueofthecorrespondinghis- p 4 .Thecostofthispathisc f (q 1 ,p 3 )+c f (p 3 ,q 2 )+c f (q 2 ,p 4 )=\ntogrambin. Forinstance,theflowcapacityofvertexq (i.e.,R&B 0.1+(−0.6)+0.9 = 0.4. SSP selects the feasible path with\n1\nofq)inFigure2(a)issetto3accordingtoFigure1(a). Finding thelowestcostandaugmentsthemaximumpossibleflowalongthe\ntheminimum-costflowinthisbipartitegraphisequivalenttofind- path. The augmented flow is determined by the minimum of the\ning the EMD from q to p. Each vertex of q should send total followingquantities: (i)theremainingflowcapacityatthesource\nflowequaltoitscapacityandeachvertexofpshouldreceivetotal node, (ii) the remaining flow capacity at the destination, (iii) the\nflowequaltoitscapacity.Theminimum-costflowisshowninFig- minimumremainingcapacityofalledgesonthepath. Forexam-\nure2(b). Oneachedgee(q ,p ), thelabelf /cap showsthe ple,Figure2(b)showstheresultofaugmentingthepathshownby\ni j i,j i,j\nflowf sentfromtheoriginvertexq andthecapacitycap of thethreedashedlinesinFigure2(c).Theaugmentationadds1flow\ni,j i i,j\nthat edge (i.e., the maximum flow which could possibly be sent unittoallphysicaledgesonthepath(i.e.,e(q 1 ,p 3 )ande(q 2 ,p 4 )),\nfrom q to p ). The edge capacity cap is the minimum ca- subtracts 1 flow unit from the edges, for which the reverse edge\ni j i,j\npacityofthetwoend-vertices; e.g., thecapacityofe(q 2 ,p 4 )is3 is on the path (i.e., e(q 2 ,p 3 )), and updates the capacities of path\n(= T m he in su { c c c a e p s q s 2 iv , e ca sh p o p r 4 t } es = tp m at i h n ( { S 4 S , P 3 ) } a ) l . gorithm[1]isthemostrep- edg C e o s m ,q p 1 u , t a in n g d t p h 4 e . EMD,usingSSPrequiresO(F|E|log|V|)time,\nresentativealgorithminthecategoryofthenetworkflowbasedso- where F is the total number of flows we need to augment and\nlutions. SSPiterativelycomputesandaugmentspathsthat(i)start O(|E|log|V|) is the cost of a shortest path search on a bipartite\nfromavertexq whichhasremainingflowcapacity,(ii)terminateto graphwith|V|verticesand|E|edges. Aftereachpathaugmenta-\ni\navertexp whichalsohasremainingflowcapacity,and(iii)nodes tion,thechangesinthegraphrenderthesubsequentshortestpath\ni\nfromqandparealternatedinthesepaths. Avalidpathshouldin- searchindependentfromthepreviousone,therefore,alargenum-\ncludefeasibleedgesonly.Givenaflowgraph,anedgeisfeasibleif berofshortestpathcomputationsshouldbeapplied. Asweshall\nthereisremainingflowcapacityontheedge. Whenaugmentinga seeinSection3,wecangreatlyreducethecostofSSPbyamethod\nflowf onanedgee(q ,p ),wesubtractf fromthecapacityof whichbuildsandsearchestheflowgraphincrementally.\ni,j i j i,j\ne(q ,p )andaddf totheflowcapacityofe(p ,q ). Inourrun-\ni j i,j j i\n2.2 Filter-and-RefinementFramework\nningexample, initially, noflowhasbeenaugmentedonanyedge\n(i.e.,thef labelsofalledgesaresetto0);thus,edgee(q ,p )\ni,j 2 4\n(illustratedinFigure3(a))isfeasiblesincetheremainingflowca-\nfilter phase refinement phase\npacityfromq 2 top 4 is3(illustratedbythenumberonthedashed Normal distribution index\nline).Ifweaugment1unitofflowone(q 2 ,p 4 ),wesubtract1from Dimensionality\nthecapacityofe(q ,p )andadd1tothecapacityofe(p ,q )(as reduction\n2 4 4 2\nshowninFigure3(b)). Notethate(p ,q )isnotaphysicaledge Black-box EMD\n4 2 calculation\nin G, as there are only directed edges from q to p but not vice- Independent\nFull projections\nversa. However, during path computation, SSP traverses also re- minimization\nverseedgesprovidedthattheyarefeasible. Aformaldefinitionof\nquick-and-dirty slow-and-accurate\nfeasibleedgesisgivenbelow.Thecapacityofanon-physicaledge\n(i.e.,reverseedge)e(p ,q )alwaysequalstotheflowf currently\nj i i,j\nFigure4:Filter-and-refinementframework\nonedgee(q ,p ).\ni j\nDEFINITION1 (FEASIBLEEDGE). Given a flow graph, a\nphysicaledgee(q ,p )isfeasibleiff <cap ;anon-physical\nGivenacollectionDofhistogramsandaqueryhistogramq,a\ni j i,j i,j\n(reverse)edgee(p ,q )isfeasibleiff >0. k-nearest neighbor (k-NN) query, finds a subset S of D contain-\nj i i,j ingkhistograms,suchthat∀p ∈ S,∀p(cid:48) ∈ D\\S,emd(q,p) ≤\nemd(q,p(cid:48)).Thek-NNqueryisthemostpopularsimilaritysearch\nq 3 p q 2 p type, as the number of results is controlled by k and there is no\n4 q 2 0/3 p 4 3 3 q 2 1/3 p 4 2 requirement for setting a similarity threshold prior to search. In\n0 1 previousstudies[5,7,25,30],k-NNqueriesareevaluatedbasedon\n(a)Beforeaugmentation (b) Afteraugmentation afilter-and-refinementframework. TheEMDemd(q,p)between\nthe query histogram q and every histogram p ∈ D is estimated\nwiththehelpoflowerboundfilteringtechniques,suchasthenor-\nFigure3:Augmenting1flowonedgee(q ,p )\ns h maldistributionindex[25],thefullprojectionlowerbound[7],the\nreduceddimensionlowerbound[30], andindependentminimiza-\nBesides,thecostc (u,v)ofanedgee(u,v)isdeterminedbyits\nf tion [5]. In general, these filters are applied in an order starting\nphysicalexistenceintheflowgraphandthecostmatrixC:\nfromquick-and-dirtyonestoslow-and-accurateones,asshownin\nDEFINITION2 (COSTOFFEASIBLEEDGE). The cost of a Figure4.Forhistogramspthatcannotbeprunedbythefilters,the\nphysical edge e(q ,p ) is c (q ,p ) = c , while the cost of a actualemd(q,p)iscalculatedbyablack-boxcomputationmod-\ni j f i j i,j\nnon-physical(reverse)edgee(p ,q )isc (p ,q )=−c . ule,suchasSSPortransportationsimplex[12].\nj i f j i i,j\n315\n",
      "summary": "The Earth Mover's Distance (EMD) is computed as a minimum-cost flow in a bipartite network by iteratively finding and augmenting the lowest-cost feasible paths until all flow capacities are satisfied."
    },
    {
      "title": "2.2 Filter-and-Refinement Framework",
      "start_index": 3,
      "end_index": 4,
      "nodes": [],
      "node_id": "0005",
      "text": "2.1 ComputingtheEMD Forinstance, thereverseedgee(p ,q )inFigure3(b)isfeasi-\n4 2\nEMDcanbecomputedusinglinearprogramming[12]andnet- ble. Itscostisc f (p 4 ,q 2 ) = −c 2,4 = −0.9sincee(p 4 ,q 2 )isnot\nwork flow algorithms [1]. We now explain how EMD computa- aphysicaledge. Tocalculatethemin-costflow(i.e., EMD),SSP\ntion can be modeled and solved as a network flow problem. We iterativelysearchesforthefeasiblepathhavingtheminimumcost.\nfirstconstructabipartiteflownetwork(seeFigure2(a)fortheex- Asdiscussedabove,afeasiblepathstartsfromavertexinq,which\nample of Figure 1), where the vertices are derived from the his- still has positive flow capacity, ends at a vertex in p with posi-\ntogram bins (e.g., music genres) and the edges connect the bins tiveflowcapacityandincludesonlyfeasibleedges. Forinstance,\nbetween the two histograms. Each edge carries a cost according there is a feasible path highlighted by three dashed lines in Fig-\nto the corresponding cell of the cost matrix. The flow capacity ure2(c);thepathstartsatq 1 ,passesp 3 andq 2 ,andfinallyreaches\nofeachvertexcorrespondstothevalueofthecorrespondinghis- p 4 .Thecostofthispathisc f (q 1 ,p 3 )+c f (p 3 ,q 2 )+c f (q 2 ,p 4 )=\ntogrambin. Forinstance,theflowcapacityofvertexq (i.e.,R&B 0.1+(−0.6)+0.9 = 0.4. SSP selects the feasible path with\n1\nofq)inFigure2(a)issetto3accordingtoFigure1(a). Finding thelowestcostandaugmentsthemaximumpossibleflowalongthe\ntheminimum-costflowinthisbipartitegraphisequivalenttofind- path. The augmented flow is determined by the minimum of the\ning the EMD from q to p. Each vertex of q should send total followingquantities: (i)theremainingflowcapacityatthesource\nflowequaltoitscapacityandeachvertexofpshouldreceivetotal node, (ii) the remaining flow capacity at the destination, (iii) the\nflowequaltoitscapacity.Theminimum-costflowisshowninFig- minimumremainingcapacityofalledgesonthepath. Forexam-\nure2(b). Oneachedgee(q ,p ), thelabelf /cap showsthe ple,Figure2(b)showstheresultofaugmentingthepathshownby\ni j i,j i,j\nflowf sentfromtheoriginvertexq andthecapacitycap of thethreedashedlinesinFigure2(c).Theaugmentationadds1flow\ni,j i i,j\nthat edge (i.e., the maximum flow which could possibly be sent unittoallphysicaledgesonthepath(i.e.,e(q 1 ,p 3 )ande(q 2 ,p 4 )),\nfrom q to p ). The edge capacity cap is the minimum ca- subtracts 1 flow unit from the edges, for which the reverse edge\ni j i,j\npacityofthetwoend-vertices; e.g., thecapacityofe(q 2 ,p 4 )is3 is on the path (i.e., e(q 2 ,p 3 )), and updates the capacities of path\n(= T m he in su { c c c a e p s q s 2 iv , e ca sh p o p r 4 t } es = tp m at i h n ( { S 4 S , P 3 ) } a ) l . gorithm[1]isthemostrep- edg C e o s m ,q p 1 u , t a in n g d t p h 4 e . EMD,usingSSPrequiresO(F|E|log|V|)time,\nresentativealgorithminthecategoryofthenetworkflowbasedso- where F is the total number of flows we need to augment and\nlutions. SSPiterativelycomputesandaugmentspathsthat(i)start O(|E|log|V|) is the cost of a shortest path search on a bipartite\nfromavertexq whichhasremainingflowcapacity,(ii)terminateto graphwith|V|verticesand|E|edges. Aftereachpathaugmenta-\ni\navertexp whichalsohasremainingflowcapacity,and(iii)nodes tion,thechangesinthegraphrenderthesubsequentshortestpath\ni\nfromqandparealternatedinthesepaths. Avalidpathshouldin- searchindependentfromthepreviousone,therefore,alargenum-\ncludefeasibleedgesonly.Givenaflowgraph,anedgeisfeasibleif berofshortestpathcomputationsshouldbeapplied. Asweshall\nthereisremainingflowcapacityontheedge. Whenaugmentinga seeinSection3,wecangreatlyreducethecostofSSPbyamethod\nflowf onanedgee(q ,p ),wesubtractf fromthecapacityof whichbuildsandsearchestheflowgraphincrementally.\ni,j i j i,j\ne(q ,p )andaddf totheflowcapacityofe(p ,q ). Inourrun-\ni j i,j j i\n2.2 Filter-and-RefinementFramework\nningexample, initially, noflowhasbeenaugmentedonanyedge\n(i.e.,thef labelsofalledgesaresetto0);thus,edgee(q ,p )\ni,j 2 4\n(illustratedinFigure3(a))isfeasiblesincetheremainingflowca-\nfilter phase refinement phase\npacityfromq 2 top 4 is3(illustratedbythenumberonthedashed Normal distribution index\nline).Ifweaugment1unitofflowone(q 2 ,p 4 ),wesubtract1from Dimensionality\nthecapacityofe(q ,p )andadd1tothecapacityofe(p ,q )(as reduction\n2 4 4 2\nshowninFigure3(b)). Notethate(p ,q )isnotaphysicaledge Black-box EMD\n4 2 calculation\nin G, as there are only directed edges from q to p but not vice- Independent\nFull projections\nversa. However, during path computation, SSP traverses also re- minimization\nverseedgesprovidedthattheyarefeasible. Aformaldefinitionof\nquick-and-dirty slow-and-accurate\nfeasibleedgesisgivenbelow.Thecapacityofanon-physicaledge\n(i.e.,reverseedge)e(p ,q )alwaysequalstotheflowf currently\nj i i,j\nFigure4:Filter-and-refinementframework\nonedgee(q ,p ).\ni j\nDEFINITION1 (FEASIBLEEDGE). Given a flow graph, a\nphysicaledgee(q ,p )isfeasibleiff <cap ;anon-physical\nGivenacollectionDofhistogramsandaqueryhistogramq,a\ni j i,j i,j\n(reverse)edgee(p ,q )isfeasibleiff >0. k-nearest neighbor (k-NN) query, finds a subset S of D contain-\nj i i,j ingkhistograms,suchthat∀p ∈ S,∀p(cid:48) ∈ D\\S,emd(q,p) ≤\nemd(q,p(cid:48)).Thek-NNqueryisthemostpopularsimilaritysearch\nq 3 p q 2 p type, as the number of results is controlled by k and there is no\n4 q 2 0/3 p 4 3 3 q 2 1/3 p 4 2 requirement for setting a similarity threshold prior to search. In\n0 1 previousstudies[5,7,25,30],k-NNqueriesareevaluatedbasedon\n(a)Beforeaugmentation (b) Afteraugmentation afilter-and-refinementframework. TheEMDemd(q,p)between\nthe query histogram q and every histogram p ∈ D is estimated\nwiththehelpoflowerboundfilteringtechniques,suchasthenor-\nFigure3:Augmenting1flowonedgee(q ,p )\ns h maldistributionindex[25],thefullprojectionlowerbound[7],the\nreduceddimensionlowerbound[30], andindependentminimiza-\nBesides,thecostc (u,v)ofanedgee(u,v)isdeterminedbyits\nf tion [5]. In general, these filters are applied in an order starting\nphysicalexistenceintheflowgraphandthecostmatrixC:\nfromquick-and-dirtyonestoslow-and-accurateones,asshownin\nDEFINITION2 (COSTOFFEASIBLEEDGE). The cost of a Figure4.Forhistogramspthatcannotbeprunedbythefilters,the\nphysical edge e(q ,p ) is c (q ,p ) = c , while the cost of a actualemd(q,p)iscalculatedbyablack-boxcomputationmod-\ni j f i j i,j\nnon-physical(reverse)edgee(p ,q )isc (p ,q )=−c . ule,suchasSSPortransportationsimplex[12].\nj i f j i i,j\n315\nAlgorithm1FILTER-AND-REFINEMENTFORk-NN q p\nH:heap,θ:pruningthreshold 1 q 1 2/2 p 1 0\nAlgorithmk-NN(Queryq,IndexI,Filters∆) 0/3 0/2\n1: θ:=∞;H:=∅ 0 q 2 1/1 p 2 0 p1 p2 p3 p4\n2: whileI.getnext(q,θ,(cid:104)p,lbp(cid:105))do 1/3 2/4 q1 0 - 0.1 -\n3: forδi∈∆do (cid:46)Filterphase 0 q 3 2/2 p 3 0 q2 0.9 0 0.6 0.9\n4: lbp:=max{lbp,δi(q,p)} q3 - - 0 -\n5: iflbp≥θthenbreakloop 0 q 4 1/1 p 4 1 q4 - - - 0\n6: iflbp<θthen (cid:46)Refinementphase (a) Partialgraph,G(cid:48) (b) ThecostmatrixofG(cid:48)\n7: ifemd(q,p)<θthen\n8: updateHtoinclude(cid:104)p,emd(q,p)(cid:105)\n9: θ:=k-thEMDvalueinH Figure5:SIAonapartialflowgraph\n10: returnH\nfeasiblepathswhichincludeedgesnotinG(cid:48). Inthiscase,thepath\nAlgorithm1isapseudocodeofthefilter-and-refinementframe- isaugmented;otherwiseSIAexpandsG(cid:48) byinsertingmoreedges\nworkusedinpreviouswork. Sincehistogramscorrespondtoob- untilthebestfeasiblepathinG(cid:48) haslowercostthanthethreshold\njects(e.g.,images),wewillusethetermsobjectsandhistogramsin- Π4; the expansion of G(cid:48) can only reduce the cost of the feasible\nterchangeably.First,theframeworkaccessesobjectsfromanindex\nflowandincreaseΠ,asedgesareinsertedtoG(cid:48)inincreasingorder\nI,suchasthenormaldistributionindex[25]ortheTBIindex[32]. oftheircosts.\nThese indexes provide a getnext function which returns at each\ncall an unseen object p having lower bound lb of emd(q,p) Algorithm2SIABASEDEMDCALCULATION\np\nsmallerthanagiventhresholdθ(line2). Ink-NNsearch,θisthe Π:distancebound,G(cid:48):runningsubgraph\nk-thlargestEMDcomputedsofar(i.e.,thedistanceofthecurrent AlgorithmemdSIA(Histogramsq,p)\nk-thNNofqinD).Ateachiteration(lines2–9),theframeworkac-\n1: Π:=0;G(cid:48):=∅\ncessesahistogramp∈Dusingthegetnextfunctionandattempts\n2: while∃feasibleqido\ntotightenitslowerboundlb p byapplyingaset∆ofprogressively\n3\n4\n:\n:\ns\nw\np\nhi\n:\nl\n=\ne\nD\nsp\nij\n.\nk\nc\ns\no\nt\ns\nra\nt\n(\n>\nqi,\nΠ\nG\no\n(cid:48))\nrspdoesn’treachanyfeasiblepjdo\nmore expensive and accurate lower bound estimation techniques 5: insertmin-costedgee(q\nl\n,pm)∈G−G(cid:48)intoG(cid:48)\n(seeFigure4). Ifanyofthecomputedlowerboundsisnotsmaller 6: updatedistanceboundΠ\nthanthepruningthresholdθ(line5),thenpisfiltered,i.e.,theex- 7: sp:=Dijkstra(qi,G(cid:48))\nactemd(q,p)needsnottobecomputed. Otherwise, emd(q,p) 8: augmentsp\nisessentiallycomputedbyablack-boxalgorithm(line7). During 9: returntotalaugmentingcost\nsearch,Algorithm1maintainsaheapHwiththekhistogramshav-\ningthelowestEMDsofarandthepruningthresholdθ(lines8–9).\nAlgorithm2isapseudocodeofSIAforEMDcalculations. At\nThek-NNcandidatesareconfirmedastheresult,whennomoreob-\neach iteration, SIA searches the min-cost feasible path sp using\njectsarereturnedbythegetnextfunction(line2),i.e.,allunseen\nDijkstra’sshortestpathalgorithm[1]inG(cid:48)fromanyfeasiblevertex\nobjectsdonotsatisfythedistancethresholdθ.\n(line3),i.e.,avertexofqwithremainingcapacity.5 Ifthecostof\nspdoesnotexceedthedistanceboundΠ(line4),thenitmustbe\n3. SCALINGUPSSP avalidmin-costfeasiblepathintheentiregraphG. Weaugment\nComputing EMD by SSP requires having the complete bipar- theflowofspifspisvalid(line8). Otherwise, G(cid:48) isessentially\ntite graph between q and p, which is quadratic to the number of expandedbyaddingmoreedgesfromG(line5)andthedistance\nhistogrambins. Inourpreviouswork, weproposedanoptimized boundΠisupdatedaccordingly(line6).\nversionofSSP,simplifiedgraphincrementalalgorithm(SIA)[29], WedemonstratethefunctionalityofSIAbytheexampleofFig-\ntoscaleupthecomputationofspatialmatchingproblems.Wenow ure6. SupposethatG(cid:48) containsonly6edgesandthereare9flow\nshowhowSIAcanbeadoptedtoscaleupthecomputationofEMD, capacitiessentalready. Accordingtotheflowcapacities,q 1 isthe\nfor histograms with a large number of bins. Different from SSP, onlyfeasiblenodeinqbutthereisnofeasiblepathcurrentlyfrom\nSIAincrementallyconstructsapartialflowgraphG(cid:48) byinserting q 1 to any node of p (see Figure 6(a)). Subsequently, we insert\nedgesfromthecompletebipartitegraphGtoG(cid:48). Theincremental a new edge, e(q 1 ,p 3 ), into G(cid:48) and now there is a shortest path,\ngraph construction significantly reduces the search cost since the sp=(cid:104)e(q 1 ,p 3 ),e(p 3 ,q 2 ),e(q 2 ,p 4 )(cid:105).Thecostofspis0.4,which\nsizeofthepartialgraphG(cid:48)istypicallymuchsmallerthanthecom- issmallerthanthedistanceboundΠ,thuswereturnspastheresult\npletegraphG.Weusetherunningexample(cf.Figure2)todemon- ofthecurrentsearchandaugment1unitofflowfromq 1 andq 2 to\nstratethesuperiorityofSIAinFigure5. Recallthatthemin-cost p 3 andp 4 ,while1unitofflowfromq 2 top 3 iscanceled.\nfeasiblepathstartingatq 1 (cf.Figure2(c))isq 1 →p 3 →q 2 →p 4 4Forclarity, Π = c (E −E(cid:48))−τ , wherec (·)returns\ninthecompletegraphG.SupposeapartialgraphG(cid:48)isconstructed\nthemaximumcosti\nm\nn\na\na\nx\nsetofedges, E\nm\n(cid:48)\nax\ndenotesthe\nma\ne\nx\ndgesinG(cid:48),\nbasedontheseenvaluesinthepartialcostmatrix(Figure5(b)),the andτ indicatesthelargestpotentialvalueofthevertices. Asa\nmax\nsamemin-costfeasiblepathcanbefoundinG(cid:48) aswell. Thereby, note,ΠcanbefurthertightenedifconsideringonlyasubsetofE(cid:48)\naugmentingthispathinG(cid:48) isequivalenttotheaugmentationinG wheretheedgesarefromtheverticesbeingvisitedbythecurrent\nwhichreturnsthesameresultinFigure2(b). Dijkstrasearch.Thecorrectnessproofandoptimizationdetailsare\nThequestionnowturnstohowwecanguaranteethatthemin- givenin[29].\ncost feasible paths in G and G(cid:48) are equivalent. This is done by 5Since G (and G(cid:48)) may contain edges of negative costs (i.e., the\nreverse of edges that currently carries flow), Dijkstra’s algorithm\nadistanceboundcheckingwheretheboundΠisderivedfromthe\ncannot be directly applied. To make its application possible, we\nedgesnotyetinsertedintoG(cid:48). Asanintuition,iftheedgesinG(cid:48)\nneedtoiterativelymaintainapotentialvalueateveryvertex,which\nareinsertedincrementallyinascendingordertotheircostsatevery transformsthecostsofthefeasibleedges tonon-negativevalues.\nvertex,itispossiblethatthemin-costpathinG(cid:48)ischeaperthanall Thedetails(see[29])areomittedforthesakeofreadability.\n316\n",
      "summary": "The Earth Mover's Distance (EMD) is computed as a minimum-cost flow in a bipartite network using the Successive Shortest Path algorithm, where flow capacities and edge costs are derived from histogram bins and a cost matrix, respectively, and the cost of feasible paths—including reverse edges—is minimized iteratively to determine the optimal flow."
    },
    {
      "title": "3. SCALING UP SSP",
      "start_index": 4,
      "end_index": 5,
      "nodes": [],
      "node_id": "0006",
      "text": "Algorithm1FILTER-AND-REFINEMENTFORk-NN q p\nH:heap,θ:pruningthreshold 1 q 1 2/2 p 1 0\nAlgorithmk-NN(Queryq,IndexI,Filters∆) 0/3 0/2\n1: θ:=∞;H:=∅ 0 q 2 1/1 p 2 0 p1 p2 p3 p4\n2: whileI.getnext(q,θ,(cid:104)p,lbp(cid:105))do 1/3 2/4 q1 0 - 0.1 -\n3: forδi∈∆do (cid:46)Filterphase 0 q 3 2/2 p 3 0 q2 0.9 0 0.6 0.9\n4: lbp:=max{lbp,δi(q,p)} q3 - - 0 -\n5: iflbp≥θthenbreakloop 0 q 4 1/1 p 4 1 q4 - - - 0\n6: iflbp<θthen (cid:46)Refinementphase (a) Partialgraph,G(cid:48) (b) ThecostmatrixofG(cid:48)\n7: ifemd(q,p)<θthen\n8: updateHtoinclude(cid:104)p,emd(q,p)(cid:105)\n9: θ:=k-thEMDvalueinH Figure5:SIAonapartialflowgraph\n10: returnH\nfeasiblepathswhichincludeedgesnotinG(cid:48). Inthiscase,thepath\nAlgorithm1isapseudocodeofthefilter-and-refinementframe- isaugmented;otherwiseSIAexpandsG(cid:48) byinsertingmoreedges\nworkusedinpreviouswork. Sincehistogramscorrespondtoob- untilthebestfeasiblepathinG(cid:48) haslowercostthanthethreshold\njects(e.g.,images),wewillusethetermsobjectsandhistogramsin- Π4; the expansion of G(cid:48) can only reduce the cost of the feasible\nterchangeably.First,theframeworkaccessesobjectsfromanindex\nflowandincreaseΠ,asedgesareinsertedtoG(cid:48)inincreasingorder\nI,suchasthenormaldistributionindex[25]ortheTBIindex[32]. oftheircosts.\nThese indexes provide a getnext function which returns at each\ncall an unseen object p having lower bound lb of emd(q,p) Algorithm2SIABASEDEMDCALCULATION\np\nsmallerthanagiventhresholdθ(line2). Ink-NNsearch,θisthe Π:distancebound,G(cid:48):runningsubgraph\nk-thlargestEMDcomputedsofar(i.e.,thedistanceofthecurrent AlgorithmemdSIA(Histogramsq,p)\nk-thNNofqinD).Ateachiteration(lines2–9),theframeworkac-\n1: Π:=0;G(cid:48):=∅\ncessesahistogramp∈Dusingthegetnextfunctionandattempts\n2: while∃feasibleqido\ntotightenitslowerboundlb p byapplyingaset∆ofprogressively\n3\n4\n:\n:\ns\nw\np\nhi\n:\nl\n=\ne\nD\nsp\nij\n.\nk\nc\ns\no\nt\ns\nra\nt\n(\n>\nqi,\nΠ\nG\no\n(cid:48))\nrspdoesn’treachanyfeasiblepjdo\nmore expensive and accurate lower bound estimation techniques 5: insertmin-costedgee(q\nl\n,pm)∈G−G(cid:48)intoG(cid:48)\n(seeFigure4). Ifanyofthecomputedlowerboundsisnotsmaller 6: updatedistanceboundΠ\nthanthepruningthresholdθ(line5),thenpisfiltered,i.e.,theex- 7: sp:=Dijkstra(qi,G(cid:48))\nactemd(q,p)needsnottobecomputed. Otherwise, emd(q,p) 8: augmentsp\nisessentiallycomputedbyablack-boxalgorithm(line7). During 9: returntotalaugmentingcost\nsearch,Algorithm1maintainsaheapHwiththekhistogramshav-\ningthelowestEMDsofarandthepruningthresholdθ(lines8–9).\nAlgorithm2isapseudocodeofSIAforEMDcalculations. At\nThek-NNcandidatesareconfirmedastheresult,whennomoreob-\neach iteration, SIA searches the min-cost feasible path sp using\njectsarereturnedbythegetnextfunction(line2),i.e.,allunseen\nDijkstra’sshortestpathalgorithm[1]inG(cid:48)fromanyfeasiblevertex\nobjectsdonotsatisfythedistancethresholdθ.\n(line3),i.e.,avertexofqwithremainingcapacity.5 Ifthecostof\nspdoesnotexceedthedistanceboundΠ(line4),thenitmustbe\n3. SCALINGUPSSP avalidmin-costfeasiblepathintheentiregraphG. Weaugment\nComputing EMD by SSP requires having the complete bipar- theflowofspifspisvalid(line8). Otherwise, G(cid:48) isessentially\ntite graph between q and p, which is quadratic to the number of expandedbyaddingmoreedgesfromG(line5)andthedistance\nhistogrambins. Inourpreviouswork, weproposedanoptimized boundΠisupdatedaccordingly(line6).\nversionofSSP,simplifiedgraphincrementalalgorithm(SIA)[29], WedemonstratethefunctionalityofSIAbytheexampleofFig-\ntoscaleupthecomputationofspatialmatchingproblems.Wenow ure6. SupposethatG(cid:48) containsonly6edgesandthereare9flow\nshowhowSIAcanbeadoptedtoscaleupthecomputationofEMD, capacitiessentalready. Accordingtotheflowcapacities,q 1 isthe\nfor histograms with a large number of bins. Different from SSP, onlyfeasiblenodeinqbutthereisnofeasiblepathcurrentlyfrom\nSIAincrementallyconstructsapartialflowgraphG(cid:48) byinserting q 1 to any node of p (see Figure 6(a)). Subsequently, we insert\nedgesfromthecompletebipartitegraphGtoG(cid:48). Theincremental a new edge, e(q 1 ,p 3 ), into G(cid:48) and now there is a shortest path,\ngraph construction significantly reduces the search cost since the sp=(cid:104)e(q 1 ,p 3 ),e(p 3 ,q 2 ),e(q 2 ,p 4 )(cid:105).Thecostofspis0.4,which\nsizeofthepartialgraphG(cid:48)istypicallymuchsmallerthanthecom- issmallerthanthedistanceboundΠ,thuswereturnspastheresult\npletegraphG.Weusetherunningexample(cf.Figure2)todemon- ofthecurrentsearchandaugment1unitofflowfromq 1 andq 2 to\nstratethesuperiorityofSIAinFigure5. Recallthatthemin-cost p 3 andp 4 ,while1unitofflowfromq 2 top 3 iscanceled.\nfeasiblepathstartingatq 1 (cf.Figure2(c))isq 1 →p 3 →q 2 →p 4 4Forclarity, Π = c (E −E(cid:48))−τ , wherec (·)returns\ninthecompletegraphG.SupposeapartialgraphG(cid:48)isconstructed\nthemaximumcosti\nm\nn\na\na\nx\nsetofedges, E\nm\n(cid:48)\nax\ndenotesthe\nma\ne\nx\ndgesinG(cid:48),\nbasedontheseenvaluesinthepartialcostmatrix(Figure5(b)),the andτ indicatesthelargestpotentialvalueofthevertices. Asa\nmax\nsamemin-costfeasiblepathcanbefoundinG(cid:48) aswell. Thereby, note,ΠcanbefurthertightenedifconsideringonlyasubsetofE(cid:48)\naugmentingthispathinG(cid:48) isequivalenttotheaugmentationinG wheretheedgesarefromtheverticesbeingvisitedbythecurrent\nwhichreturnsthesameresultinFigure2(b). Dijkstrasearch.Thecorrectnessproofandoptimizationdetailsare\nThequestionnowturnstohowwecanguaranteethatthemin- givenin[29].\ncost feasible paths in G and G(cid:48) are equivalent. This is done by 5Since G (and G(cid:48)) may contain edges of negative costs (i.e., the\nreverse of edges that currently carries flow), Dijkstra’s algorithm\nadistanceboundcheckingwheretheboundΠisderivedfromthe\ncannot be directly applied. To make its application possible, we\nedgesnotyetinsertedintoG(cid:48). Asanintuition,iftheedgesinG(cid:48)\nneedtoiterativelymaintainapotentialvalueateveryvertex,which\nareinsertedincrementallyinascendingordertotheircostsatevery transformsthecostsofthefeasibleedges tonon-negativevalues.\nvertex,itispossiblethatthemin-costpathinG(cid:48)ischeaperthanall Thedetails(see[29])areomittedforthesakeofreadability.\n316\nq p q p q p\n1 q 1 2/2 p 1 0 1 q 1 2/2 p 1 0 0 q 1 2/2 p 1 0\n0/3 1/3\n0 q 2 1/1 p 2 0 0 q 2 1/1 p 2 0 0 q 2 1/1 p 2 0\n1/3 2/4 1/3 2/4 2/3 1/4\n0 q 3 2/2 p 3 0 0 q 3 2/2 p 3 0 0 q 3 2/2 p 3 0\n0 q 4 1/1 p 4 1 0 q 4 1/1 p 4 1 0 q 4 1/1 p 4 0\n(a) G(cid:48)atloopi (b) G(cid:48)atloopi+1 (c) G(cid:48)atloopi+2\nFigure6:ArunningexampleofSIA-EMD\nInthiswork,weuseSIAasamoduleforcomputingtheEMD\nbetween two histograms p and q in the refinement step of simi-\nlaritysearch,duetoitsefficiencyandscalabilitytothenumberof\nhistogram bins. Still, SIA only optimizes the performance of an\nindividual EMD calculation, whereas our ultimate objective is to\nminimizetheoverallcostofasimilarityquery,whichmayinvolve\nalargenumberofEMDcalculations. Thenextsectionshowshow\nwecanoptimizetheoverallcostofqueriesbyexploitinginforma-\ntionduringthecourseofaSIAcalculation.\n4. BOOSTINGTHEREFINEMENTPHASE\nIn this section, we propose two novel techniques, progressive\nbounding (PB) and dynamic refinement ordering (DRO), which\nboosttheperformanceoftherefinementphaseduringEMD-based\nsimilaritysearch. PBisinspiredbytherunningtimepatternofa\nsingleEMDcalculationandDROisinspiredbytheexecutionor-\nderinthefilter-and-refinementframework. Thesetwotechniques\nmaketheEMDcalculationsattherefinementphasebeinghandled\ninmultiplestagesandprogressivelyinsteadofasone-offprocesses\n(i.e.,byblack-boxmodules).\n4.1 AnalysisofEMDCalculation\nAccordingtopreviousexperimentalstudies(e.g.,[25,32]),more\nthan95%ofthehistogramsonaveragecanbefilteredbythelower\nbound estimations; however, such high filter effectiveness is not\nguaranteed.Tomakethingsworse,ifweprocessEMD-basedsim-\nilarity queries on large datasets (e.g., 1M objects) having high-\ngranularityhistograms(e.g.,severalhundredsofbins),therefine-\nment phase even at a very high filtering ratio (e.g., 99%) easily\nbecomes the bottleneck, due to the high cost of exact EMD cal-\nculations. Althoughtherehasbeenampleworkonimprovingthe\nperformance and effectiveness of the filter phase in EMD-based\nsimilaritysearch,tothebestofourknowledge,therehasbeenno\nworkfocusingonoptimizingtherefinementphase,forwhichoff-\nthe-shelfEMDcomputationtechniques(suchastransportationsim-\nplexorSSP)aresimplyappliedasblack-boxmodules.\n0.6\n0.4\n0.2\n0.0 0 500 10001500200025003000\nIterations\n)s(\nemiT\n2.0\n1.5\n1.0\n0.5\n0 0 500 1000 15002000 2500 3000\nIterations\n(a) SIA’scumulativeruntime\ntsoC\nAsdiscussedinSection3,weadoptSIAforexactEMDcalcu-\nlationsintherefinementphase. AlthoughSIAoffersgreatperfor-\nmanceimprovementsovertypicalEMDsolutions(e.g.,SSP[1]and\ntransportationsimplex[12]),therunningtimeduringitsexecution\nincreasesquicklyasthealgorithmprogresses. Figure7(a)shows\nthecumulativeruntimeoverSIAiterationsduringatypicalEMD\ncalculationfortwohistogramswith1024binseach. Thisexample\nshowsthatover90%ofSIA’sexecutiontimeisusedinthelast20%\nofitsiterations. ThereasonbehindthisisthatasSIAprogresses,\nthe partial graph G(cid:48) and the number of feasible edges grow and\nshortestpathsearchesbecomemuchmoreexpensive. Thisanaly-\nsisshowsthatthereisroomforgreatlyimprovingtherefinement\nphase of EMD-based similarity search, if SIA can be terminated\nbeforereachingitslateiterations.\n4.2 ProgressiveBounding\nInordertoterminateSIAasearlyaspossibleforobjectsthatdo\nnotmakeittothequeryresultset,weproposeatechniquewhich\nprogressivelymaintainsarunninglowerboundemd−andtightens\nemd− throughouttheentireEMDcalculationprocess. SIA,fora\nspecificrefinement,canterminateearlyiftherunninglowerbound\nbecomesnotsmallerthanthecurrentpruningthresholdθ(i.e.,the\nk-thlowestEMDfoundsofar).\nFirst,weuseapropertyofSSP(andSIA);ateachiteration,the\nminimum-costfeasiblepathisnonnegativewhenthecostmatrixC\ndoesnotincludeanynegativevalues[1]. Inotherwords, theac-\ncumulatedcostbyaugmentingflowsateachiterationismonotoni-\ncallynon-decreasing,andcanbeusedastherunninglowerbound\nofEMD. Forexample,Figure7(b)illustratestheaccumulationof\nthe EMD during SIA, for two 1024-bin histograms q and p. At\neachiteration,thecurrentcostrepresentstheaccumulationofthe\naugmentedcostsuptothatiteration;bycomparingitwiththecur-\nrentpruningthresholdθ (ignoretheotherseriesforthemoment),\nwecanobservethatSIAmayterminateassoonasthecurrentcost\nbecomesatleastequaltoθ(i.e.,ataround88.3%ofthetotaliter-\nations). Thispointcorrespondsto23.4%ofSIA’stotalexecution\ntime (cf. Figure 7(a)). Note that the current cost remains 0 until\nthe1024thiterationbecausetheshortestpathsuptothisiteration\ncorrespondtoflowsbetweenthesamebinsofqandp(i.e.,from\nq top forsomei∈[1,n],n=1024)withzerocosteach.\ni i\n1 q r 2/2 p r 0\ncurrent cost SIA / SSP\n1 q s 1/1 p s 0\n2/4 com b p y uted emd -\n0 q j 2/2 p j 0 estimated lower bound\ncost estimtaion\n1 q h p h 3\nFigure8:Runninglowerbound,emd−\nCurrent cost\nemd−\nBest bound from filter phase\nPruning threshold Although the current cost could be intuitively used as a lower\nboundforthefinal(actual)EMD,itisnotsufficientlytightsince\nit does not take the remaining feasible flow into consideration.\nThereby, we propose a running lower bound, emd−, which not\nonlyconsiderstheso-faraccumulatedflowcost,butalsoprovides\nan estimation to the cost of flows yet to be augmented. As Fig-\nure8illustrates, emd− consistsofthecurrentcost (partialEMD\n(b) Currentcost\nalreadycomputed)plusalowerboundforthecostoftheremaining\nflow. Theeffectivenessofemd−isshownintherunningexample\nFigure7:SIAperformanceondifferentiterations of Figure 7(b), where emd− grows much faster compared to the\n317\n",
      "summary": "Algorithm 1 outlines a filter-and-refinement framework for k-NN search using lower bounds to prune irrelevant objects and compute exact EMD distances only for promising candidates, while Algorithm 2 details the SIA method for EMD calculation by iteratively expanding a subgraph and augmenting paths until the distance bound is minimized."
    },
    {
      "title": "4. BOOSTING THE REFINEMENT PHASE",
      "start_index": 5,
      "end_index": 5,
      "nodes": [],
      "node_id": "0007",
      "text": "q p q p q p\n1 q 1 2/2 p 1 0 1 q 1 2/2 p 1 0 0 q 1 2/2 p 1 0\n0/3 1/3\n0 q 2 1/1 p 2 0 0 q 2 1/1 p 2 0 0 q 2 1/1 p 2 0\n1/3 2/4 1/3 2/4 2/3 1/4\n0 q 3 2/2 p 3 0 0 q 3 2/2 p 3 0 0 q 3 2/2 p 3 0\n0 q 4 1/1 p 4 1 0 q 4 1/1 p 4 1 0 q 4 1/1 p 4 0\n(a) G(cid:48)atloopi (b) G(cid:48)atloopi+1 (c) G(cid:48)atloopi+2\nFigure6:ArunningexampleofSIA-EMD\nInthiswork,weuseSIAasamoduleforcomputingtheEMD\nbetween two histograms p and q in the refinement step of simi-\nlaritysearch,duetoitsefficiencyandscalabilitytothenumberof\nhistogram bins. Still, SIA only optimizes the performance of an\nindividual EMD calculation, whereas our ultimate objective is to\nminimizetheoverallcostofasimilarityquery,whichmayinvolve\nalargenumberofEMDcalculations. Thenextsectionshowshow\nwecanoptimizetheoverallcostofqueriesbyexploitinginforma-\ntionduringthecourseofaSIAcalculation.\n4. BOOSTINGTHEREFINEMENTPHASE\nIn this section, we propose two novel techniques, progressive\nbounding (PB) and dynamic refinement ordering (DRO), which\nboosttheperformanceoftherefinementphaseduringEMD-based\nsimilaritysearch. PBisinspiredbytherunningtimepatternofa\nsingleEMDcalculationandDROisinspiredbytheexecutionor-\nderinthefilter-and-refinementframework. Thesetwotechniques\nmaketheEMDcalculationsattherefinementphasebeinghandled\ninmultiplestagesandprogressivelyinsteadofasone-offprocesses\n(i.e.,byblack-boxmodules).\n4.1 AnalysisofEMDCalculation\nAccordingtopreviousexperimentalstudies(e.g.,[25,32]),more\nthan95%ofthehistogramsonaveragecanbefilteredbythelower\nbound estimations; however, such high filter effectiveness is not\nguaranteed.Tomakethingsworse,ifweprocessEMD-basedsim-\nilarity queries on large datasets (e.g., 1M objects) having high-\ngranularityhistograms(e.g.,severalhundredsofbins),therefine-\nment phase even at a very high filtering ratio (e.g., 99%) easily\nbecomes the bottleneck, due to the high cost of exact EMD cal-\nculations. Althoughtherehasbeenampleworkonimprovingthe\nperformance and effectiveness of the filter phase in EMD-based\nsimilaritysearch,tothebestofourknowledge,therehasbeenno\nworkfocusingonoptimizingtherefinementphase,forwhichoff-\nthe-shelfEMDcomputationtechniques(suchastransportationsim-\nplexorSSP)aresimplyappliedasblack-boxmodules.\n0.6\n0.4\n0.2\n0.0 0 500 10001500200025003000\nIterations\n)s(\nemiT\n2.0\n1.5\n1.0\n0.5\n0 0 500 1000 15002000 2500 3000\nIterations\n(a) SIA’scumulativeruntime\ntsoC\nAsdiscussedinSection3,weadoptSIAforexactEMDcalcu-\nlationsintherefinementphase. AlthoughSIAoffersgreatperfor-\nmanceimprovementsovertypicalEMDsolutions(e.g.,SSP[1]and\ntransportationsimplex[12]),therunningtimeduringitsexecution\nincreasesquicklyasthealgorithmprogresses. Figure7(a)shows\nthecumulativeruntimeoverSIAiterationsduringatypicalEMD\ncalculationfortwohistogramswith1024binseach. Thisexample\nshowsthatover90%ofSIA’sexecutiontimeisusedinthelast20%\nofitsiterations. ThereasonbehindthisisthatasSIAprogresses,\nthe partial graph G(cid:48) and the number of feasible edges grow and\nshortestpathsearchesbecomemuchmoreexpensive. Thisanaly-\nsisshowsthatthereisroomforgreatlyimprovingtherefinement\nphase of EMD-based similarity search, if SIA can be terminated\nbeforereachingitslateiterations.\n4.2 ProgressiveBounding\nInordertoterminateSIAasearlyaspossibleforobjectsthatdo\nnotmakeittothequeryresultset,weproposeatechniquewhich\nprogressivelymaintainsarunninglowerboundemd−andtightens\nemd− throughouttheentireEMDcalculationprocess. SIA,fora\nspecificrefinement,canterminateearlyiftherunninglowerbound\nbecomesnotsmallerthanthecurrentpruningthresholdθ(i.e.,the\nk-thlowestEMDfoundsofar).\nFirst,weuseapropertyofSSP(andSIA);ateachiteration,the\nminimum-costfeasiblepathisnonnegativewhenthecostmatrixC\ndoesnotincludeanynegativevalues[1]. Inotherwords, theac-\ncumulatedcostbyaugmentingflowsateachiterationismonotoni-\ncallynon-decreasing,andcanbeusedastherunninglowerbound\nofEMD. Forexample,Figure7(b)illustratestheaccumulationof\nthe EMD during SIA, for two 1024-bin histograms q and p. At\neachiteration,thecurrentcostrepresentstheaccumulationofthe\naugmentedcostsuptothatiteration;bycomparingitwiththecur-\nrentpruningthresholdθ (ignoretheotherseriesforthemoment),\nwecanobservethatSIAmayterminateassoonasthecurrentcost\nbecomesatleastequaltoθ(i.e.,ataround88.3%ofthetotaliter-\nations). Thispointcorrespondsto23.4%ofSIA’stotalexecution\ntime (cf. Figure 7(a)). Note that the current cost remains 0 until\nthe1024thiterationbecausetheshortestpathsuptothisiteration\ncorrespondtoflowsbetweenthesamebinsofqandp(i.e.,from\nq top forsomei∈[1,n],n=1024)withzerocosteach.\ni i\n1 q r 2/2 p r 0\ncurrent cost SIA / SSP\n1 q s 1/1 p s 0\n2/4 com b p y uted emd -\n0 q j 2/2 p j 0 estimated lower bound\ncost estimtaion\n1 q h p h 3\nFigure8:Runninglowerbound,emd−\nCurrent cost\nemd−\nBest bound from filter phase\nPruning threshold Although the current cost could be intuitively used as a lower\nboundforthefinal(actual)EMD,itisnotsufficientlytightsince\nit does not take the remaining feasible flow into consideration.\nThereby, we propose a running lower bound, emd−, which not\nonlyconsiderstheso-faraccumulatedflowcost,butalsoprovides\nan estimation to the cost of flows yet to be augmented. As Fig-\nure8illustrates, emd− consistsofthecurrentcost (partialEMD\n(b) Currentcost\nalreadycomputed)plusalowerboundforthecostoftheremaining\nflow. Theeffectivenessofemd−isshownintherunningexample\nFigure7:SIAperformanceondifferentiterations of Figure 7(b), where emd− grows much faster compared to the\n317\n",
      "summary": "This work proposes progressive bounding and dynamic refinement ordering to optimize the refinement phase of EMD-based similarity search by improving upon the efficient SIA algorithm for computing Earth Mover's Distance between histograms, addressing the high computational cost when exact EMD calculations become a bottleneck despite effective filtering."
    },
    {
      "title": "4.1 Analysis of EMD Calculation",
      "start_index": 5,
      "end_index": 5,
      "nodes": [],
      "node_id": "0008",
      "text": "q p q p q p\n1 q 1 2/2 p 1 0 1 q 1 2/2 p 1 0 0 q 1 2/2 p 1 0\n0/3 1/3\n0 q 2 1/1 p 2 0 0 q 2 1/1 p 2 0 0 q 2 1/1 p 2 0\n1/3 2/4 1/3 2/4 2/3 1/4\n0 q 3 2/2 p 3 0 0 q 3 2/2 p 3 0 0 q 3 2/2 p 3 0\n0 q 4 1/1 p 4 1 0 q 4 1/1 p 4 1 0 q 4 1/1 p 4 0\n(a) G(cid:48)atloopi (b) G(cid:48)atloopi+1 (c) G(cid:48)atloopi+2\nFigure6:ArunningexampleofSIA-EMD\nInthiswork,weuseSIAasamoduleforcomputingtheEMD\nbetween two histograms p and q in the refinement step of simi-\nlaritysearch,duetoitsefficiencyandscalabilitytothenumberof\nhistogram bins. Still, SIA only optimizes the performance of an\nindividual EMD calculation, whereas our ultimate objective is to\nminimizetheoverallcostofasimilarityquery,whichmayinvolve\nalargenumberofEMDcalculations. Thenextsectionshowshow\nwecanoptimizetheoverallcostofqueriesbyexploitinginforma-\ntionduringthecourseofaSIAcalculation.\n4. BOOSTINGTHEREFINEMENTPHASE\nIn this section, we propose two novel techniques, progressive\nbounding (PB) and dynamic refinement ordering (DRO), which\nboosttheperformanceoftherefinementphaseduringEMD-based\nsimilaritysearch. PBisinspiredbytherunningtimepatternofa\nsingleEMDcalculationandDROisinspiredbytheexecutionor-\nderinthefilter-and-refinementframework. Thesetwotechniques\nmaketheEMDcalculationsattherefinementphasebeinghandled\ninmultiplestagesandprogressivelyinsteadofasone-offprocesses\n(i.e.,byblack-boxmodules).\n4.1 AnalysisofEMDCalculation\nAccordingtopreviousexperimentalstudies(e.g.,[25,32]),more\nthan95%ofthehistogramsonaveragecanbefilteredbythelower\nbound estimations; however, such high filter effectiveness is not\nguaranteed.Tomakethingsworse,ifweprocessEMD-basedsim-\nilarity queries on large datasets (e.g., 1M objects) having high-\ngranularityhistograms(e.g.,severalhundredsofbins),therefine-\nment phase even at a very high filtering ratio (e.g., 99%) easily\nbecomes the bottleneck, due to the high cost of exact EMD cal-\nculations. Althoughtherehasbeenampleworkonimprovingthe\nperformance and effectiveness of the filter phase in EMD-based\nsimilaritysearch,tothebestofourknowledge,therehasbeenno\nworkfocusingonoptimizingtherefinementphase,forwhichoff-\nthe-shelfEMDcomputationtechniques(suchastransportationsim-\nplexorSSP)aresimplyappliedasblack-boxmodules.\n0.6\n0.4\n0.2\n0.0 0 500 10001500200025003000\nIterations\n)s(\nemiT\n2.0\n1.5\n1.0\n0.5\n0 0 500 1000 15002000 2500 3000\nIterations\n(a) SIA’scumulativeruntime\ntsoC\nAsdiscussedinSection3,weadoptSIAforexactEMDcalcu-\nlationsintherefinementphase. AlthoughSIAoffersgreatperfor-\nmanceimprovementsovertypicalEMDsolutions(e.g.,SSP[1]and\ntransportationsimplex[12]),therunningtimeduringitsexecution\nincreasesquicklyasthealgorithmprogresses. Figure7(a)shows\nthecumulativeruntimeoverSIAiterationsduringatypicalEMD\ncalculationfortwohistogramswith1024binseach. Thisexample\nshowsthatover90%ofSIA’sexecutiontimeisusedinthelast20%\nofitsiterations. ThereasonbehindthisisthatasSIAprogresses,\nthe partial graph G(cid:48) and the number of feasible edges grow and\nshortestpathsearchesbecomemuchmoreexpensive. Thisanaly-\nsisshowsthatthereisroomforgreatlyimprovingtherefinement\nphase of EMD-based similarity search, if SIA can be terminated\nbeforereachingitslateiterations.\n4.2 ProgressiveBounding\nInordertoterminateSIAasearlyaspossibleforobjectsthatdo\nnotmakeittothequeryresultset,weproposeatechniquewhich\nprogressivelymaintainsarunninglowerboundemd−andtightens\nemd− throughouttheentireEMDcalculationprocess. SIA,fora\nspecificrefinement,canterminateearlyiftherunninglowerbound\nbecomesnotsmallerthanthecurrentpruningthresholdθ(i.e.,the\nk-thlowestEMDfoundsofar).\nFirst,weuseapropertyofSSP(andSIA);ateachiteration,the\nminimum-costfeasiblepathisnonnegativewhenthecostmatrixC\ndoesnotincludeanynegativevalues[1]. Inotherwords, theac-\ncumulatedcostbyaugmentingflowsateachiterationismonotoni-\ncallynon-decreasing,andcanbeusedastherunninglowerbound\nofEMD. Forexample,Figure7(b)illustratestheaccumulationof\nthe EMD during SIA, for two 1024-bin histograms q and p. At\neachiteration,thecurrentcostrepresentstheaccumulationofthe\naugmentedcostsuptothatiteration;bycomparingitwiththecur-\nrentpruningthresholdθ (ignoretheotherseriesforthemoment),\nwecanobservethatSIAmayterminateassoonasthecurrentcost\nbecomesatleastequaltoθ(i.e.,ataround88.3%ofthetotaliter-\nations). Thispointcorrespondsto23.4%ofSIA’stotalexecution\ntime (cf. Figure 7(a)). Note that the current cost remains 0 until\nthe1024thiterationbecausetheshortestpathsuptothisiteration\ncorrespondtoflowsbetweenthesamebinsofqandp(i.e.,from\nq top forsomei∈[1,n],n=1024)withzerocosteach.\ni i\n1 q r 2/2 p r 0\ncurrent cost SIA / SSP\n1 q s 1/1 p s 0\n2/4 com b p y uted emd -\n0 q j 2/2 p j 0 estimated lower bound\ncost estimtaion\n1 q h p h 3\nFigure8:Runninglowerbound,emd−\nCurrent cost\nemd−\nBest bound from filter phase\nPruning threshold Although the current cost could be intuitively used as a lower\nboundforthefinal(actual)EMD,itisnotsufficientlytightsince\nit does not take the remaining feasible flow into consideration.\nThereby, we propose a running lower bound, emd−, which not\nonlyconsiderstheso-faraccumulatedflowcost,butalsoprovides\nan estimation to the cost of flows yet to be augmented. As Fig-\nure8illustrates, emd− consistsofthecurrentcost (partialEMD\n(b) Currentcost\nalreadycomputed)plusalowerboundforthecostoftheremaining\nflow. Theeffectivenessofemd−isshownintherunningexample\nFigure7:SIAperformanceondifferentiterations of Figure 7(b), where emd− grows much faster compared to the\n317\n",
      "summary": "This work proposes progressive bounding and dynamic refinement ordering to optimize the refinement phase of EMD-based similarity search by improving upon the efficient SIA algorithm for computing Earth Mover's Distance between histograms, addressing the high computational cost of exact EMD calculations in large-scale, high-granularity scenarios."
    },
    {
      "title": "4.2 Progressive Bounding",
      "start_index": 5,
      "end_index": 6,
      "nodes": [],
      "node_id": "0009",
      "text": "q p q p q p\n1 q 1 2/2 p 1 0 1 q 1 2/2 p 1 0 0 q 1 2/2 p 1 0\n0/3 1/3\n0 q 2 1/1 p 2 0 0 q 2 1/1 p 2 0 0 q 2 1/1 p 2 0\n1/3 2/4 1/3 2/4 2/3 1/4\n0 q 3 2/2 p 3 0 0 q 3 2/2 p 3 0 0 q 3 2/2 p 3 0\n0 q 4 1/1 p 4 1 0 q 4 1/1 p 4 1 0 q 4 1/1 p 4 0\n(a) G(cid:48)atloopi (b) G(cid:48)atloopi+1 (c) G(cid:48)atloopi+2\nFigure6:ArunningexampleofSIA-EMD\nInthiswork,weuseSIAasamoduleforcomputingtheEMD\nbetween two histograms p and q in the refinement step of simi-\nlaritysearch,duetoitsefficiencyandscalabilitytothenumberof\nhistogram bins. Still, SIA only optimizes the performance of an\nindividual EMD calculation, whereas our ultimate objective is to\nminimizetheoverallcostofasimilarityquery,whichmayinvolve\nalargenumberofEMDcalculations. Thenextsectionshowshow\nwecanoptimizetheoverallcostofqueriesbyexploitinginforma-\ntionduringthecourseofaSIAcalculation.\n4. BOOSTINGTHEREFINEMENTPHASE\nIn this section, we propose two novel techniques, progressive\nbounding (PB) and dynamic refinement ordering (DRO), which\nboosttheperformanceoftherefinementphaseduringEMD-based\nsimilaritysearch. PBisinspiredbytherunningtimepatternofa\nsingleEMDcalculationandDROisinspiredbytheexecutionor-\nderinthefilter-and-refinementframework. Thesetwotechniques\nmaketheEMDcalculationsattherefinementphasebeinghandled\ninmultiplestagesandprogressivelyinsteadofasone-offprocesses\n(i.e.,byblack-boxmodules).\n4.1 AnalysisofEMDCalculation\nAccordingtopreviousexperimentalstudies(e.g.,[25,32]),more\nthan95%ofthehistogramsonaveragecanbefilteredbythelower\nbound estimations; however, such high filter effectiveness is not\nguaranteed.Tomakethingsworse,ifweprocessEMD-basedsim-\nilarity queries on large datasets (e.g., 1M objects) having high-\ngranularityhistograms(e.g.,severalhundredsofbins),therefine-\nment phase even at a very high filtering ratio (e.g., 99%) easily\nbecomes the bottleneck, due to the high cost of exact EMD cal-\nculations. Althoughtherehasbeenampleworkonimprovingthe\nperformance and effectiveness of the filter phase in EMD-based\nsimilaritysearch,tothebestofourknowledge,therehasbeenno\nworkfocusingonoptimizingtherefinementphase,forwhichoff-\nthe-shelfEMDcomputationtechniques(suchastransportationsim-\nplexorSSP)aresimplyappliedasblack-boxmodules.\n0.6\n0.4\n0.2\n0.0 0 500 10001500200025003000\nIterations\n)s(\nemiT\n2.0\n1.5\n1.0\n0.5\n0 0 500 1000 15002000 2500 3000\nIterations\n(a) SIA’scumulativeruntime\ntsoC\nAsdiscussedinSection3,weadoptSIAforexactEMDcalcu-\nlationsintherefinementphase. AlthoughSIAoffersgreatperfor-\nmanceimprovementsovertypicalEMDsolutions(e.g.,SSP[1]and\ntransportationsimplex[12]),therunningtimeduringitsexecution\nincreasesquicklyasthealgorithmprogresses. Figure7(a)shows\nthecumulativeruntimeoverSIAiterationsduringatypicalEMD\ncalculationfortwohistogramswith1024binseach. Thisexample\nshowsthatover90%ofSIA’sexecutiontimeisusedinthelast20%\nofitsiterations. ThereasonbehindthisisthatasSIAprogresses,\nthe partial graph G(cid:48) and the number of feasible edges grow and\nshortestpathsearchesbecomemuchmoreexpensive. Thisanaly-\nsisshowsthatthereisroomforgreatlyimprovingtherefinement\nphase of EMD-based similarity search, if SIA can be terminated\nbeforereachingitslateiterations.\n4.2 ProgressiveBounding\nInordertoterminateSIAasearlyaspossibleforobjectsthatdo\nnotmakeittothequeryresultset,weproposeatechniquewhich\nprogressivelymaintainsarunninglowerboundemd−andtightens\nemd− throughouttheentireEMDcalculationprocess. SIA,fora\nspecificrefinement,canterminateearlyiftherunninglowerbound\nbecomesnotsmallerthanthecurrentpruningthresholdθ(i.e.,the\nk-thlowestEMDfoundsofar).\nFirst,weuseapropertyofSSP(andSIA);ateachiteration,the\nminimum-costfeasiblepathisnonnegativewhenthecostmatrixC\ndoesnotincludeanynegativevalues[1]. Inotherwords, theac-\ncumulatedcostbyaugmentingflowsateachiterationismonotoni-\ncallynon-decreasing,andcanbeusedastherunninglowerbound\nofEMD. Forexample,Figure7(b)illustratestheaccumulationof\nthe EMD during SIA, for two 1024-bin histograms q and p. At\neachiteration,thecurrentcostrepresentstheaccumulationofthe\naugmentedcostsuptothatiteration;bycomparingitwiththecur-\nrentpruningthresholdθ (ignoretheotherseriesforthemoment),\nwecanobservethatSIAmayterminateassoonasthecurrentcost\nbecomesatleastequaltoθ(i.e.,ataround88.3%ofthetotaliter-\nations). Thispointcorrespondsto23.4%ofSIA’stotalexecution\ntime (cf. Figure 7(a)). Note that the current cost remains 0 until\nthe1024thiterationbecausetheshortestpathsuptothisiteration\ncorrespondtoflowsbetweenthesamebinsofqandp(i.e.,from\nq top forsomei∈[1,n],n=1024)withzerocosteach.\ni i\n1 q r 2/2 p r 0\ncurrent cost SIA / SSP\n1 q s 1/1 p s 0\n2/4 com b p y uted emd -\n0 q j 2/2 p j 0 estimated lower bound\ncost estimtaion\n1 q h p h 3\nFigure8:Runninglowerbound,emd−\nCurrent cost\nemd−\nBest bound from filter phase\nPruning threshold Although the current cost could be intuitively used as a lower\nboundforthefinal(actual)EMD,itisnotsufficientlytightsince\nit does not take the remaining feasible flow into consideration.\nThereby, we propose a running lower bound, emd−, which not\nonlyconsiderstheso-faraccumulatedflowcost,butalsoprovides\nan estimation to the cost of flows yet to be augmented. As Fig-\nure8illustrates, emd− consistsofthecurrentcost (partialEMD\n(b) Currentcost\nalreadycomputed)plusalowerboundforthecostoftheremaining\nflow. Theeffectivenessofemd−isshownintherunningexample\nFigure7:SIAperformanceondifferentiterations of Figure 7(b), where emd− grows much faster compared to the\n317\ncurrentcostandleadstoanearlyterminationofSIAforEMDcal- LEMMA2 (CORRECTNESSOFemd−). The running lower\nculations.Inthisexample,therunninglowerboundemd−reaches bound emd− is monotonically non-decreasing and always not\nthepruningthresholdθafteraugmenting61%iterationswhichtake greaterthanemd(q,p)throughouttheEMDcalculation.\nonly2.84%ofthetotalexecutiontime.Thisresultdemonstratesthe\nPROOF. Trivial, due to the monotonicity of the shortest path\neffectivenessofemd−inboostingEMD-basedsimilaritysearch.\ncosts from any vertex q (Lemma 1) and due to the fact that all\nWenowformallydefineemd−. First,Lemma1showsthatthe i\nremaining flow cap −f at q should be augmented in paths\ncostsoftheminimum-costfeasiblepathsbeingaugmentedfroma\nqi qi i\noriginatingatq .\ni\nvertexaremonotonicallynon-decreasing,whichformsabasisfor\nthedefinitionofthebound.\nLEMMA1 (COSTMONOTONICITYOFFEASIBLEPATHS). Table2:Fouraugmentedpathsandtheircosts\nGiven a flow graph for which there is a sequence of m i iteration feasiblepath c f (spi) f(spi) currentcost\nminimum-cost feasible paths sp ,...,sp from a node\nqi,1 qi,mi 1 sp1=(cid:104)e(q1,p1)(cid:105) 0.0 2 0.0\nq i ∈ q already been augmented in this order, the cost of 2 sp2=(cid:104)e(q3,p3)(cid:105) 0.0 2 0.0\nthese paths from q i is monotonically non-decreasing, i.e., 3 sp3=(cid:104)e(q2,p2)(cid:105) 0.0 1 0.0\nc\nf\n(sp\nqi,j\n)≤c\nf\n(sp\nqi,k\n),∀1≤j <k≤m\ni\n. 4 sp4=(cid:104)e(q2,p3)(cid:105) 0.6 2 1.2\nPROOF. Toprovethestatement,itsufficestoshowthatthecost\noftheshortestpathfromanyq ∈qtoanyp ∈pismonotonically\nUsingDefinition3,wecancomputeemd−byaddingtocurrent\ni j\nnon-decreasing throughout the entire flow augmentation process; costanestimatedlowerboundforallremainingfeasiblepathsorig-\ni.e., ct f −1(q i (cid:32) p j ) ≤ ct f (q i (cid:32) p j ), wherect f isthecostofthe inatingateachvertexq i , basedonthenode’sremainingcapacity\nshortest path from q i to p j after t augmentations. If this holds, (i.e.,cap qi −f qi )andthecostofthelastaugmentedfeasiblepath\nthenthecostoftheminimum-costfeasiblepathsfromq i mustbe fromq i .Lemma2provesthecorrectnessofthebound.Theexam-\nmonotonicallynon-decreasing,becauseateachiteration,SIApicks pleofFigure8illustratesthecomputationofemd−. Thereare4\nforq thepathwiththeminimumcost,andthereisalwaysafeasible pathsalreadyaugmented;theircostsanditerationorderareshown\ni\npathbetweenanypairofnodeswithremainingcapacity. inTable2. Thecurrentcostis1.2(= c f (sp 4 )f(sp 4 ) = 0.6·2)\nWeprovethisbycontradiction. Assumethatthemonotonicity andtheestimatedcostoftheremainingflows(computedusingthe\noftheshortestpathcostfromq i toavertexp j doesnothold,i.e., nodesofqinthedashed-lineregion)is0.6(= c f (sp 4 )(cap q2 −\nct f −1(q i (cid:32) p j ) > ct f (q i (cid:32) p j ), and assume that no path vio- f q2 )=0.6·(4−3)).Thereby,emd−is1.8whichismuchtighter\nlatesthemonotonicitypropertyuntilthet-thiteration. Inaddition, comparedtojustusingthecurrentcostasthelowerbound.\namongallpathsthatviolatethemonotonicitypropertyatthet-th Notethatthetimeofupdatingemd− duringSIAisnegligible.\nt i h te e ra p t r i e o c n e , d c i t f n ( g q v i e (cid:32) rtex p o j ) fp has in th t e he m s i h n o im rte u s m tp c a o th st , . w S e u h p a p v o e sethatq k is W (i.e h . e , n a e t v e e a r c a h n it e e w rat f i e o a n si o b f le SI p A at ) h ,w s e p r f e r fi om ne a em ve d r − tex by q : i ( i i s ) a a u d g d m in e g nt t e h d e\nj\naugmentationcostofsp(c (sp)·f(sp))tothecurrentcostcompo-\nct f (q i (cid:32)p j )=ct f (q i (cid:32)q k )+ct f (q k ,p j )≥ct f (q i (cid:32)q k ). nentofemd−;(ii)subtrac f tingthepreviousestimatedcostforq i in\nIn addition, based on our assumption, no vertex violates the theestimatedcostcomponent;(iii)addingthenewestimatedcost\nmonotonicitypropertybeforethet-thaugmentation.Thereby, ofq i . Eachofthesethreeincrementstakesconstanttime(infact,\n(ii)isalreadycached),sotheupdateofemd−takesO(1)time.\nct−1(q (cid:32)q )≤ct(q (cid:32)q )\nf i k f i k Summing up, our progressive bounding (PB) approach, during\nBycombiningtheequations,weget theEMDcalculationforacandidate,progressivelymaintainsand\ntightenstherunninglowerboundemd− andprunestheobjectas\nct f −1(q i (cid:32)p j )>ct f (q i (cid:32)p j )≥ct f (q i (cid:32)q k )≥ct f −1(q i (cid:32)q k ) soon as the intermediate emd− reaches the pruning threshold θ.\nIfe(q ,p )isfeasibleinGt−1,then: PBsavesunnecessarycomputationsatthelatter(expensive)stages\nk j\nofSIAforcandidateobjectsthatdonotmakeittothek-NNresult\nct f −1(q i (cid:32)p j )≤ct f −1(q i (cid:32)q k )+ct f −1(q k ,p j ) (i.e.,conductingonlythenecessaryportionoftheentireflowcal-\n≤ct(q (cid:32)q )+ct(q ,p )=ct(q (cid:32)p ); culation),andthusreducesthecostofeachindividualrefinement.\nf i k f k j f i j\notherwise(e(p ,q )isfeasibleinGt−1): 4.3 SensitivitytoRefinementOrder\nj k\nct−1(q (cid:32)q )≥ct−1(q (cid:32)p )+ct−1(q ,p ) Sofar, wehavediscussedhowtoterminateasingleEMDcal-\nf i k f i j f k j culation early by the progressive bounding technique. Still, the\n>ct f (q i (cid:32)p j )+ct f (q k ,p j )≥ct f (q i (cid:32)q k ). performanceofak-NNquerydoesnotdependonlyonindividual\nEMDcalculationsbutalsoontheamountandprogressesofEMD\nBothcasescontradictourassumptions.\ncalculations. AccordingtoAlgorithm1,theEMDforanobjectp\nDEFINITION3 (RUNNINGLOWERBOUND,emd−). isessentiallyrefinedifallestimatedlowerboundslb\np\n(atthefilter\nConsideraflowgraph,suchthatforeachnodeq i ∈ q,thereisa phase) are smaller than the pruning threshold θ (line 6 of Algo-\nsetofm i augmentedpathssp qi,1 ,...,sp qi,mi .Therunninglower rithm1),whereθisthek-thbest-so-farEMDvalue.\nboundemd−isdefinedas Figure9showstheEMDvaluesoftheaccessedobjectsduring\nemd− = (cid:88)(cid:88)\nmi\nc (sp )·f(sp )+ (currentcost) a\na4\nba\n-N\nr\nN\nsho\nq\nw\nue\ns\nr\nt\ny\nh\ne\ne\nx\nr\ne\ne\nc\na\nu\nl\nt\nE\nio\nM\nn\nD\nus\nv\nin\na\ng\nlu\nA\ne\nl\ne\ng\nm\nor\nd\nit\n(\nh\nq\nm\n,p\n1\n)\n.\n,\nF\nt\no\nh\nr\ne\ne\nb\na\ne\nc\ns\nh\ntl\nc\no\na\nw\nnd\ne\ni\nr\nd\nb\na\no\nte\nun\np\nd\n,\nf qi,j qi,j\nlb fromthefilterphase,andthepruningthresholdθatthetimeof\nqi∈qj=1 p\n(cid:88) p’sverification. Everyrefinedcandidatecanpotentiallydecrease\nc (sp )·(cap −f ), (estimatedcost)\nf qi,mi qi qi thepruningthresholdθ ifitreplacesanotherobjectinthecurrent\nqi∈q k-NNsetH.Forinstance,θisdecreasedafteraccessingandrefin-\nwherecap indicatesthetotalflowcapacityofnodev,andf in- ingthe6-thobject.Observethattheorderbywhichtheobjectsare\nv v\ndicatestheflowunitsalreadyaugmentedfromvsofar. accessedisnotconsistentwiththeirrealEMDvalues.Ontheother\n318\n",
      "summary": "This work proposes progressive bounding and dynamic refinement ordering to optimize the refinement phase in EMD-based similarity search by enhancing the efficiency of multiple EMD calculations, using SIA as a scalable module for computing Earth Mover's Distance between histograms."
    },
    {
      "title": "4.3 Sensitivity to Refinement Order",
      "start_index": 6,
      "end_index": 7,
      "nodes": [],
      "node_id": "0010",
      "text": "currentcostandleadstoanearlyterminationofSIAforEMDcal- LEMMA2 (CORRECTNESSOFemd−). The running lower\nculations.Inthisexample,therunninglowerboundemd−reaches bound emd− is monotonically non-decreasing and always not\nthepruningthresholdθafteraugmenting61%iterationswhichtake greaterthanemd(q,p)throughouttheEMDcalculation.\nonly2.84%ofthetotalexecutiontime.Thisresultdemonstratesthe\nPROOF. Trivial, due to the monotonicity of the shortest path\neffectivenessofemd−inboostingEMD-basedsimilaritysearch.\ncosts from any vertex q (Lemma 1) and due to the fact that all\nWenowformallydefineemd−. First,Lemma1showsthatthe i\nremaining flow cap −f at q should be augmented in paths\ncostsoftheminimum-costfeasiblepathsbeingaugmentedfroma\nqi qi i\noriginatingatq .\ni\nvertexaremonotonicallynon-decreasing,whichformsabasisfor\nthedefinitionofthebound.\nLEMMA1 (COSTMONOTONICITYOFFEASIBLEPATHS). Table2:Fouraugmentedpathsandtheircosts\nGiven a flow graph for which there is a sequence of m i iteration feasiblepath c f (spi) f(spi) currentcost\nminimum-cost feasible paths sp ,...,sp from a node\nqi,1 qi,mi 1 sp1=(cid:104)e(q1,p1)(cid:105) 0.0 2 0.0\nq i ∈ q already been augmented in this order, the cost of 2 sp2=(cid:104)e(q3,p3)(cid:105) 0.0 2 0.0\nthese paths from q i is monotonically non-decreasing, i.e., 3 sp3=(cid:104)e(q2,p2)(cid:105) 0.0 1 0.0\nc\nf\n(sp\nqi,j\n)≤c\nf\n(sp\nqi,k\n),∀1≤j <k≤m\ni\n. 4 sp4=(cid:104)e(q2,p3)(cid:105) 0.6 2 1.2\nPROOF. Toprovethestatement,itsufficestoshowthatthecost\noftheshortestpathfromanyq ∈qtoanyp ∈pismonotonically\nUsingDefinition3,wecancomputeemd−byaddingtocurrent\ni j\nnon-decreasing throughout the entire flow augmentation process; costanestimatedlowerboundforallremainingfeasiblepathsorig-\ni.e., ct f −1(q i (cid:32) p j ) ≤ ct f (q i (cid:32) p j ), wherect f isthecostofthe inatingateachvertexq i , basedonthenode’sremainingcapacity\nshortest path from q i to p j after t augmentations. If this holds, (i.e.,cap qi −f qi )andthecostofthelastaugmentedfeasiblepath\nthenthecostoftheminimum-costfeasiblepathsfromq i mustbe fromq i .Lemma2provesthecorrectnessofthebound.Theexam-\nmonotonicallynon-decreasing,becauseateachiteration,SIApicks pleofFigure8illustratesthecomputationofemd−. Thereare4\nforq thepathwiththeminimumcost,andthereisalwaysafeasible pathsalreadyaugmented;theircostsanditerationorderareshown\ni\npathbetweenanypairofnodeswithremainingcapacity. inTable2. Thecurrentcostis1.2(= c f (sp 4 )f(sp 4 ) = 0.6·2)\nWeprovethisbycontradiction. Assumethatthemonotonicity andtheestimatedcostoftheremainingflows(computedusingthe\noftheshortestpathcostfromq i toavertexp j doesnothold,i.e., nodesofqinthedashed-lineregion)is0.6(= c f (sp 4 )(cap q2 −\nct f −1(q i (cid:32) p j ) > ct f (q i (cid:32) p j ), and assume that no path vio- f q2 )=0.6·(4−3)).Thereby,emd−is1.8whichismuchtighter\nlatesthemonotonicitypropertyuntilthet-thiteration. Inaddition, comparedtojustusingthecurrentcostasthelowerbound.\namongallpathsthatviolatethemonotonicitypropertyatthet-th Notethatthetimeofupdatingemd− duringSIAisnegligible.\nt i h te e ra p t r i e o c n e , d c i t f n ( g q v i e (cid:32) rtex p o j ) fp has in th t e he m s i h n o im rte u s m tp c a o th st , . w S e u h p a p v o e sethatq k is W (i.e h . e , n a e t v e e a r c a h n it e e w rat f i e o a n si o b f le SI p A at ) h ,w s e p r f e r fi om ne a em ve d r − tex by q : i ( i i s ) a a u d g d m in e g nt t e h d e\nj\naugmentationcostofsp(c (sp)·f(sp))tothecurrentcostcompo-\nct f (q i (cid:32)p j )=ct f (q i (cid:32)q k )+ct f (q k ,p j )≥ct f (q i (cid:32)q k ). nentofemd−;(ii)subtrac f tingthepreviousestimatedcostforq i in\nIn addition, based on our assumption, no vertex violates the theestimatedcostcomponent;(iii)addingthenewestimatedcost\nmonotonicitypropertybeforethet-thaugmentation.Thereby, ofq i . Eachofthesethreeincrementstakesconstanttime(infact,\n(ii)isalreadycached),sotheupdateofemd−takesO(1)time.\nct−1(q (cid:32)q )≤ct(q (cid:32)q )\nf i k f i k Summing up, our progressive bounding (PB) approach, during\nBycombiningtheequations,weget theEMDcalculationforacandidate,progressivelymaintainsand\ntightenstherunninglowerboundemd− andprunestheobjectas\nct f −1(q i (cid:32)p j )>ct f (q i (cid:32)p j )≥ct f (q i (cid:32)q k )≥ct f −1(q i (cid:32)q k ) soon as the intermediate emd− reaches the pruning threshold θ.\nIfe(q ,p )isfeasibleinGt−1,then: PBsavesunnecessarycomputationsatthelatter(expensive)stages\nk j\nofSIAforcandidateobjectsthatdonotmakeittothek-NNresult\nct f −1(q i (cid:32)p j )≤ct f −1(q i (cid:32)q k )+ct f −1(q k ,p j ) (i.e.,conductingonlythenecessaryportionoftheentireflowcal-\n≤ct(q (cid:32)q )+ct(q ,p )=ct(q (cid:32)p ); culation),andthusreducesthecostofeachindividualrefinement.\nf i k f k j f i j\notherwise(e(p ,q )isfeasibleinGt−1): 4.3 SensitivitytoRefinementOrder\nj k\nct−1(q (cid:32)q )≥ct−1(q (cid:32)p )+ct−1(q ,p ) Sofar, wehavediscussedhowtoterminateasingleEMDcal-\nf i k f i j f k j culation early by the progressive bounding technique. Still, the\n>ct f (q i (cid:32)p j )+ct f (q k ,p j )≥ct f (q i (cid:32)q k ). performanceofak-NNquerydoesnotdependonlyonindividual\nEMDcalculationsbutalsoontheamountandprogressesofEMD\nBothcasescontradictourassumptions.\ncalculations. AccordingtoAlgorithm1,theEMDforanobjectp\nDEFINITION3 (RUNNINGLOWERBOUND,emd−). isessentiallyrefinedifallestimatedlowerboundslb\np\n(atthefilter\nConsideraflowgraph,suchthatforeachnodeq i ∈ q,thereisa phase) are smaller than the pruning threshold θ (line 6 of Algo-\nsetofm i augmentedpathssp qi,1 ,...,sp qi,mi .Therunninglower rithm1),whereθisthek-thbest-so-farEMDvalue.\nboundemd−isdefinedas Figure9showstheEMDvaluesoftheaccessedobjectsduring\nemd− = (cid:88)(cid:88)\nmi\nc (sp )·f(sp )+ (currentcost) a\na4\nba\n-N\nr\nN\nsho\nq\nw\nue\ns\nr\nt\ny\nh\ne\ne\nx\nr\ne\ne\nc\na\nu\nl\nt\nE\nio\nM\nn\nD\nus\nv\nin\na\ng\nlu\nA\ne\nl\ne\ng\nm\nor\nd\nit\n(\nh\nq\nm\n,p\n1\n)\n.\n,\nF\nt\no\nh\nr\ne\ne\nb\na\ne\nc\ns\nh\ntl\nc\no\na\nw\nnd\ne\ni\nr\nd\nb\na\no\nte\nun\np\nd\n,\nf qi,j qi,j\nlb fromthefilterphase,andthepruningthresholdθatthetimeof\nqi∈qj=1 p\n(cid:88) p’sverification. Everyrefinedcandidatecanpotentiallydecrease\nc (sp )·(cap −f ), (estimatedcost)\nf qi,mi qi qi thepruningthresholdθ ifitreplacesanotherobjectinthecurrent\nqi∈q k-NNsetH.Forinstance,θisdecreasedafteraccessingandrefin-\nwherecap indicatesthetotalflowcapacityofnodev,andf in- ingthe6-thobject.Observethattheorderbywhichtheobjectsare\nv v\ndicatestheflowunitsalreadyaugmentedfromvsofar. accessedisnotconsistentwiththeirrealEMDvalues.Ontheother\n318\n2.0\n1.5\n1.0\n0.5\n0.0 10 20 30 40\nAccess order\nDME\nBest bound from filter phase Real EMD\nAlgorithm3DYNAMICREFINEMENTORDERING\nPruning threshold H,PL:heap,θ:pruningthreshold\np5 Functiongetnextfilter(Queryq,IndexI,Filters∆)\n1: whileI.getnext(q,θ,(cid:104)p,lbp(cid:105))do\n2: forδi∈∆do (cid:46)Filterphase\n3: lbp:=max{lbp,δi(q,p)}\n4: iflbp≥θthenbreakloop\n5: iflbp<θthenreturn(cid:104)p,lbp,∞(cid:105)\nAlgorithmDRO-kNN(Queryq,IndexI,sizeb)\n6: θ:=∞;H:=∅;PL:=∅\nFigure9:Accessorderofak-NNsearch 7: while|PL|<bdo\n8: PL:=PL∪getnextfilter(q,I,∆)\n9: while|PL|(cid:54)=∅do\nhand, the amount of EMD calculations would have been greatly 10: pop(cid:104)p,emd− p,emd+ p(cid:105)fromPL (cid:46)e.g.,lowestemd− p\nreducedifwehadconsideredtheobjectsinabetterorder. Forin- 11: whileemd−\np\n<PL.top().emd−do\nstance,ifwehadaccessedthe6-thand7-thobjectsbeforethe5-th 12: augmentnextshortestpathinemd(q,p)\nobject p 5 , then p 5 would have been filtered since its best lower 13: ifemd− p ≥θ∨emd− p =emd+ p then\nboundwouldhavebeenlargerthanθinthiscase.Notethatabetter 14: PL:=PL∪getnextfilter(q,I,∆)\naccess order not only filters more objects, but also decreases the 15: breakloop\npruning threshold θ faster such that individual EMD calculations 16: ifemd+ p <θthen\ncanbeterminatedearlierowingtotheprogressingboundingtech- 17: updateHtoincludethenew(cid:104)p,emd+ p(cid:105)\nnique. Unfortunately,theaccessorderofthestate-of-the-artfilter- 18: θ:=k-thEMDvalueinH\nand-refinementframeworkisbasedonthegetnextfunction(pro- 19: forallp∈PLsuchthatemd− p ≥θdo\n20: removepfromPL\nvidedbythenormaldistributionindex[25]ortheTBIindex[32]),\n21: PL:=PL∪getnextfilter(q,I,∆)\nwhichjustreturnsanyunseenobjectphavinglowerboundsmaller\n22: ifloopnotbrokenthen\nthanagiventhresholdθ. Asshowninthisexample,thereisroom 23: PL:=PL ∪ p (cid:46)addpbacktoPL\ntoimprovetheaccessordersuchthatobjectsthatarelikelytohave 24: returnH\nsmallerEMDvalueshavehigherchancestoberefinedearlier.Mo-\ntivatedbythisanalysis,weproposeanoveltechniquethatdefines\nandfollowsadynamicaccessorderofthecandidates. element is the object with the smallest emd−. At each iteration,\nDROde-heapsthetopobjectpinPLandprogressivelyrefinesthe\n4.4 DynamicRefinementOrdering\ncurrent emd(q,p) by iteratively augmenting shortest paths (i.e.,\nThemainideabehindourdynamicrefinementordering(DRO) usingSIA)whileemd−isstillsmallerthanPL.top().emd−(i.e,\np\napproach in refining candidates during EMD-based similarity thesmallestemd−inPL). Apathaugmentationincreasesemd−\np\nsearch is to conduct the refinement for multiple candidates con- and decreases emd+. If emd− ≥ θ, then the current object p\np p\ncurrently. Thus, given a priority layer PL set of b candidates is pruned because in the best case it cannot become better than\n(PL ⊆ D), such that each p ∈ PL passes all filters based on thecurrentknearestneighbors(seeSection4.2);DROcallsfunc-\nthecurrentthresholdθ,theobjectiveofDROistorefineallobjects tiongetnext filtertoaddanothercandidateinPLinplaceofp\ninPLconcurrently,byaugmentingpathstotheEMDofp∈PL, (line14). Ifemd+ < θ,pisupdatedinH andthethresholdθis\np\nwhichiscurrentlythemostpromisingobjectinPL.Intuitively,an updatedaccordingly(line18).Afterθisupdated,weremovefrom\nobjectispromisingtoaugmentflowsonitscorrespondingEMD,if PLobjectswhoselowerboundsarealreadygreaterthanorequal\ntheaugmentationscanmakethethresholdθlowerorpruneobjects to θ (line 19). The removal is facilitated by an additional heap\nfromPL.Forinstance,therunninglowerboundemd−canbeused\nstructure that indexes objects in descending order of their lower\ntoprioritizeobjects,sinceaugmentinganobjecthavingthelowest bounds. If,aftersomeaugmentations,emd− becomesnosmaller\np\nemd−mayupdatethebestkobjectsfoundsofaranddecreasethe thanPL.top().emd−(line11)andphasnotbeenpruned,itisput\nthreshold θ early. The augmentations result in the increase (i.e., back to PL (line 23) and the top object of PL takes its place in\ntightening)ofemd−\np\n6,whichmaycauseanotherobjectp(cid:48)totake\ntheinnerpathaugmentationloop. Notethatobjectsthatmaynot\ntheplaceofpasthemostpromisingoneandberefinedbyDRO befurtherrefined(i.e., conditionemd− = emd+ atline13)are\np p\ninthenextstep. Thus, DROalwaysrefinestheobjectpwiththe eitherpruned(ifemd ≥θ)oraddedtoH(ifemd <θ).\np p\ncurrentlybestpromisingvalueandcheckswhetherpcanbepruned\nafterupdating(i.e.,increasing)emd−.Ifthispruninghappens,pis\np\nreplacedbyanothercandidateobjectinPL.DROalsokeepstrack PL\noftheupperboundemd+foreachobjectp∈PL;ifthecurrently\np Pruning\nrefinedobject’supperboundbecomessmallerthanθ,thenthecur-\nrent top-k result is updated to include p. The details on how to threshold, θ p4 p6 p7\ncomputeandupdateanupperboundofapartiallycomputedEMD p1 p2 p3 p5\naregiveninSection4.5.DROcontinuesuntilPLbecomesempty.\nAlgorithm 3 is a pseudocode of the DRO strategy for EMD-\nbasedk-NNsearch. DROusesfunctiongetnext filtertogetthe\nnextobjectfromD,whichpassesallfilterswithrespecttothecur-\nFigure10:Prioritizingrefinementorder\nrent threshold θ. First, DRO calls this function b times to form\ntheinitialPL. PLisstoredasapriorityqueue,inwhichthetop\nFigure 10 illustrates a running instance of DRO. The current\n6Fortheeaseofpresentation,wedenoteemd−(q,p)byemd−,as lowerandupperboundsofeachobjectareindicatedbytheborders\np\nthequeryhistogramqisthesameforallobjectsinD. of a bar. Suppose k = 3 and there are 7 objects (= b) in PL.\n319\n",
      "summary": "The running lower bound emd− is monotonically non-decreasing and always less than or equal to the true EMD, enabling early termination in similarity search by reaching the pruning threshold with minimal computational cost."
    },
    {
      "title": "4.4 Dynamic Refinement Ordering",
      "start_index": 7,
      "end_index": 8,
      "nodes": [],
      "node_id": "0011",
      "text": "2.0\n1.5\n1.0\n0.5\n0.0 10 20 30 40\nAccess order\nDME\nBest bound from filter phase Real EMD\nAlgorithm3DYNAMICREFINEMENTORDERING\nPruning threshold H,PL:heap,θ:pruningthreshold\np5 Functiongetnextfilter(Queryq,IndexI,Filters∆)\n1: whileI.getnext(q,θ,(cid:104)p,lbp(cid:105))do\n2: forδi∈∆do (cid:46)Filterphase\n3: lbp:=max{lbp,δi(q,p)}\n4: iflbp≥θthenbreakloop\n5: iflbp<θthenreturn(cid:104)p,lbp,∞(cid:105)\nAlgorithmDRO-kNN(Queryq,IndexI,sizeb)\n6: θ:=∞;H:=∅;PL:=∅\nFigure9:Accessorderofak-NNsearch 7: while|PL|<bdo\n8: PL:=PL∪getnextfilter(q,I,∆)\n9: while|PL|(cid:54)=∅do\nhand, the amount of EMD calculations would have been greatly 10: pop(cid:104)p,emd− p,emd+ p(cid:105)fromPL (cid:46)e.g.,lowestemd− p\nreducedifwehadconsideredtheobjectsinabetterorder. Forin- 11: whileemd−\np\n<PL.top().emd−do\nstance,ifwehadaccessedthe6-thand7-thobjectsbeforethe5-th 12: augmentnextshortestpathinemd(q,p)\nobject p 5 , then p 5 would have been filtered since its best lower 13: ifemd− p ≥θ∨emd− p =emd+ p then\nboundwouldhavebeenlargerthanθinthiscase.Notethatabetter 14: PL:=PL∪getnextfilter(q,I,∆)\naccess order not only filters more objects, but also decreases the 15: breakloop\npruning threshold θ faster such that individual EMD calculations 16: ifemd+ p <θthen\ncanbeterminatedearlierowingtotheprogressingboundingtech- 17: updateHtoincludethenew(cid:104)p,emd+ p(cid:105)\nnique. Unfortunately,theaccessorderofthestate-of-the-artfilter- 18: θ:=k-thEMDvalueinH\nand-refinementframeworkisbasedonthegetnextfunction(pro- 19: forallp∈PLsuchthatemd− p ≥θdo\n20: removepfromPL\nvidedbythenormaldistributionindex[25]ortheTBIindex[32]),\n21: PL:=PL∪getnextfilter(q,I,∆)\nwhichjustreturnsanyunseenobjectphavinglowerboundsmaller\n22: ifloopnotbrokenthen\nthanagiventhresholdθ. Asshowninthisexample,thereisroom 23: PL:=PL ∪ p (cid:46)addpbacktoPL\ntoimprovetheaccessordersuchthatobjectsthatarelikelytohave 24: returnH\nsmallerEMDvalueshavehigherchancestoberefinedearlier.Mo-\ntivatedbythisanalysis,weproposeanoveltechniquethatdefines\nandfollowsadynamicaccessorderofthecandidates. element is the object with the smallest emd−. At each iteration,\nDROde-heapsthetopobjectpinPLandprogressivelyrefinesthe\n4.4 DynamicRefinementOrdering\ncurrent emd(q,p) by iteratively augmenting shortest paths (i.e.,\nThemainideabehindourdynamicrefinementordering(DRO) usingSIA)whileemd−isstillsmallerthanPL.top().emd−(i.e,\np\napproach in refining candidates during EMD-based similarity thesmallestemd−inPL). Apathaugmentationincreasesemd−\np\nsearch is to conduct the refinement for multiple candidates con- and decreases emd+. If emd− ≥ θ, then the current object p\np p\ncurrently. Thus, given a priority layer PL set of b candidates is pruned because in the best case it cannot become better than\n(PL ⊆ D), such that each p ∈ PL passes all filters based on thecurrentknearestneighbors(seeSection4.2);DROcallsfunc-\nthecurrentthresholdθ,theobjectiveofDROistorefineallobjects tiongetnext filtertoaddanothercandidateinPLinplaceofp\ninPLconcurrently,byaugmentingpathstotheEMDofp∈PL, (line14). Ifemd+ < θ,pisupdatedinH andthethresholdθis\np\nwhichiscurrentlythemostpromisingobjectinPL.Intuitively,an updatedaccordingly(line18).Afterθisupdated,weremovefrom\nobjectispromisingtoaugmentflowsonitscorrespondingEMD,if PLobjectswhoselowerboundsarealreadygreaterthanorequal\ntheaugmentationscanmakethethresholdθlowerorpruneobjects to θ (line 19). The removal is facilitated by an additional heap\nfromPL.Forinstance,therunninglowerboundemd−canbeused\nstructure that indexes objects in descending order of their lower\ntoprioritizeobjects,sinceaugmentinganobjecthavingthelowest bounds. If,aftersomeaugmentations,emd− becomesnosmaller\np\nemd−mayupdatethebestkobjectsfoundsofaranddecreasethe thanPL.top().emd−(line11)andphasnotbeenpruned,itisput\nthreshold θ early. The augmentations result in the increase (i.e., back to PL (line 23) and the top object of PL takes its place in\ntightening)ofemd−\np\n6,whichmaycauseanotherobjectp(cid:48)totake\ntheinnerpathaugmentationloop. Notethatobjectsthatmaynot\ntheplaceofpasthemostpromisingoneandberefinedbyDRO befurtherrefined(i.e., conditionemd− = emd+ atline13)are\np p\ninthenextstep. Thus, DROalwaysrefinestheobjectpwiththe eitherpruned(ifemd ≥θ)oraddedtoH(ifemd <θ).\np p\ncurrentlybestpromisingvalueandcheckswhetherpcanbepruned\nafterupdating(i.e.,increasing)emd−.Ifthispruninghappens,pis\np\nreplacedbyanothercandidateobjectinPL.DROalsokeepstrack PL\noftheupperboundemd+foreachobjectp∈PL;ifthecurrently\np Pruning\nrefinedobject’supperboundbecomessmallerthanθ,thenthecur-\nrent top-k result is updated to include p. The details on how to threshold, θ p4 p6 p7\ncomputeandupdateanupperboundofapartiallycomputedEMD p1 p2 p3 p5\naregiveninSection4.5.DROcontinuesuntilPLbecomesempty.\nAlgorithm 3 is a pseudocode of the DRO strategy for EMD-\nbasedk-NNsearch. DROusesfunctiongetnext filtertogetthe\nnextobjectfromD,whichpassesallfilterswithrespecttothecur-\nFigure10:Prioritizingrefinementorder\nrent threshold θ. First, DRO calls this function b times to form\ntheinitialPL. PLisstoredasapriorityqueue,inwhichthetop\nFigure 10 illustrates a running instance of DRO. The current\n6Fortheeaseofpresentation,wedenoteemd−(q,p)byemd−,as lowerandupperboundsofeachobjectareindicatedbytheborders\np\nthequeryhistogramqisthesameforallobjectsinD. of a bar. Suppose k = 3 and there are 7 objects (= b) in PL.\n319\nNote that the currently best object in PL (in terms of emd−) is runningupperboundemd+isdefinedas\np ,soDROrefinesthecurrentEMDofp byaugmentingflows.\nA sh\n4\nf a te d r ed th b e a a r. ug N m o e t n e t t a h ti a o t n e , m th d e − EM n D ow bo b u ec n o d m so e\n4\ns fp th 4 e a l r o e w u e p s d t a e t m ed d t − o , th so e emd+ = (cid:88)(cid:88)\nmi\nc f (sp qi,j )·f(sp qi,j )+ (currentcost)\np5 qi∈qj=1\ntherefinementofp isstalled;inthenextiteration,p isde-heaped\n4 5 maxflow(q,p), (maximumflow)\nfromPLandrefined. AfteraugmentingflowstotheEMDofp ,\n5\nthe EMD bounds of p 5 are updated as shown by the shaded bar. wheremaxflow(q,p)returnsthecostofamaximumflowbased\nObservethatnowemd+ p5 <θ;thiscauses(i)p 5 tobeincludedin ontheremainingcapacitiesofqandp.\nthecurrentlybestkobjectsHand(ii)θtobeupdatedtoemd+ .\np2 Tocomputeemd+,wecanapplyanymaximumflowalgorithm;\nDROisexpectedtobemoreefficientthanconsideringthecan-\nhowever,existingmaximumflowalgorithmsaretooexpensive[1],\ndidatesthatpassthefiltersonebyoneandcomputingtheirexact\nconsidering the fact that emd+ should be maintained throughout\nEMD individually. Concurrent refinement by prioritizing candi-\ndateswiththelowestemd−performsthefirst(cheap)iterationsof the entire EMD calculation. Instead of using these methods, we\nSIAformanycandidatesandhelpsinderivingupperboundsemd+ proposeanefficientgreedyapproach,whichtakesadvantageofthe\nforthemandagoodestimateofθearly. Obtainingatightθearly EMD flow network topology; note that the EMD flow graph is a\ncompletebipartitegraphbetweenthebinsofqandp. Thismeans\ncan help (i) to prune more candidates using the filters (function\ngetnext filter)and(ii)toavoidthelateandexpensivepathaug- that a feasible vertex of q can always augment flow to any fea-\nmentationsofSIAformanycandidatesinPLthatcanbepruned. siblevertex ofpalongone edge. OurGreedyUBalgorithm (Al-\nThe choice of b (i.e., the size of PL) affects the performance gorithm4), foreachfeasiblevertexq i ofq, accessesthefeasible\nofDRO;ifbisverylarge,DROperformsmultipleconcurrentSIA verticesp j ofpinincreasingorderofc i,j andaugmentsthemax-\nexecutionswhichmayhavehighmemoryrequirements. Ifbistoo imum possible flow along each edge e(q i ,p j ), until the remain-\nsmall, the pruning threshold θ does not converge fast to its final ing capacity from q i has been used up. The accumulated cost of\nthe greedily augmented flows is used as the maxflow component\nvalue,andmoreobjectsentertherefinementphase. Clearly,there\nmaxflow(q,p)ofemd+(q,p).\nisatradeoffbetweentheperformancegainandmemoryconsump-\ntion. Inourexperiments,everySIAthreadonlyconstructsasmall\nportionoftheentireflowgraph.Thereby,bcanbesettoarelatively Algorithm4GREEDYUPPERBOUND\nlargenumber.Forinstance,whenbissetto0.2%ofthedatacardi- AlgorithmGreedyUB(Histogramsq,p)\nnality,thepeakmemoryconsumptionofDROonthelargestdataset 1: cost:=0\nofourexperimentalevaluation,WORLD,isjustaround20timesof\n2: while∃feasibleqido\nacompleteflowgraphinasingleEMDcomputation.Moreover,we 4 3 : : whi p le j c : a = pq f i ea > sib f le qi b d in o inphavingmini (cid:46) m q u i m ha c s i, r j emainingcapacity\nstudyamechanismtoavoidworstcases(e.g.,everypartialgraphin 5: flow:=min{capqi −fqi ,cappj −fpj }\nPLisfull).WhenthesizeofPLexceedsalimit,westopinserting 6: fqi :=fqi +flow\ncandidates into PL and refine the current EMD by PB until it is 7: fpi :=fpi +flow\nprunedorbecomesak-NNcandidate. However,inallofourex- 8: cost:=cost+ci,j·flow\nperimentaltestings,thismechanismisnevertriggeredasthesizeof 9: returncost\nPLismuchsmallerthanourdefaultmemorylimit(i.e.,512MB).\nTofacilitateGreedyUB,foreachrowiofthecostmatrixC,we\n4.5 RunningUpperBound defineanorderforthebinsjbasedonc (thisorderisstatic,i.e.,\ni,j\nWenowdiscussthedetailsofcomputingandmaintainingarun- independentofthedataandqueries,anditisdefinedonce,together\nningupperboundemd+foranobjectpwhoseEMDhaspartially withthegrounddistancefunctionorcostmatrix).Forexample,for\np\nbeencomputedbySIA. TheupperboundsareusedbyDRO(pre- rowq 1 ofthematrixshowninTable1,theorderis{p 1 ,p 3 ,p 4 ,p 2 }.\nsentedinSection4.4)toderiveavalueforθafterhavingpartially Then,inAlgorithm4line4,thisorderisconsideredforidentifying\ncomputedtheEMDofsomecandidateobjects. Accordingtothe feasiblebinsp j forthecurrentvertexq i . Thus,thecomplexityof\nEMDdefinition,anyflowmatrixFsatisfyingallthreeconditions thegreedyalgorithmisO(|E|),whereEindicatestheedgesinthe\nofEquation2mustleadtoanupperboundoftheactualEMD.For graph,sincethereareatmost|E|feasiblepairsintheEMDflow\ntheeaseofdiscussion,wecallaflowmatrixFpossibleifitsatisfies graph, i.e., much lower compared to the complexity of standard\nallthesethreeoptimizationconstraints;theconstraintsaresatisfied maximumflowalgorithms(e.g.,O(|V||E|)).\nif and only if there is no more feasible path in the flow network.\nSimilartoemd−,wecanupdateemd+incrementallyaftereach\nThus, finding a possible flow matrix F is equivalent to finding a pathaugmentationduringtherefinementofanEMD. Afterevery\nmaximumflowinthenetwork[1],disregardingedgecosts. augmentationofSIA,accordingtothecapacityfeasibility,wecan-\nBased on the above discussion, we can define a running upper celandre-augment(forthosethatbecomefeasibleafterthecance-\nboundemd+followingthesameideaofderivingemd−.Similarto lation)thecorrespondingflowsinthemaximumflowgraphformed\ntheillustrationinFigure8,emd+consistsofthecurrentcostplus by the greedy algorithm. The number of canceled/re-augmented\nanupperboundconsideringthenodeswhichstillhaveremaining edges in the maximum flow instance is at most equal to the flow\nflowcapacity(i.e.,theverticesinsidethedashed-lineregions).For unitsf justbeingaugmentedinthecurrentEMDflow. Thereby,\ninstance, a maximum flow of the vertices inside the dashed-line\nthemaintenancecostofemd+aftereachaugmentationisO(f).\nregion is (q ,p ,1), (q ,p ,1), and (q ,p ,1). The cost of this\n1 4 2 4 4 4\nmaxflowis0.7+0.9+0=1.6;thus,emd+is1.2(currentcost)+ 5. EXPERIMENTALEVALUATION\n1.6=2.8.Formally,wedefinetherunningupperboundasfollows. Inthissection,weconductextensiveexperimentstoevaluatethe\nperformanceofourproposedEMD-basedsimilaritysearchframe-\nDEFINITION4 (RUNNINGUPPERBOUND,emd+). work and compare it with state-of-the-art solutions. All methods\nConsider a flow graph, such that for each node p ∈ p, areimplementedinC++andevaluatedon3.40GHzquad-corema-\ni\nthere is a set of m augmented paths sp ,...,sp . The chinesrunningUbuntu12.04,with16GBytesofmainmemory.\ni qi,1 qi,mi\n320\n",
      "summary": "The Dynamic Refinement Ordering (DRO) approach improves EMD-based k-NN search efficiency by dynamically prioritizing candidate objects for refinement based on evolving lower bounds, thereby enhancing pruning and reducing unnecessary computations."
    },
    {
      "title": "4.5 Running Upper Bound",
      "start_index": 8,
      "end_index": 9,
      "nodes": [],
      "node_id": "0012",
      "text": "Note that the currently best object in PL (in terms of emd−) is runningupperboundemd+isdefinedas\np ,soDROrefinesthecurrentEMDofp byaugmentingflows.\nA sh\n4\nf a te d r ed th b e a a r. ug N m o e t n e t t a h ti a o t n e , m th d e − EM n D ow bo b u ec n o d m so e\n4\ns fp th 4 e a l r o e w u e p s d t a e t m ed d t − o , th so e emd+ = (cid:88)(cid:88)\nmi\nc f (sp qi,j )·f(sp qi,j )+ (currentcost)\np5 qi∈qj=1\ntherefinementofp isstalled;inthenextiteration,p isde-heaped\n4 5 maxflow(q,p), (maximumflow)\nfromPLandrefined. AfteraugmentingflowstotheEMDofp ,\n5\nthe EMD bounds of p 5 are updated as shown by the shaded bar. wheremaxflow(q,p)returnsthecostofamaximumflowbased\nObservethatnowemd+ p5 <θ;thiscauses(i)p 5 tobeincludedin ontheremainingcapacitiesofqandp.\nthecurrentlybestkobjectsHand(ii)θtobeupdatedtoemd+ .\np2 Tocomputeemd+,wecanapplyanymaximumflowalgorithm;\nDROisexpectedtobemoreefficientthanconsideringthecan-\nhowever,existingmaximumflowalgorithmsaretooexpensive[1],\ndidatesthatpassthefiltersonebyoneandcomputingtheirexact\nconsidering the fact that emd+ should be maintained throughout\nEMD individually. Concurrent refinement by prioritizing candi-\ndateswiththelowestemd−performsthefirst(cheap)iterationsof the entire EMD calculation. Instead of using these methods, we\nSIAformanycandidatesandhelpsinderivingupperboundsemd+ proposeanefficientgreedyapproach,whichtakesadvantageofthe\nforthemandagoodestimateofθearly. Obtainingatightθearly EMD flow network topology; note that the EMD flow graph is a\ncompletebipartitegraphbetweenthebinsofqandp. Thismeans\ncan help (i) to prune more candidates using the filters (function\ngetnext filter)and(ii)toavoidthelateandexpensivepathaug- that a feasible vertex of q can always augment flow to any fea-\nmentationsofSIAformanycandidatesinPLthatcanbepruned. siblevertex ofpalongone edge. OurGreedyUBalgorithm (Al-\nThe choice of b (i.e., the size of PL) affects the performance gorithm4), foreachfeasiblevertexq i ofq, accessesthefeasible\nofDRO;ifbisverylarge,DROperformsmultipleconcurrentSIA verticesp j ofpinincreasingorderofc i,j andaugmentsthemax-\nexecutionswhichmayhavehighmemoryrequirements. Ifbistoo imum possible flow along each edge e(q i ,p j ), until the remain-\nsmall, the pruning threshold θ does not converge fast to its final ing capacity from q i has been used up. The accumulated cost of\nthe greedily augmented flows is used as the maxflow component\nvalue,andmoreobjectsentertherefinementphase. Clearly,there\nmaxflow(q,p)ofemd+(q,p).\nisatradeoffbetweentheperformancegainandmemoryconsump-\ntion. Inourexperiments,everySIAthreadonlyconstructsasmall\nportionoftheentireflowgraph.Thereby,bcanbesettoarelatively Algorithm4GREEDYUPPERBOUND\nlargenumber.Forinstance,whenbissetto0.2%ofthedatacardi- AlgorithmGreedyUB(Histogramsq,p)\nnality,thepeakmemoryconsumptionofDROonthelargestdataset 1: cost:=0\nofourexperimentalevaluation,WORLD,isjustaround20timesof\n2: while∃feasibleqido\nacompleteflowgraphinasingleEMDcomputation.Moreover,we 4 3 : : whi p le j c : a = pq f i ea > sib f le qi b d in o inphavingmini (cid:46) m q u i m ha c s i, r j emainingcapacity\nstudyamechanismtoavoidworstcases(e.g.,everypartialgraphin 5: flow:=min{capqi −fqi ,cappj −fpj }\nPLisfull).WhenthesizeofPLexceedsalimit,westopinserting 6: fqi :=fqi +flow\ncandidates into PL and refine the current EMD by PB until it is 7: fpi :=fpi +flow\nprunedorbecomesak-NNcandidate. However,inallofourex- 8: cost:=cost+ci,j·flow\nperimentaltestings,thismechanismisnevertriggeredasthesizeof 9: returncost\nPLismuchsmallerthanourdefaultmemorylimit(i.e.,512MB).\nTofacilitateGreedyUB,foreachrowiofthecostmatrixC,we\n4.5 RunningUpperBound defineanorderforthebinsjbasedonc (thisorderisstatic,i.e.,\ni,j\nWenowdiscussthedetailsofcomputingandmaintainingarun- independentofthedataandqueries,anditisdefinedonce,together\nningupperboundemd+foranobjectpwhoseEMDhaspartially withthegrounddistancefunctionorcostmatrix).Forexample,for\np\nbeencomputedbySIA. TheupperboundsareusedbyDRO(pre- rowq 1 ofthematrixshowninTable1,theorderis{p 1 ,p 3 ,p 4 ,p 2 }.\nsentedinSection4.4)toderiveavalueforθafterhavingpartially Then,inAlgorithm4line4,thisorderisconsideredforidentifying\ncomputedtheEMDofsomecandidateobjects. Accordingtothe feasiblebinsp j forthecurrentvertexq i . Thus,thecomplexityof\nEMDdefinition,anyflowmatrixFsatisfyingallthreeconditions thegreedyalgorithmisO(|E|),whereEindicatestheedgesinthe\nofEquation2mustleadtoanupperboundoftheactualEMD.For graph,sincethereareatmost|E|feasiblepairsintheEMDflow\ntheeaseofdiscussion,wecallaflowmatrixFpossibleifitsatisfies graph, i.e., much lower compared to the complexity of standard\nallthesethreeoptimizationconstraints;theconstraintsaresatisfied maximumflowalgorithms(e.g.,O(|V||E|)).\nif and only if there is no more feasible path in the flow network.\nSimilartoemd−,wecanupdateemd+incrementallyaftereach\nThus, finding a possible flow matrix F is equivalent to finding a pathaugmentationduringtherefinementofanEMD. Afterevery\nmaximumflowinthenetwork[1],disregardingedgecosts. augmentationofSIA,accordingtothecapacityfeasibility,wecan-\nBased on the above discussion, we can define a running upper celandre-augment(forthosethatbecomefeasibleafterthecance-\nboundemd+followingthesameideaofderivingemd−.Similarto lation)thecorrespondingflowsinthemaximumflowgraphformed\ntheillustrationinFigure8,emd+consistsofthecurrentcostplus by the greedy algorithm. The number of canceled/re-augmented\nanupperboundconsideringthenodeswhichstillhaveremaining edges in the maximum flow instance is at most equal to the flow\nflowcapacity(i.e.,theverticesinsidethedashed-lineregions).For unitsf justbeingaugmentedinthecurrentEMDflow. Thereby,\ninstance, a maximum flow of the vertices inside the dashed-line\nthemaintenancecostofemd+aftereachaugmentationisO(f).\nregion is (q ,p ,1), (q ,p ,1), and (q ,p ,1). The cost of this\n1 4 2 4 4 4\nmaxflowis0.7+0.9+0=1.6;thus,emd+is1.2(currentcost)+ 5. EXPERIMENTALEVALUATION\n1.6=2.8.Formally,wedefinetherunningupperboundasfollows. Inthissection,weconductextensiveexperimentstoevaluatethe\nperformanceofourproposedEMD-basedsimilaritysearchframe-\nDEFINITION4 (RUNNINGUPPERBOUND,emd+). work and compare it with state-of-the-art solutions. All methods\nConsider a flow graph, such that for each node p ∈ p, areimplementedinC++andevaluatedon3.40GHzquad-corema-\ni\nthere is a set of m augmented paths sp ,...,sp . The chinesrunningUbuntu12.04,with16GBytesofmainmemory.\ni qi,1 qi,mi\n320\nTable3:Thestatisticsofsixrealdatasets Table4:Comparisonofblack-boxEMDcomputationmethods\nName #Objs #Bins Description RETINA IRMA FLICKR PANO. FRIENDS WORLD\n96 Felineretinaimages.\nRETINA 3932\n(12×8) Defaultdatasetin[25,30,32].\nMedicalimagesfromIRMA7\nIRMA 10K 199 project.Usedin[25,30,32].\n100 ImagescrawledfromFlickr8.\nFLICKR 680K\n(10×10) Thisdatasetisusedin[25].\n576 ImagesofEuropeancitiesfrom\nPANORAMIO 500K\n(24×24) Panoramio9.\n768 Imagescapturedevery25frames\nFRIENDS 320K\n(24×32) fromtheTVseries“Friends”.\n1024\nWORLD 3M ImagesfromImageNet10project.\n(32×32)\nWe use six real datasets in our evaluation; their default statis-\nticsareshowninTable3. TheRETINA,IRMAandFLICKRhis-\ntogram sets are taken from [25]. The PANORAMIO, FRIENDS\nandWORLDhistogramsetsaregeneratedbythesamemethodwith\nRETINAandFLICKRassuggestedin[25]:eachimageisdivided\nintotilesbyagrid(e.g.,24×24squaregranularity); foreachtile,\nthe12-featureMPEG-7colorlayoutdescriptor(CLD)isextracted,\nandwepickonlythefirstfeatureasthevalueofthehistogrambin.\nSimilarto[25,30,32],weuseEuclideandistanceasthegrounddis-\ntance(costmatrix)inalltheexperiments.Notethatourtechniques\narenotrestrictedtoanyspecificgrounddistance.\nIntheevaluation,wecompareasetofEMDcomputationmeth-\nodswhenusedasablack-boxmoduleofthefilter-and-refinement\nframework (see Section 2.2). In all cases, the filtering of candi-\ndatesisdonebyapplyingthestate-of-the-artfilteringtechniquesas\nusedin[25].First,weusethenormaldistributionindex[25]toim-\nplementtheI.getnextfunction. Foreachretrievedcandidateby\nthisfunction,weapplythefollowingsetoffilters∆inthisorder:\nfullprojection[7],reduceddimension[30](onlyforRETINAand\nIRMA,onwhichthefilterhaspositiveeffectsasin[25]),andin-\ndependentminimization[5]. Forthecandidatesthatpassthefilter\nphase,wecomparetheapplicationofthefollowingEMDcompu-\ntationmethods:(i)capacityscaling(CAP),(ii)costscaling(COS),\n(iii)transportationsimplex(TRA),(iv)networksimplex(NET),(v)\nSSP(Section2.1), (vi)SIA(Section3). Inaddition, weevaluate\nour progressive bounding (PB) and dynamic refinement ordering\n(DRO)techniqueswhenappliedinconjunctionwithSIA. Ateach\nexperimentalinstance(e.g.,foragivendatasetandk),werun100\nk-NNquerieschoosingqrandomlyfromthecorrespondingdataset\nandaveragethequerycost. The100queriesforRETINA,IRMA\nandFLICKRdatasetarethesamequeriesusedin[25,30,32].The\ndefaultvalueofkis32andthedefaultb(i.e.,maximumsizeofPL\ninDRO)issetto0.2%ofthecorrespondingdatasetcardinality.\n5.1 PerformanceImprovement\nFirst,wecomparetheperformanceofdifferentblack-boxEMD\ncomputationmethodsinthefilter-and-refinementframework. Ta-\nble4showstheaveragequerytime ofthesixEMDcomputation\nmethodsfor32-NNsimilarityqueriesonthesixdatasets. SIAis\nthebestmethodwhichconstantlyoutperformsitsbasemethodSSP\nandotheralternatives(e.g.,TRA)byatleast2.4times.Inaddition,\nSIAscaleswellwiththeproblemdimensionality(i.e.,thenumber\nofhistogrambinsandthecardinalityofdatasets).Figure11shows\n7http://ganymed.imib.rwth-aachen.de/irma\n8http://www.flickr.com\n9http://www.panoramio.com\n10http://www.image-net.org\nemityreuQ\nCAP 0.68s 3.90s 7.89s 803s 3279s 22715s\nCOS 1.13s 6.48s 13.58s 1394s 5628s 48917s\nNET 0.52s 4.13s 7.04s 763s 3573s 22774s\nSSP 0.57s 6.14s 7.52s 2048s 10370s 65731s\nTRA 0.57s 8.30s 7.72s 3395s 15307s 137414s\nSIA 0.17s 1.51s 2.77s 318s 1362s 7082s\nFiltertime 0.006s 0.008s 0.749s 1.009s 1.476s 12.238s\ntheperformanceofthemethodsasafunctionofkonfivedatasets:\nRETINA,IRMA,PANORAMIO,FRIENDS,andWORLD.11SIA\noutperformsSSPbyaroundanorderofmagnitude,whilebeingat\nleasttwotimesfasterthantherunner-upnetworksimplex(NET).\nNotethattherelativeperformancedifferencebetweenmethodsis\nnotverysensitivetok.SIAisobviouslythebestmoduleforcalcu-\nlatingEMDunderthefilter-and-refinementframework. Notealso\nthat the time spent in the filter phase (in Table 4) is negligible,\nwhichconfirmsourdiscussionthattherefinementphasedominates\ntheruntimeoftheentirefilter-and-refinementframework.\nNext, we evaluate the improvement offered by our progressive\nboundinganddynamicrefinementorderingtechniques. Figure12\ncompares the runtime of k-NN queries when (i) using SIA as a\nblack-boxmodule,(ii)applyingprogressiveboundinginSIA(PB),\nand(iii)applyingdynamicrefinementorderinginconjunctionwith\nprogressive bounding in SIA (DRO). Observe that PB achieves a\nlargeperformanceimprovementoverSIA(i.e.,thebestblack-box\nmoduleinFigure11). Theimprovementgenerallybecomesmore\nvisible when the problem size increases (i.e., the number of bins\nand the cardinality of datasets). This can be explained by the\nfact that the size of the flow graph is quadratic to the number of\nhistogram bins, therefore the latter iterations of SIA become ex-\ntremely expensive. The progressive bounding technique helps to\navoidreachingtheseiterations,asexplainedinSection4.2. DRO\noffers a stable improvement over PB (40%–60%), indicating that\ntheconcurrentrefinementanddynamicreorderingtechniqueshave\npositiveimpactontheperformance.\nInsummary,DROistherecommendedmethodologyforEMD-\nbasedsimilarityqueries,beingseveraltimestotwoordersofmag-\nnitudefasterthanusingoff-the-shelfEMDcomputationmethods.\nNotably,allpreviousworks[5,25,30,32]adopttransportationsim-\nplex(TRA)forcalculatingEMDattherefinementphase.Asshown\ninourevaluation,thismethodonlyperformswellwhenthenumber\nofbinsisrelativelysmallduetoitsexponentialtimecomplexity.\nRoomforImprovement. Sofar,wehaveshownthesuperiority\nofourPBandDROtechniquesoverexistingapproaches. Tosee\nhowmuchroomforimprovementexistsforEMD-basedsimilarity\nqueries,wecomparePBandDROtotwoidealyetpracticallyin-\nfeasiblemethods,ESSandOI. Assumingthatweknowtheresult\nofak-NNquerybyanoracle,ESS(Essentialk-NNsearch)calcu-\nlatestheEMDsofonlytheexactk-NNs, representingthelowest\npossibleefforttocomputetheresultsofak-NNquery. OI(Oracle\nIndex) assumes that an oracle index is available which offers an\noptimalgetnextfunctionthatreturnstheobjectsintheascending\norder of their exact EMDs. OI can be viewed as an optimal or-\nderingmethodintegratedwiththecurrentstate-of-the-artfiltering\ntechniques. Inourexperiments,bothESSandOIcalculateEMDs\nbythebestblack-boxmodule(SIA),andOIusesourprogressive\nbounding(PB)techniquetoterminateEMDcalculationsearly.\nFigure13showsthequerytimeoffourmethods,PB,DRO,ESS,\nand OI, as a function of k. First, we observe that DRO’s perfor-\n11TheresultsonFLICKRaresimilartothoseofRETINA.\n321\n",
      "summary": "DRO efficiently refines the current best objects by using a greedy upper bound estimation based on maximum flow in a complete bipartite EMD graph, balancing pruning effectiveness and computational cost through dynamic threshold updates and concurrent refinement within a priority list of size b."
    },
    {
      "title": "5. EXPERIMENTAL EVALUATION",
      "start_index": 9,
      "end_index": 9,
      "nodes": [],
      "node_id": "0013",
      "text": "Table3:Thestatisticsofsixrealdatasets Table4:Comparisonofblack-boxEMDcomputationmethods\nName #Objs #Bins Description RETINA IRMA FLICKR PANO. FRIENDS WORLD\n96 Felineretinaimages.\nRETINA 3932\n(12×8) Defaultdatasetin[25,30,32].\nMedicalimagesfromIRMA7\nIRMA 10K 199 project.Usedin[25,30,32].\n100 ImagescrawledfromFlickr8.\nFLICKR 680K\n(10×10) Thisdatasetisusedin[25].\n576 ImagesofEuropeancitiesfrom\nPANORAMIO 500K\n(24×24) Panoramio9.\n768 Imagescapturedevery25frames\nFRIENDS 320K\n(24×32) fromtheTVseries“Friends”.\n1024\nWORLD 3M ImagesfromImageNet10project.\n(32×32)\nWe use six real datasets in our evaluation; their default statis-\nticsareshowninTable3. TheRETINA,IRMAandFLICKRhis-\ntogram sets are taken from [25]. The PANORAMIO, FRIENDS\nandWORLDhistogramsetsaregeneratedbythesamemethodwith\nRETINAandFLICKRassuggestedin[25]:eachimageisdivided\nintotilesbyagrid(e.g.,24×24squaregranularity); foreachtile,\nthe12-featureMPEG-7colorlayoutdescriptor(CLD)isextracted,\nandwepickonlythefirstfeatureasthevalueofthehistogrambin.\nSimilarto[25,30,32],weuseEuclideandistanceasthegrounddis-\ntance(costmatrix)inalltheexperiments.Notethatourtechniques\narenotrestrictedtoanyspecificgrounddistance.\nIntheevaluation,wecompareasetofEMDcomputationmeth-\nodswhenusedasablack-boxmoduleofthefilter-and-refinement\nframework (see Section 2.2). In all cases, the filtering of candi-\ndatesisdonebyapplyingthestate-of-the-artfilteringtechniquesas\nusedin[25].First,weusethenormaldistributionindex[25]toim-\nplementtheI.getnextfunction. Foreachretrievedcandidateby\nthisfunction,weapplythefollowingsetoffilters∆inthisorder:\nfullprojection[7],reduceddimension[30](onlyforRETINAand\nIRMA,onwhichthefilterhaspositiveeffectsasin[25]),andin-\ndependentminimization[5]. Forthecandidatesthatpassthefilter\nphase,wecomparetheapplicationofthefollowingEMDcompu-\ntationmethods:(i)capacityscaling(CAP),(ii)costscaling(COS),\n(iii)transportationsimplex(TRA),(iv)networksimplex(NET),(v)\nSSP(Section2.1), (vi)SIA(Section3). Inaddition, weevaluate\nour progressive bounding (PB) and dynamic refinement ordering\n(DRO)techniqueswhenappliedinconjunctionwithSIA. Ateach\nexperimentalinstance(e.g.,foragivendatasetandk),werun100\nk-NNquerieschoosingqrandomlyfromthecorrespondingdataset\nandaveragethequerycost. The100queriesforRETINA,IRMA\nandFLICKRdatasetarethesamequeriesusedin[25,30,32].The\ndefaultvalueofkis32andthedefaultb(i.e.,maximumsizeofPL\ninDRO)issetto0.2%ofthecorrespondingdatasetcardinality.\n5.1 PerformanceImprovement\nFirst,wecomparetheperformanceofdifferentblack-boxEMD\ncomputationmethodsinthefilter-and-refinementframework. Ta-\nble4showstheaveragequerytime ofthesixEMDcomputation\nmethodsfor32-NNsimilarityqueriesonthesixdatasets. SIAis\nthebestmethodwhichconstantlyoutperformsitsbasemethodSSP\nandotheralternatives(e.g.,TRA)byatleast2.4times.Inaddition,\nSIAscaleswellwiththeproblemdimensionality(i.e.,thenumber\nofhistogrambinsandthecardinalityofdatasets).Figure11shows\n7http://ganymed.imib.rwth-aachen.de/irma\n8http://www.flickr.com\n9http://www.panoramio.com\n10http://www.image-net.org\nemityreuQ\nCAP 0.68s 3.90s 7.89s 803s 3279s 22715s\nCOS 1.13s 6.48s 13.58s 1394s 5628s 48917s\nNET 0.52s 4.13s 7.04s 763s 3573s 22774s\nSSP 0.57s 6.14s 7.52s 2048s 10370s 65731s\nTRA 0.57s 8.30s 7.72s 3395s 15307s 137414s\nSIA 0.17s 1.51s 2.77s 318s 1362s 7082s\nFiltertime 0.006s 0.008s 0.749s 1.009s 1.476s 12.238s\ntheperformanceofthemethodsasafunctionofkonfivedatasets:\nRETINA,IRMA,PANORAMIO,FRIENDS,andWORLD.11SIA\noutperformsSSPbyaroundanorderofmagnitude,whilebeingat\nleasttwotimesfasterthantherunner-upnetworksimplex(NET).\nNotethattherelativeperformancedifferencebetweenmethodsis\nnotverysensitivetok.SIAisobviouslythebestmoduleforcalcu-\nlatingEMDunderthefilter-and-refinementframework. Notealso\nthat the time spent in the filter phase (in Table 4) is negligible,\nwhichconfirmsourdiscussionthattherefinementphasedominates\ntheruntimeoftheentirefilter-and-refinementframework.\nNext, we evaluate the improvement offered by our progressive\nboundinganddynamicrefinementorderingtechniques. Figure12\ncompares the runtime of k-NN queries when (i) using SIA as a\nblack-boxmodule,(ii)applyingprogressiveboundinginSIA(PB),\nand(iii)applyingdynamicrefinementorderinginconjunctionwith\nprogressive bounding in SIA (DRO). Observe that PB achieves a\nlargeperformanceimprovementoverSIA(i.e.,thebestblack-box\nmoduleinFigure11). Theimprovementgenerallybecomesmore\nvisible when the problem size increases (i.e., the number of bins\nand the cardinality of datasets). This can be explained by the\nfact that the size of the flow graph is quadratic to the number of\nhistogram bins, therefore the latter iterations of SIA become ex-\ntremely expensive. The progressive bounding technique helps to\navoidreachingtheseiterations,asexplainedinSection4.2. DRO\noffers a stable improvement over PB (40%–60%), indicating that\ntheconcurrentrefinementanddynamicreorderingtechniqueshave\npositiveimpactontheperformance.\nInsummary,DROistherecommendedmethodologyforEMD-\nbasedsimilarityqueries,beingseveraltimestotwoordersofmag-\nnitudefasterthanusingoff-the-shelfEMDcomputationmethods.\nNotably,allpreviousworks[5,25,30,32]adopttransportationsim-\nplex(TRA)forcalculatingEMDattherefinementphase.Asshown\ninourevaluation,thismethodonlyperformswellwhenthenumber\nofbinsisrelativelysmallduetoitsexponentialtimecomplexity.\nRoomforImprovement. Sofar,wehaveshownthesuperiority\nofourPBandDROtechniquesoverexistingapproaches. Tosee\nhowmuchroomforimprovementexistsforEMD-basedsimilarity\nqueries,wecomparePBandDROtotwoidealyetpracticallyin-\nfeasiblemethods,ESSandOI. Assumingthatweknowtheresult\nofak-NNquerybyanoracle,ESS(Essentialk-NNsearch)calcu-\nlatestheEMDsofonlytheexactk-NNs, representingthelowest\npossibleefforttocomputetheresultsofak-NNquery. OI(Oracle\nIndex) assumes that an oracle index is available which offers an\noptimalgetnextfunctionthatreturnstheobjectsintheascending\norder of their exact EMDs. OI can be viewed as an optimal or-\nderingmethodintegratedwiththecurrentstate-of-the-artfiltering\ntechniques. Inourexperiments,bothESSandOIcalculateEMDs\nbythebestblack-boxmodule(SIA),andOIusesourprogressive\nbounding(PB)techniquetoterminateEMDcalculationsearly.\nFigure13showsthequerytimeoffourmethods,PB,DRO,ESS,\nand OI, as a function of k. First, we observe that DRO’s perfor-\n11TheresultsonFLICKRaresimilartothoseofRETINA.\n321\n",
      "summary": "The study evaluates six real datasets and compares black-box EMD computation methods within a filter-and-refinement framework, using state-of-the-art filtering techniques and measuring performance through 100 k-NN queries per dataset with default k=32 and b set to 0.2% of dataset size."
    },
    {
      "title": "5.1 Performance Improvement",
      "start_index": 9,
      "end_index": 10,
      "nodes": [],
      "node_id": "0014",
      "text": "Table3:Thestatisticsofsixrealdatasets Table4:Comparisonofblack-boxEMDcomputationmethods\nName #Objs #Bins Description RETINA IRMA FLICKR PANO. FRIENDS WORLD\n96 Felineretinaimages.\nRETINA 3932\n(12×8) Defaultdatasetin[25,30,32].\nMedicalimagesfromIRMA7\nIRMA 10K 199 project.Usedin[25,30,32].\n100 ImagescrawledfromFlickr8.\nFLICKR 680K\n(10×10) Thisdatasetisusedin[25].\n576 ImagesofEuropeancitiesfrom\nPANORAMIO 500K\n(24×24) Panoramio9.\n768 Imagescapturedevery25frames\nFRIENDS 320K\n(24×32) fromtheTVseries“Friends”.\n1024\nWORLD 3M ImagesfromImageNet10project.\n(32×32)\nWe use six real datasets in our evaluation; their default statis-\nticsareshowninTable3. TheRETINA,IRMAandFLICKRhis-\ntogram sets are taken from [25]. The PANORAMIO, FRIENDS\nandWORLDhistogramsetsaregeneratedbythesamemethodwith\nRETINAandFLICKRassuggestedin[25]:eachimageisdivided\nintotilesbyagrid(e.g.,24×24squaregranularity); foreachtile,\nthe12-featureMPEG-7colorlayoutdescriptor(CLD)isextracted,\nandwepickonlythefirstfeatureasthevalueofthehistogrambin.\nSimilarto[25,30,32],weuseEuclideandistanceasthegrounddis-\ntance(costmatrix)inalltheexperiments.Notethatourtechniques\narenotrestrictedtoanyspecificgrounddistance.\nIntheevaluation,wecompareasetofEMDcomputationmeth-\nodswhenusedasablack-boxmoduleofthefilter-and-refinement\nframework (see Section 2.2). In all cases, the filtering of candi-\ndatesisdonebyapplyingthestate-of-the-artfilteringtechniquesas\nusedin[25].First,weusethenormaldistributionindex[25]toim-\nplementtheI.getnextfunction. Foreachretrievedcandidateby\nthisfunction,weapplythefollowingsetoffilters∆inthisorder:\nfullprojection[7],reduceddimension[30](onlyforRETINAand\nIRMA,onwhichthefilterhaspositiveeffectsasin[25]),andin-\ndependentminimization[5]. Forthecandidatesthatpassthefilter\nphase,wecomparetheapplicationofthefollowingEMDcompu-\ntationmethods:(i)capacityscaling(CAP),(ii)costscaling(COS),\n(iii)transportationsimplex(TRA),(iv)networksimplex(NET),(v)\nSSP(Section2.1), (vi)SIA(Section3). Inaddition, weevaluate\nour progressive bounding (PB) and dynamic refinement ordering\n(DRO)techniqueswhenappliedinconjunctionwithSIA. Ateach\nexperimentalinstance(e.g.,foragivendatasetandk),werun100\nk-NNquerieschoosingqrandomlyfromthecorrespondingdataset\nandaveragethequerycost. The100queriesforRETINA,IRMA\nandFLICKRdatasetarethesamequeriesusedin[25,30,32].The\ndefaultvalueofkis32andthedefaultb(i.e.,maximumsizeofPL\ninDRO)issetto0.2%ofthecorrespondingdatasetcardinality.\n5.1 PerformanceImprovement\nFirst,wecomparetheperformanceofdifferentblack-boxEMD\ncomputationmethodsinthefilter-and-refinementframework. Ta-\nble4showstheaveragequerytime ofthesixEMDcomputation\nmethodsfor32-NNsimilarityqueriesonthesixdatasets. SIAis\nthebestmethodwhichconstantlyoutperformsitsbasemethodSSP\nandotheralternatives(e.g.,TRA)byatleast2.4times.Inaddition,\nSIAscaleswellwiththeproblemdimensionality(i.e.,thenumber\nofhistogrambinsandthecardinalityofdatasets).Figure11shows\n7http://ganymed.imib.rwth-aachen.de/irma\n8http://www.flickr.com\n9http://www.panoramio.com\n10http://www.image-net.org\nemityreuQ\nCAP 0.68s 3.90s 7.89s 803s 3279s 22715s\nCOS 1.13s 6.48s 13.58s 1394s 5628s 48917s\nNET 0.52s 4.13s 7.04s 763s 3573s 22774s\nSSP 0.57s 6.14s 7.52s 2048s 10370s 65731s\nTRA 0.57s 8.30s 7.72s 3395s 15307s 137414s\nSIA 0.17s 1.51s 2.77s 318s 1362s 7082s\nFiltertime 0.006s 0.008s 0.749s 1.009s 1.476s 12.238s\ntheperformanceofthemethodsasafunctionofkonfivedatasets:\nRETINA,IRMA,PANORAMIO,FRIENDS,andWORLD.11SIA\noutperformsSSPbyaroundanorderofmagnitude,whilebeingat\nleasttwotimesfasterthantherunner-upnetworksimplex(NET).\nNotethattherelativeperformancedifferencebetweenmethodsis\nnotverysensitivetok.SIAisobviouslythebestmoduleforcalcu-\nlatingEMDunderthefilter-and-refinementframework. Notealso\nthat the time spent in the filter phase (in Table 4) is negligible,\nwhichconfirmsourdiscussionthattherefinementphasedominates\ntheruntimeoftheentirefilter-and-refinementframework.\nNext, we evaluate the improvement offered by our progressive\nboundinganddynamicrefinementorderingtechniques. Figure12\ncompares the runtime of k-NN queries when (i) using SIA as a\nblack-boxmodule,(ii)applyingprogressiveboundinginSIA(PB),\nand(iii)applyingdynamicrefinementorderinginconjunctionwith\nprogressive bounding in SIA (DRO). Observe that PB achieves a\nlargeperformanceimprovementoverSIA(i.e.,thebestblack-box\nmoduleinFigure11). Theimprovementgenerallybecomesmore\nvisible when the problem size increases (i.e., the number of bins\nand the cardinality of datasets). This can be explained by the\nfact that the size of the flow graph is quadratic to the number of\nhistogram bins, therefore the latter iterations of SIA become ex-\ntremely expensive. The progressive bounding technique helps to\navoidreachingtheseiterations,asexplainedinSection4.2. DRO\noffers a stable improvement over PB (40%–60%), indicating that\ntheconcurrentrefinementanddynamicreorderingtechniqueshave\npositiveimpactontheperformance.\nInsummary,DROistherecommendedmethodologyforEMD-\nbasedsimilarityqueries,beingseveraltimestotwoordersofmag-\nnitudefasterthanusingoff-the-shelfEMDcomputationmethods.\nNotably,allpreviousworks[5,25,30,32]adopttransportationsim-\nplex(TRA)forcalculatingEMDattherefinementphase.Asshown\ninourevaluation,thismethodonlyperformswellwhenthenumber\nofbinsisrelativelysmallduetoitsexponentialtimecomplexity.\nRoomforImprovement. Sofar,wehaveshownthesuperiority\nofourPBandDROtechniquesoverexistingapproaches. Tosee\nhowmuchroomforimprovementexistsforEMD-basedsimilarity\nqueries,wecomparePBandDROtotwoidealyetpracticallyin-\nfeasiblemethods,ESSandOI. Assumingthatweknowtheresult\nofak-NNquerybyanoracle,ESS(Essentialk-NNsearch)calcu-\nlatestheEMDsofonlytheexactk-NNs, representingthelowest\npossibleefforttocomputetheresultsofak-NNquery. OI(Oracle\nIndex) assumes that an oracle index is available which offers an\noptimalgetnextfunctionthatreturnstheobjectsintheascending\norder of their exact EMDs. OI can be viewed as an optimal or-\nderingmethodintegratedwiththecurrentstate-of-the-artfiltering\ntechniques. Inourexperiments,bothESSandOIcalculateEMDs\nbythebestblack-boxmodule(SIA),andOIusesourprogressive\nbounding(PB)techniquetoterminateEMDcalculationsearly.\nFigure13showsthequerytimeoffourmethods,PB,DRO,ESS,\nand OI, as a function of k. First, we observe that DRO’s perfor-\n11TheresultsonFLICKRaresimilartothoseofRETINA.\n321\n2.0\n1.5\n1.0\n0.5\n0.0\n48 16 32 64\nk\n)s(\nemit\nyreuQ\nCAP SSP 15\nCOS TRA NET SIA\n10\n5\n0\n48 16 32 64\nk\n(a) RETINA\n)s(\nemit\nyreuQ\nCAP SSP 5\nCOS TRA NET SIA 4\n3\n2\n1\n0\n48 16 32 64\nk\n(b) IRMA\n)s301x(\nemit\nyreuQ\nCAP SSP 20\nCOS TRA NET SIA 15\n10\n5\n0\n48 16 32 64\nk\n(c) PANORAMIO\n)s301x(\nemit\nyreuQ\nCAP SSP 20\nCOS TRA NET SIA 16\n12\n8\n4\n0\n48 16 32 64\nk\n(d) FRIENDS\n)s401x(\nemit\nyreuQ\nCAP SSP\nCOS TRA NET SIA\n(e) WORLD\nFigure11:Performanceofblack-boxEMDcomputationmethodsvaryingonk\n0.3\n0.2 0.1\n0.0 48 16 32 64\nk\n)s(\nemit yreuQ\nSIA 3\nPB DRO\n2 1\n0 48 16 32 64\nk\n(a) RETINA\n)s(\nemit yreuQ\n0.5 SIA\nPB DRO 0.4\n0.3 0.2\n0.1\n0.0 48 16 32 64\nk\n(b) IRMA\n)s301x(\nemit yreuQ\nSIA 2.0\nPB DRO 1.5\n60 40 1.0 20\n04 32 64 0.5\n0.0 48 16 32 64\nk\n(c) PANORAMIO\n)s301x(\nemit yreuQ\nSIA 10.0\nPB DRO 8.0\n150 6.0 100 4.0 50\n04 32 64 2.0\n0.0 48 16 32 64\nk\n(d) FRIENDS\n)s301x(\nemit yreuQ\nSIA\nPB DRO\n600 400 200\n04 32 64\n(e) WORLD\nFigure12:PerformanceofSIA,PBandDROvaryingonk\n0.25\n0.20\n0.15\n0.10\n0.05\n0.00\n48 16 32 64\nk\n)s(\nemit\nyreuQ\nPB 1.5\nDRO\nOI ESS\n1.0\n0.5\n0.0\n48 16 32 64\nk\n(a) RETINA\n)s(\nemit\nyreuQ\nPB 80\nDRO\nO ES I S 60\n40\n20\n0\n48 16 32 64\nk\n(b) IRMA\n)s(\nemit\nyreuQ\nPB 200\nDRO\nO ES I S 150\n100\n50\n0\n48 16 32 64\nk\n(c) PANORAMIO\n)s(\nemit\nyreuQ\nPB 750\nDRO\nOI 600 ESS\n450\n300\n150\n0\n48 16 32 64\nk\n(d) FRIENDS\n)s(\nemit\nyreuQ\nPB\nDRO\nOI ESS\n(e) WORLD\nFigure13:ClosenessofPBandDROtotheoraclemethods(querytime)\n300\n200\n100\n0\n4 8 16 32 64\nk\nstnemenifer\nfo #\nPB 400\nDRO\nO ES I S 300 PB-C DRO-C\n200\n100\n0\n4 8 16 32 64\nk\n(a) RETINA\nstnemenifer\nfo #\nPB 3.0\nDRO\nOI E PB SS -C 2.0 DRO-C\n1.0\n0\n4 8 16 32 64\nk\n(b) IRMA\n)301x(\nstnemenifer\nfo\n#\nPB 7.5\nDRO\nOI 6.0 ESS P D B R - O C -C 4.5\n3.0\n1.5\n0\n4 8 16 32 64\nk\n(c) PANORAMIO\n)301x(\nstnemenifer\nfo\n#\nPB 12.0\nDRO\nO ES I S 9.0 PB-C DRO-C\n6.0\n3.0\n0\n4 8 16 32 64\nk\n(d) FRIENDS\n)301x(\nstnemenifer\nfo\n#\nPB\nDRO\nOI ESS PB-C DRO-C\n(e) WORLD\nFigure14:ClosenessofPBandDROtotheoraclemethods(numberofrefinements)\nmance is very close to that of OI, improving PB by a significant 5.2 ScalabilityExperiments\nextenttowardsanidealmethod. Figure14illustratesthenumber In the first scalability study, we conduct experiments on\nofEMDrefinements12ofthesefourmethods,andalsothenumber\nPANORAMIO subsets with cardinality 100K to 500K, on\nofcompleterefinements(i.e., theEMDcalculationsthatarefully FRIENDSsubsets(64Kto320K),andonWORLDsubsets(0.6M\nconducted)ofPBandDRO(denotedbyPB-CandDRO-Crespec- to 3M), by randomly picking objects from the corresponding\ntively),varyingonk.Theseexperimentsconfirmtherobustnessof datasets.ThelinesinFigure15showthequerytimeofthreemeth-\nourdynamicreorderingtechniqueasDROcommencesalmostthe ods,SIA,PB,andDRO,asafunctionoftheobjectcardinality,af-\nsamenumberofEMDscomparedtotheoptimalmethodOI. Be- tersettingk =32. PBandDROscaleverywellwiththedatabase\nsides,inFigure14,PB-CandDRO-CareveryclosetoESS(i.e., size (they are almost insensitive), since the progressive bounding\nk).Inspecific,DRO-Cisonlyslightlylargerthank,indicatingthat techniquebenefitsfrombetterpruningthresholdsowingtothein-\nonlyveryfewobjectsthatarenottheactualk-NNresultsneedto creasingnumberofobjects.Thisexperimentexposesanimportant\nbefullyrefinedbyDRO,whichagainverifiestheeffectivenessof advantageofourapproach: itsperformanceislesssensitivetothe\nDRO.Obviously,thereislimitedroomforimprovingDRO,using databasesize,whilekisthemaincostfactor. Notethatwhilethe\nthecurrentstate-of-the-artfilteringtechniques,asitsperformance databasesizemayincreasearbitrarily,inpracticekisnotexpected\nisalreadyclosetothatofOI. Ontheotherhand, webelievethat togrowatthesamerate, sincesimilaritysearchqueriestypically\nthereisstillroomforimprovinguponthecurrentfilteringmethods retrievealimitednumberofobjects. ThebarsinFigure15show\nastheperformancegapbetweenOIandESSisstillsignificant. thenumberofrefinementsofSIA,PB,andDRO(notethatinPB\n12Anobjectiscountedevenwhenonlyonepathisaugmented.\nandDRO,onlyaportionofthesearecompleterefinements,denoted\n322\n",
      "summary": "The study evaluates six real datasets and compares various black-box EMD computation methods within a filter-and-refinement framework, measuring performance through 100 k-NN queries per dataset using default parameters and state-of-the-art filtering techniques."
    },
    {
      "title": "5.2 Scalability Experiments",
      "start_index": 10,
      "end_index": 11,
      "nodes": [],
      "node_id": "0015",
      "text": "2.0\n1.5\n1.0\n0.5\n0.0\n48 16 32 64\nk\n)s(\nemit\nyreuQ\nCAP SSP 15\nCOS TRA NET SIA\n10\n5\n0\n48 16 32 64\nk\n(a) RETINA\n)s(\nemit\nyreuQ\nCAP SSP 5\nCOS TRA NET SIA 4\n3\n2\n1\n0\n48 16 32 64\nk\n(b) IRMA\n)s301x(\nemit\nyreuQ\nCAP SSP 20\nCOS TRA NET SIA 15\n10\n5\n0\n48 16 32 64\nk\n(c) PANORAMIO\n)s301x(\nemit\nyreuQ\nCAP SSP 20\nCOS TRA NET SIA 16\n12\n8\n4\n0\n48 16 32 64\nk\n(d) FRIENDS\n)s401x(\nemit\nyreuQ\nCAP SSP\nCOS TRA NET SIA\n(e) WORLD\nFigure11:Performanceofblack-boxEMDcomputationmethodsvaryingonk\n0.3\n0.2 0.1\n0.0 48 16 32 64\nk\n)s(\nemit yreuQ\nSIA 3\nPB DRO\n2 1\n0 48 16 32 64\nk\n(a) RETINA\n)s(\nemit yreuQ\n0.5 SIA\nPB DRO 0.4\n0.3 0.2\n0.1\n0.0 48 16 32 64\nk\n(b) IRMA\n)s301x(\nemit yreuQ\nSIA 2.0\nPB DRO 1.5\n60 40 1.0 20\n04 32 64 0.5\n0.0 48 16 32 64\nk\n(c) PANORAMIO\n)s301x(\nemit yreuQ\nSIA 10.0\nPB DRO 8.0\n150 6.0 100 4.0 50\n04 32 64 2.0\n0.0 48 16 32 64\nk\n(d) FRIENDS\n)s301x(\nemit yreuQ\nSIA\nPB DRO\n600 400 200\n04 32 64\n(e) WORLD\nFigure12:PerformanceofSIA,PBandDROvaryingonk\n0.25\n0.20\n0.15\n0.10\n0.05\n0.00\n48 16 32 64\nk\n)s(\nemit\nyreuQ\nPB 1.5\nDRO\nOI ESS\n1.0\n0.5\n0.0\n48 16 32 64\nk\n(a) RETINA\n)s(\nemit\nyreuQ\nPB 80\nDRO\nO ES I S 60\n40\n20\n0\n48 16 32 64\nk\n(b) IRMA\n)s(\nemit\nyreuQ\nPB 200\nDRO\nO ES I S 150\n100\n50\n0\n48 16 32 64\nk\n(c) PANORAMIO\n)s(\nemit\nyreuQ\nPB 750\nDRO\nOI 600 ESS\n450\n300\n150\n0\n48 16 32 64\nk\n(d) FRIENDS\n)s(\nemit\nyreuQ\nPB\nDRO\nOI ESS\n(e) WORLD\nFigure13:ClosenessofPBandDROtotheoraclemethods(querytime)\n300\n200\n100\n0\n4 8 16 32 64\nk\nstnemenifer\nfo #\nPB 400\nDRO\nO ES I S 300 PB-C DRO-C\n200\n100\n0\n4 8 16 32 64\nk\n(a) RETINA\nstnemenifer\nfo #\nPB 3.0\nDRO\nOI E PB SS -C 2.0 DRO-C\n1.0\n0\n4 8 16 32 64\nk\n(b) IRMA\n)301x(\nstnemenifer\nfo\n#\nPB 7.5\nDRO\nOI 6.0 ESS P D B R - O C -C 4.5\n3.0\n1.5\n0\n4 8 16 32 64\nk\n(c) PANORAMIO\n)301x(\nstnemenifer\nfo\n#\nPB 12.0\nDRO\nO ES I S 9.0 PB-C DRO-C\n6.0\n3.0\n0\n4 8 16 32 64\nk\n(d) FRIENDS\n)301x(\nstnemenifer\nfo\n#\nPB\nDRO\nOI ESS PB-C DRO-C\n(e) WORLD\nFigure14:ClosenessofPBandDROtotheoraclemethods(numberofrefinements)\nmance is very close to that of OI, improving PB by a significant 5.2 ScalabilityExperiments\nextenttowardsanidealmethod. Figure14illustratesthenumber In the first scalability study, we conduct experiments on\nofEMDrefinements12ofthesefourmethods,andalsothenumber\nPANORAMIO subsets with cardinality 100K to 500K, on\nofcompleterefinements(i.e., theEMDcalculationsthatarefully FRIENDSsubsets(64Kto320K),andonWORLDsubsets(0.6M\nconducted)ofPBandDRO(denotedbyPB-CandDRO-Crespec- to 3M), by randomly picking objects from the corresponding\ntively),varyingonk.Theseexperimentsconfirmtherobustnessof datasets.ThelinesinFigure15showthequerytimeofthreemeth-\nourdynamicreorderingtechniqueasDROcommencesalmostthe ods,SIA,PB,andDRO,asafunctionoftheobjectcardinality,af-\nsamenumberofEMDscomparedtotheoptimalmethodOI. Be- tersettingk =32. PBandDROscaleverywellwiththedatabase\nsides,inFigure14,PB-CandDRO-CareveryclosetoESS(i.e., size (they are almost insensitive), since the progressive bounding\nk).Inspecific,DRO-Cisonlyslightlylargerthank,indicatingthat techniquebenefitsfrombetterpruningthresholdsowingtothein-\nonlyveryfewobjectsthatarenottheactualk-NNresultsneedto creasingnumberofobjects.Thisexperimentexposesanimportant\nbefullyrefinedbyDRO,whichagainverifiestheeffectivenessof advantageofourapproach: itsperformanceislesssensitivetothe\nDRO.Obviously,thereislimitedroomforimprovingDRO,using databasesize,whilekisthemaincostfactor. Notethatwhilethe\nthecurrentstate-of-the-artfilteringtechniques,asitsperformance databasesizemayincreasearbitrarily,inpracticekisnotexpected\nisalreadyclosetothatofOI. Ontheotherhand, webelievethat togrowatthesamerate, sincesimilaritysearchqueriestypically\nthereisstillroomforimprovinguponthecurrentfilteringmethods retrievealimitednumberofobjects. ThebarsinFigure15show\nastheperformancegapbetweenOIandESSisstillsignificant. thenumberofrefinementsofSIA,PB,andDRO(notethatinPB\n12Anobjectiscountedevenwhenonlyonepathisaugmented.\nandDRO,onlyaportionofthesearecompleterefinements,denoted\n322\n2 1\n0 100K 200K 300K 400K 500K Dataset size\n)301x( stnemenifer\nfo\n#\n0.4 0.3 0.2\n0.1\n0.0\n)s301x( emit\nyreuQ\nSIA SIA PB-C PB PB DRO-C DRO DRO 4\n2\n0 64K 128K192K256K320K Dataset size\n(a) PANORAMIO\n)301x( stnemenifer\nfo\n#\n1.5 1.0\n0.5\n0.0\n)s301x( emit\nyreuQ\nS PB IA S PB IA P D B R - O C -C 9 DRO DRO 6\n3\n0 0.6M 1.2M 1.8M 2.4M 3.0M Dataset size\n(b) FRIENDS\n)301x( stnemenifeR\nfo\n#\n8.0 6.0 4.0\n2.0\n0\n)s301x( emit\nyreuQ\nSIA SIA PB-C 2.0 PB PB DRO-C DRO DRO 1.5 1.0\n0.5\n0 256 400 576 784 1024 Number of bins\n(c) WORLD\nFigure15:Scalabilitytodatasetcardinality(numberofobjects)\n)s301x( emit\nyreuQ\nSIA 8 PB DRO 6 4\n2\n0 5767841024 1600 2304 Number of bins\n(a) PANORAMIO\n)s401x( emit\nyreuQ\nSIA PB DRO\n(b) WORLD\nFigure16:Scalabilitytohistogramdimensionality\nbyPB-CandDRO-C).WeobservethatSIAisquitesensitivetothe\nnumber of refinements while PB and DRO are likely sensitive to\nthenumberofthecompleterefinements(PB-CandDRO-C).Inad-\ndition,theimprovementofDROoverPBisstable,indicatingthat\nthereorderingtechniqueisnotaffectedbytheincreasingnumber\nofobjectsthatsurvivethefilters.\nInthesecondscalabilitystudy,weevaluatetheeffectivenessof\nourtechniquesagainstthehistogramdimensionality(i.e.,number\nof bins). We generate histogram sets of different dimensionali-\nties(squaregridgranularities)upto2304, onPANORAMIOand\nWORLD. Figure 16 shows the query time as a function of the\nhistogram dimensionality on the two datasets (k = 32). We ob-\nserve that the query time of PB and DRO increases more slowly\ncomparedtothatofSIA. Thegracefulscalabilityofourmethods\nw.r.t. histogram dimensionality enables the application of EMD-\nbasedsimilaritysearchonhigh-dimensionalhistogramrepresenta-\ntions(e.g.,multi-dimensionalfeatureswithfinepartitioning).\n5.3 ParameterTuninginDRO\nFinally,wedemonstratetheeffectoftwosensitiveparametersin\nDRO,i.e.,themaximumnumberofconcurrentlyrefinedobjectsb\n(thesizeofPL),andthefunctiontoprioritizeobjectsinDRO.\n60\n40\n20\n0\n48 16 32 64\nk\n)s( emit\nyreuQ\n0.05% 80\n0.1%\n0 0 . . 2 4 % % 60\n40\n20\n0\n48 16 32 64\nk\n(a) SizeofPL,b\n)s( emit\nyreuQ\ncost, where α indicates the tightness of the running bounds (i.e.,\nemd+−emd− ).AsFigure17(b)shows,thisfunction,whenusedin\nemd+\nDRO,maintainsaconstantadvantageoverPB,comparedtoprior-\nitizingbyjustusingemd−oremd+.\n6. RELATEDWORK\nEarthMover’sDistance(EMD)wasfirstintroducedbythecom-\nputervisioncommunityasaneffectivesimilaritymetric[23].EMD\nisalsoknownasMallowsdistanceorWassersteindistanceinstatis-\ntics[15]. Asacross-bindistance,EMDmatchesbetterthehuman\nperception of differences [22], compared to bin-by-bin distances\nlikeEuclideandistanceorχ2-statistic.EMDsupportsanalysisand\nsearchinawiderangeofapplicationdomains, suchasimagere-\ntrieval[23,24],computervision[11,17,21],machinelearning[6,9],\nprobabilistic[25,32]andmultimediadatabases[5,30],videoand\nmusic identification [28,31], phishing detection [10], data clean-\ning [8], privacy [16], matrix factorization [26], clustering [4,6],\nclassification[14],etc.Anempiricalstudy[20]thatcomparesnine\nfamiliesofimagedissimilaritymeasuresbasedondistributionsof\ncolor and texture features shows that EMD has the best overall\nqualityamongtheothers,yetalsothehighestcomputationalcost.\nDue to the usefulness of EMD, the database community de-\nPB veloped techniques for similarity queries based on this measure.\ne\ne\nm\nm\nd\nd\n−+\nWorkinthisdirectionisbasedonthefilter-and-refinementframe- DRO work[5,25,30,32],describedinSection2.2.Themainfocusisthe\ndevelopment of fast and effective lower bounds for EMD, which\nhelp in pruning objects that cannot make it in the result, at the\nfilter phase. Assent et al. [5] were the first to study EMD in the\nfilter-and-refinementframework. Wichterichetal.[30]proposea\n(b) Prioritizingfunction dimensionalityreductiontechnique,showingthattheEMDoftwo\nobjectsinthederivedspaceisalowerboundfortheiractualEMD.\nFigure17:PerformancetuningofDROonPANORAMIO Xuetal.[32]proposealowerboundofEMDbasedonprimal-dual\ntechniques[1]fromlinearprogramminganduseB+-treeindexing\nFigure17(a)showstheaveragequerytimeofk-NNquerieson tosupportthefilterphaseofk-NNandrangequeries. Ruttenberg\nthe PANORAMIO dataset, for different values of b (as different andSingh[25]developanewindexstructureforEMD-basedsimi-\nseries). DRO becomes faster when b increases, which indicates larityqueriesbasedontheprojectionlowerboundin[7].Allthese\nthatconcurrentrefinementisaneffectivestrategytoevaluateEMD- solutionsfocusonlyontheeffectivenessoffiltersandefficiencyof\nbasedk-NNqueries.Ontheotherhand,asdiscussedinSection4.4, thefilterphase,simplytreatingtherefinementphaseasablack-box\nthememoryrequirementsofDROareproportionaltob,sotheper- process. However,aswehaveshowninthispaper,therefinement\nformanceimprovementcomeswithamemorytradeoff. costdominatestheoverallcostanddeservesmoreattention.\nAs mentioned in Section 4.4, the running lower bound emd− Besidestheseresultsbythedatabasecommunity,therearealso\ncan be used to prioritize objects in DRO. However, as shown in studiesonefficientEMDapproximations[2,3,13,19,27]. Andoni\nFigure17(b),emd−isnotaneffectiveprioritizingfunctionsinceit etal.[3]studyEMDapproximationsinhigh-dimensionalspaces.\ndoesnottaketheboundtightnessintoconsideration. Forinstance, PeleandWerman[19]acceleratestheEMDcomputationbylimit-\nassume that both emd− pa and emd− pb have the same value. Intu- ingthenumberofedgesintheflowgraph, withoutguaranteesof\nitively, if emd+ < emd+ , p should be given higher priority thequalityofapproximation. Both[13]and[27]studylinear-time\npa pb a\nthanp duringtherefinement,becausep hasatighterboundand approximations of EMD, and [2] proposes sketches for approxi-\nb a\nitismorelikelytobeaddedtothecurrentk-NNsetHanddecrease matingplanarEMD.However,theseworksassumeeitherspecific\nθ. Thus, DRO (in Figure 17(b) and the previous experiments) ground distances (e.g., L norm) [2,3,27] and bin spaces (e.g.,\n1\nuses the following prioritizing function, which is a slight modifi- R2)[2,3,13,27],orcertainhistogramtypes(e.g.,dominantcolor\ncationofemd−(Definition3):(1−α)·currentcost+α·estimated descriptor)[13],whichdonotapplytothegeneralsetupofEMD.\n323\n",
      "summary": "The performance of black-box EMD computation methods, including SIA, PB, DRO, and OI, is evaluated across varying k values and dataset sizes, showing that DRO achieves query times and refinement counts close to the oracle method while demonstrating scalability on large datasets."
    },
    {
      "title": "5.3 Parameter Tuning in DRO",
      "start_index": 11,
      "end_index": 11,
      "nodes": [],
      "node_id": "0016",
      "text": "2 1\n0 100K 200K 300K 400K 500K Dataset size\n)301x( stnemenifer\nfo\n#\n0.4 0.3 0.2\n0.1\n0.0\n)s301x( emit\nyreuQ\nSIA SIA PB-C PB PB DRO-C DRO DRO 4\n2\n0 64K 128K192K256K320K Dataset size\n(a) PANORAMIO\n)301x( stnemenifer\nfo\n#\n1.5 1.0\n0.5\n0.0\n)s301x( emit\nyreuQ\nS PB IA S PB IA P D B R - O C -C 9 DRO DRO 6\n3\n0 0.6M 1.2M 1.8M 2.4M 3.0M Dataset size\n(b) FRIENDS\n)301x( stnemenifeR\nfo\n#\n8.0 6.0 4.0\n2.0\n0\n)s301x( emit\nyreuQ\nSIA SIA PB-C 2.0 PB PB DRO-C DRO DRO 1.5 1.0\n0.5\n0 256 400 576 784 1024 Number of bins\n(c) WORLD\nFigure15:Scalabilitytodatasetcardinality(numberofobjects)\n)s301x( emit\nyreuQ\nSIA 8 PB DRO 6 4\n2\n0 5767841024 1600 2304 Number of bins\n(a) PANORAMIO\n)s401x( emit\nyreuQ\nSIA PB DRO\n(b) WORLD\nFigure16:Scalabilitytohistogramdimensionality\nbyPB-CandDRO-C).WeobservethatSIAisquitesensitivetothe\nnumber of refinements while PB and DRO are likely sensitive to\nthenumberofthecompleterefinements(PB-CandDRO-C).Inad-\ndition,theimprovementofDROoverPBisstable,indicatingthat\nthereorderingtechniqueisnotaffectedbytheincreasingnumber\nofobjectsthatsurvivethefilters.\nInthesecondscalabilitystudy,weevaluatetheeffectivenessof\nourtechniquesagainstthehistogramdimensionality(i.e.,number\nof bins). We generate histogram sets of different dimensionali-\nties(squaregridgranularities)upto2304, onPANORAMIOand\nWORLD. Figure 16 shows the query time as a function of the\nhistogram dimensionality on the two datasets (k = 32). We ob-\nserve that the query time of PB and DRO increases more slowly\ncomparedtothatofSIA. Thegracefulscalabilityofourmethods\nw.r.t. histogram dimensionality enables the application of EMD-\nbasedsimilaritysearchonhigh-dimensionalhistogramrepresenta-\ntions(e.g.,multi-dimensionalfeatureswithfinepartitioning).\n5.3 ParameterTuninginDRO\nFinally,wedemonstratetheeffectoftwosensitiveparametersin\nDRO,i.e.,themaximumnumberofconcurrentlyrefinedobjectsb\n(thesizeofPL),andthefunctiontoprioritizeobjectsinDRO.\n60\n40\n20\n0\n48 16 32 64\nk\n)s( emit\nyreuQ\n0.05% 80\n0.1%\n0 0 . . 2 4 % % 60\n40\n20\n0\n48 16 32 64\nk\n(a) SizeofPL,b\n)s( emit\nyreuQ\ncost, where α indicates the tightness of the running bounds (i.e.,\nemd+−emd− ).AsFigure17(b)shows,thisfunction,whenusedin\nemd+\nDRO,maintainsaconstantadvantageoverPB,comparedtoprior-\nitizingbyjustusingemd−oremd+.\n6. RELATEDWORK\nEarthMover’sDistance(EMD)wasfirstintroducedbythecom-\nputervisioncommunityasaneffectivesimilaritymetric[23].EMD\nisalsoknownasMallowsdistanceorWassersteindistanceinstatis-\ntics[15]. Asacross-bindistance,EMDmatchesbetterthehuman\nperception of differences [22], compared to bin-by-bin distances\nlikeEuclideandistanceorχ2-statistic.EMDsupportsanalysisand\nsearchinawiderangeofapplicationdomains, suchasimagere-\ntrieval[23,24],computervision[11,17,21],machinelearning[6,9],\nprobabilistic[25,32]andmultimediadatabases[5,30],videoand\nmusic identification [28,31], phishing detection [10], data clean-\ning [8], privacy [16], matrix factorization [26], clustering [4,6],\nclassification[14],etc.Anempiricalstudy[20]thatcomparesnine\nfamiliesofimagedissimilaritymeasuresbasedondistributionsof\ncolor and texture features shows that EMD has the best overall\nqualityamongtheothers,yetalsothehighestcomputationalcost.\nDue to the usefulness of EMD, the database community de-\nPB veloped techniques for similarity queries based on this measure.\ne\ne\nm\nm\nd\nd\n−+\nWorkinthisdirectionisbasedonthefilter-and-refinementframe- DRO work[5,25,30,32],describedinSection2.2.Themainfocusisthe\ndevelopment of fast and effective lower bounds for EMD, which\nhelp in pruning objects that cannot make it in the result, at the\nfilter phase. Assent et al. [5] were the first to study EMD in the\nfilter-and-refinementframework. Wichterichetal.[30]proposea\n(b) Prioritizingfunction dimensionalityreductiontechnique,showingthattheEMDoftwo\nobjectsinthederivedspaceisalowerboundfortheiractualEMD.\nFigure17:PerformancetuningofDROonPANORAMIO Xuetal.[32]proposealowerboundofEMDbasedonprimal-dual\ntechniques[1]fromlinearprogramminganduseB+-treeindexing\nFigure17(a)showstheaveragequerytimeofk-NNquerieson tosupportthefilterphaseofk-NNandrangequeries. Ruttenberg\nthe PANORAMIO dataset, for different values of b (as different andSingh[25]developanewindexstructureforEMD-basedsimi-\nseries). DRO becomes faster when b increases, which indicates larityqueriesbasedontheprojectionlowerboundin[7].Allthese\nthatconcurrentrefinementisaneffectivestrategytoevaluateEMD- solutionsfocusonlyontheeffectivenessoffiltersandefficiencyof\nbasedk-NNqueries.Ontheotherhand,asdiscussedinSection4.4, thefilterphase,simplytreatingtherefinementphaseasablack-box\nthememoryrequirementsofDROareproportionaltob,sotheper- process. However,aswehaveshowninthispaper,therefinement\nformanceimprovementcomeswithamemorytradeoff. costdominatestheoverallcostanddeservesmoreattention.\nAs mentioned in Section 4.4, the running lower bound emd− Besidestheseresultsbythedatabasecommunity,therearealso\ncan be used to prioritize objects in DRO. However, as shown in studiesonefficientEMDapproximations[2,3,13,19,27]. Andoni\nFigure17(b),emd−isnotaneffectiveprioritizingfunctionsinceit etal.[3]studyEMDapproximationsinhigh-dimensionalspaces.\ndoesnottaketheboundtightnessintoconsideration. Forinstance, PeleandWerman[19]acceleratestheEMDcomputationbylimit-\nassume that both emd− pa and emd− pb have the same value. Intu- ingthenumberofedgesintheflowgraph, withoutguaranteesof\nitively, if emd+ < emd+ , p should be given higher priority thequalityofapproximation. Both[13]and[27]studylinear-time\npa pb a\nthanp duringtherefinement,becausep hasatighterboundand approximations of EMD, and [2] proposes sketches for approxi-\nb a\nitismorelikelytobeaddedtothecurrentk-NNsetHanddecrease matingplanarEMD.However,theseworksassumeeitherspecific\nθ. Thus, DRO (in Figure 17(b) and the previous experiments) ground distances (e.g., L norm) [2,3,27] and bin spaces (e.g.,\n1\nuses the following prioritizing function, which is a slight modifi- R2)[2,3,13,27],orcertainhistogramtypes(e.g.,dominantcolor\ncationofemd−(Definition3):(1−α)·currentcost+α·estimated descriptor)[13],whichdonotapplytothegeneralsetupofEMD.\n323\n",
      "summary": "The study evaluates the scalability of EMD-based similarity search methods (SIA, PB, DRO) with respect to dataset size and histogram dimensionality, showing that DRO and PB scale more gracefully than SIA and maintain stable performance improvements due to effective refinement and reordering techniques, enabling efficient high-dimensional histogram comparison."
    },
    {
      "title": "6. RELATED WORK",
      "start_index": 11,
      "end_index": 12,
      "nodes": [],
      "node_id": "0017",
      "text": "2 1\n0 100K 200K 300K 400K 500K Dataset size\n)301x( stnemenifer\nfo\n#\n0.4 0.3 0.2\n0.1\n0.0\n)s301x( emit\nyreuQ\nSIA SIA PB-C PB PB DRO-C DRO DRO 4\n2\n0 64K 128K192K256K320K Dataset size\n(a) PANORAMIO\n)301x( stnemenifer\nfo\n#\n1.5 1.0\n0.5\n0.0\n)s301x( emit\nyreuQ\nS PB IA S PB IA P D B R - O C -C 9 DRO DRO 6\n3\n0 0.6M 1.2M 1.8M 2.4M 3.0M Dataset size\n(b) FRIENDS\n)301x( stnemenifeR\nfo\n#\n8.0 6.0 4.0\n2.0\n0\n)s301x( emit\nyreuQ\nSIA SIA PB-C 2.0 PB PB DRO-C DRO DRO 1.5 1.0\n0.5\n0 256 400 576 784 1024 Number of bins\n(c) WORLD\nFigure15:Scalabilitytodatasetcardinality(numberofobjects)\n)s301x( emit\nyreuQ\nSIA 8 PB DRO 6 4\n2\n0 5767841024 1600 2304 Number of bins\n(a) PANORAMIO\n)s401x( emit\nyreuQ\nSIA PB DRO\n(b) WORLD\nFigure16:Scalabilitytohistogramdimensionality\nbyPB-CandDRO-C).WeobservethatSIAisquitesensitivetothe\nnumber of refinements while PB and DRO are likely sensitive to\nthenumberofthecompleterefinements(PB-CandDRO-C).Inad-\ndition,theimprovementofDROoverPBisstable,indicatingthat\nthereorderingtechniqueisnotaffectedbytheincreasingnumber\nofobjectsthatsurvivethefilters.\nInthesecondscalabilitystudy,weevaluatetheeffectivenessof\nourtechniquesagainstthehistogramdimensionality(i.e.,number\nof bins). We generate histogram sets of different dimensionali-\nties(squaregridgranularities)upto2304, onPANORAMIOand\nWORLD. Figure 16 shows the query time as a function of the\nhistogram dimensionality on the two datasets (k = 32). We ob-\nserve that the query time of PB and DRO increases more slowly\ncomparedtothatofSIA. Thegracefulscalabilityofourmethods\nw.r.t. histogram dimensionality enables the application of EMD-\nbasedsimilaritysearchonhigh-dimensionalhistogramrepresenta-\ntions(e.g.,multi-dimensionalfeatureswithfinepartitioning).\n5.3 ParameterTuninginDRO\nFinally,wedemonstratetheeffectoftwosensitiveparametersin\nDRO,i.e.,themaximumnumberofconcurrentlyrefinedobjectsb\n(thesizeofPL),andthefunctiontoprioritizeobjectsinDRO.\n60\n40\n20\n0\n48 16 32 64\nk\n)s( emit\nyreuQ\n0.05% 80\n0.1%\n0 0 . . 2 4 % % 60\n40\n20\n0\n48 16 32 64\nk\n(a) SizeofPL,b\n)s( emit\nyreuQ\ncost, where α indicates the tightness of the running bounds (i.e.,\nemd+−emd− ).AsFigure17(b)shows,thisfunction,whenusedin\nemd+\nDRO,maintainsaconstantadvantageoverPB,comparedtoprior-\nitizingbyjustusingemd−oremd+.\n6. RELATEDWORK\nEarthMover’sDistance(EMD)wasfirstintroducedbythecom-\nputervisioncommunityasaneffectivesimilaritymetric[23].EMD\nisalsoknownasMallowsdistanceorWassersteindistanceinstatis-\ntics[15]. Asacross-bindistance,EMDmatchesbetterthehuman\nperception of differences [22], compared to bin-by-bin distances\nlikeEuclideandistanceorχ2-statistic.EMDsupportsanalysisand\nsearchinawiderangeofapplicationdomains, suchasimagere-\ntrieval[23,24],computervision[11,17,21],machinelearning[6,9],\nprobabilistic[25,32]andmultimediadatabases[5,30],videoand\nmusic identification [28,31], phishing detection [10], data clean-\ning [8], privacy [16], matrix factorization [26], clustering [4,6],\nclassification[14],etc.Anempiricalstudy[20]thatcomparesnine\nfamiliesofimagedissimilaritymeasuresbasedondistributionsof\ncolor and texture features shows that EMD has the best overall\nqualityamongtheothers,yetalsothehighestcomputationalcost.\nDue to the usefulness of EMD, the database community de-\nPB veloped techniques for similarity queries based on this measure.\ne\ne\nm\nm\nd\nd\n−+\nWorkinthisdirectionisbasedonthefilter-and-refinementframe- DRO work[5,25,30,32],describedinSection2.2.Themainfocusisthe\ndevelopment of fast and effective lower bounds for EMD, which\nhelp in pruning objects that cannot make it in the result, at the\nfilter phase. Assent et al. [5] were the first to study EMD in the\nfilter-and-refinementframework. Wichterichetal.[30]proposea\n(b) Prioritizingfunction dimensionalityreductiontechnique,showingthattheEMDoftwo\nobjectsinthederivedspaceisalowerboundfortheiractualEMD.\nFigure17:PerformancetuningofDROonPANORAMIO Xuetal.[32]proposealowerboundofEMDbasedonprimal-dual\ntechniques[1]fromlinearprogramminganduseB+-treeindexing\nFigure17(a)showstheaveragequerytimeofk-NNquerieson tosupportthefilterphaseofk-NNandrangequeries. Ruttenberg\nthe PANORAMIO dataset, for different values of b (as different andSingh[25]developanewindexstructureforEMD-basedsimi-\nseries). DRO becomes faster when b increases, which indicates larityqueriesbasedontheprojectionlowerboundin[7].Allthese\nthatconcurrentrefinementisaneffectivestrategytoevaluateEMD- solutionsfocusonlyontheeffectivenessoffiltersandefficiencyof\nbasedk-NNqueries.Ontheotherhand,asdiscussedinSection4.4, thefilterphase,simplytreatingtherefinementphaseasablack-box\nthememoryrequirementsofDROareproportionaltob,sotheper- process. However,aswehaveshowninthispaper,therefinement\nformanceimprovementcomeswithamemorytradeoff. costdominatestheoverallcostanddeservesmoreattention.\nAs mentioned in Section 4.4, the running lower bound emd− Besidestheseresultsbythedatabasecommunity,therearealso\ncan be used to prioritize objects in DRO. However, as shown in studiesonefficientEMDapproximations[2,3,13,19,27]. Andoni\nFigure17(b),emd−isnotaneffectiveprioritizingfunctionsinceit etal.[3]studyEMDapproximationsinhigh-dimensionalspaces.\ndoesnottaketheboundtightnessintoconsideration. Forinstance, PeleandWerman[19]acceleratestheEMDcomputationbylimit-\nassume that both emd− pa and emd− pb have the same value. Intu- ingthenumberofedgesintheflowgraph, withoutguaranteesof\nitively, if emd+ < emd+ , p should be given higher priority thequalityofapproximation. Both[13]and[27]studylinear-time\npa pb a\nthanp duringtherefinement,becausep hasatighterboundand approximations of EMD, and [2] proposes sketches for approxi-\nb a\nitismorelikelytobeaddedtothecurrentk-NNsetHanddecrease matingplanarEMD.However,theseworksassumeeitherspecific\nθ. Thus, DRO (in Figure 17(b) and the previous experiments) ground distances (e.g., L norm) [2,3,27] and bin spaces (e.g.,\n1\nuses the following prioritizing function, which is a slight modifi- R2)[2,3,13,27],orcertainhistogramtypes(e.g.,dominantcolor\ncationofemd−(Definition3):(1−α)·currentcost+α·estimated descriptor)[13],whichdonotapplytothegeneralsetupofEMD.\n323\nForexample, thechoiceofgrounddistancecouldbeapplication- [6] M.H.Coen,M.H.Ansari,andN.Fillmore.Comparingclusterings\ndependent[19,22,24]. Notethatourproposedtechniquesdonot inspace.InICML,pages231–238,2010.\nhaveanyoftheaboverestrictions. Moreover,thereisnostudyon [7] S.CohenandL.Guibas.Theearthmover”sdistance:Lowerbounds\nfiltering bounds and indexing structures on top of these approxi- andinvarianceundertranslation.Technicalreport,Stanford\nUniversity,1997.\nmation techniques. Therefore, using the approximation methods,\n[8] T.DasuandJ.M.Loh.Statisticaldistortion:Consequencesofdata\nasimilarityquerymayhavetocomputeEMDsbetweenthequery\ncleaning.PVLDB,5(11):1674–1683,2012.\nandalltheobjectsinthedatabase,whichisnotscalableforlarge\n[9] N.Ferns,P.S.Castro,D.Precup,andP.Panangaden.Methodsfor\ndatasets. Finally, the acceleration of EMD under Manhattan net- computingstatesimilarityinmarkovdecisionprocesses.InUAI,\nworkwhenusingL 1 asthegrounddistanceisstudiedin[18]. pages174–181,2006.\n[10] A.Y.Fu,L.Wenyin,andX.Deng.Detectingphishingwebpages\nwithvisualsimilarityassessmentbasedonearthmover’sdistance\n7. CONCLUSION\n(EMD).IEEETrans.DependableSec.Comput.,3(4):301–311,2006.\nIn this paper, we studied the efficient evaluation of similarity [11] K.GraumanandT.Darrell.Fastcontourmatchingusingapproximate\nqueries using Earth Mover’s Distance (EMD). First, we showed earthmover’sdistance.InCVPR(1),pages220–227,2004.\nhowwecanadaptSIA,analgorithmoriginallyproposedforspatial [12] F.S.HillierandG.J.Lieberman.IntroductiontoMathematical\nProgramming.McGraw-Hill,1990.\nmatchingproblems,tocomputetheEMDbetweentwohistograms\n[13] M.-H.Jang,S.-W.Kim,C.Faloutsos,andS.Park.Alinear-time\nefficiently. Then, we proposed a progressive refinement strategy,\napproximationoftheearthmover’sdistance.InCIKM,pages\nwhichupdatesalowerboundforEMDduringitscomputation,in\n505–514,2011.\nordertoabandonearlyapartialEMDrefinement,iftheobjectcan- [14] H.J.Karloff,S.Khot,A.Mehta,andY.Rabani.Onearthmover\nnotmakeitinthequeryresult. Finally, weproposedatechnique distance,metriclabeling,and0-extension.InSTOC,pages547–556,\nwhichconcurrentlyhandlestherefinementofmultiplecandidates, 2006.\nbydynamicallyreorderingthemandcomputingupperboundsthat [15] E.LevinaandP.J.Bickel.Theearthmover’sdistanceisthemallows\nhelptotightenthepruningthresholdearly. Ourexperimentsshow distance:Someinsightsfromstatistics.InICCV,pages251–256,\n2001.\nthatourmethodsareveryeffectiveinpractice,decreasingtheover-\n[16] N.Li,T.Li,andS.Venkatasubramanian.t-closeness:Privacybeyond\nall cost of EMD-based similarity queries by up to two orders of\nk-anonymityandl-diversity.InICDE,pages106–115,2007.\nmagnitude,comparedtothestate-of-the-artsolution[25].\n[17] P.Li,Q.Wang,andL.Zhang.Anovelearthmover’sdistance\nNote that although our discussion assumes that the histograms methodologyforimagematchingwithgaussianmixturemodels.In\narenormalizedtosumuptothesamevalues,EMDcanalsobeap- ICCV,2013(toappear).\npliedincaseswherehistogramsarenotnormalized(inthiscase,a [18] H.LingandK.Okada.Anefficientearthmover’sdistancealgorithm\nslightlydifferentdefinitionthanthatofEquation2isusedtoreflect forrobusthistogramcomparison.IEEETrans.PatternAnal.Mach.\nthemaximumflowthatcouldbesentfromqtop). Inaddition,it Intell.,29(5):840–853,2007.\nisnotnecessarythatthetwohistogramshavethesamenumberor [19] O.PeleandM.Werman.Fastandrobustearthmover’sdistances.In\nICCV,pages460–467,2009.\nlocationsofbins.Ourframeworkandsolutionsarenotsensitiveto\n[20] J.Puzicha,Y.Rubner,C.Tomasi,andJ.M.Buhmann.Empirical\ntheseproblemvariants. Finally,notethatoursolutioncanalsobe\nevaluationofdissimilaritymeasuresforcolorandtexture.InICCV,\nusedforevaluatingrangesimilarityqueries,wheretheobjectiveis pages1165–1172,1999.\ntoretrieveobjectswhoseEMDtoqdoesnotexceedagiventhresh- [21] Z.Ren,J.Yuan,andZ.Zhang.Robusthandgesturerecognition\nold(cid:15). Inthiscase,SIAandPBcandirectlybeapplied,however, basedonfinger-earthmover’sdistancewithacommoditydepth\nDROisnotrelevantbecausethethresholdisfixedandinsensitive camera.InACMMultimedia,pages1093–1096,2011.\ntotheexecutionorder. [22] Y.RubnerandC.Tomasi.PerceptualMetricsforImageDatabase\nInthefuture,weplantostudytheoptimizationoftherefinement\nNavigation.KluwerAcademicPublishers,2001.\n[23] Y.Rubner,C.Tomasi,andL.J.Guibas.Ametricfordistributions\nstepinsimilarityqueriesbasedonotherexpensivedistancemea-\nwithapplicationstoimagedatabases.InICCV,pages59–66,1998.\nsures(suchasdynamictimewarping).\n[24] Y.Rubner,C.Tomasi,andL.J.Guibas.Theearthmover’sdistance\nasametricforimageretrieval.InternationalJournalofComputer\n8. ACKNOWLEDGMENT Vision,40(2):99–121,2000.\n[25] B.E.RuttenbergandA.K.Singh.Indexingtheearthmover’s\nThis work is supported by grants HKU 714212E, 711110, and distanceusingnormaldistributions.PVLDB,5(3):205–216,2011.\n711309E from Hong Kong RGC. Leong Hou U is supported by [26] R.SandlerandM.Lindenbaum.Nonnegativematrixfactorization\ngrant MYRG109(Y1-L3)-FST12-ULH. We would like to thank withearthmover’sdistancemetric.InCVPR,pages1873–1880,\nBrian Ruttenberg for providing part of his code on [25] and the 2009.\nanonymousreviewersfortheirinsightfulcomments. [27] S.ShirdhonkarandD.W.Jacobs.Approximateearthmover’s\ndistanceinlineartime.InCVPR,pages1–8,2008.\n[28] R.Typke,P.Giannopoulos,R.C.Veltkamp,F.Wiering,andR.van\n9. REFERENCES Oostrum.Usingtransportationdistancesformeasuringmelodic\n[1] R.K.Ahuja,T.L.Magnanti,andJ.B.Orlin.Networkflows:theory, similarity.InISMIR,pages107–114,2003.\nalgorithmsandapplications.PrenticeHall,1993. [29] L.H.U,K.Mouratidis,M.L.Yiu,andN.Mamoulis.Optimal\n[2] A.Andoni,K.D.Ba,P.Indyk,andD.P.Woodruff.Efficientsketches matchingbetweenspatialdatasetsundercapacityconstraints.ACM\nforearth-moverdistance,withapplications.InFOCS,pages Trans.DatabaseSyst.,35(2),2010.\n324–330,2009. [30] M.Wichterich,I.Assent,P.Kranen,andT.Seidl.Efficient\n[3] A.Andoni,P.Indyk,andR.Krauthgamer.Earthmoverdistanceover EMD-basedsimilaritysearchinmultimediadatabasesviaflexible\nhigh-dimensionalspaces.InSODA,pages343–352,2008. dimensionalityreduction.InSIGMOD,pages199–212,2008.\n[4] D.Applegate,T.Dasu,S.Krishnan,andS.Urbanek.Unsupervised [31] J.Xu,Q.Bai,Y.Gu,A.K.H.Tung,G.Wang,G.Yu,andZ.Zhang.\nclusteringofmultidimensionaldistributionsusingearthmover EUDEMON:Asystemforonlinevideoframecopydetectionby\ndistance.InKDD,pages636–644,2011. earthmover’sdistance.InICDE,pages1233–1236,2012.\n[5] I.Assent,A.Wenning,andT.Seidl.Approximationtechniquesfor [32] J.Xu,Z.Zhang,A.K.H.Tung,andG.Yu.Efficientandeffective\nindexingtheearthmover’sdistanceinmultimediadatabases.In similaritysearchoverprobabilisticdatabasedonearthmover’s\nICDE,page11,2006. distance.PVLDB,3(1):758–769,2010.\n324\n",
      "summary": "The study evaluates the scalability of EMD-based similarity search methods (SIA, PB, DRO) with respect to dataset size and histogram dimensionality, showing that DRO and PB scale more gracefully than SIA, with DRO maintaining stable performance improvements due to its reordering technique, and demonstrates the impact of key parameters in DRO on query efficiency."
    },
    {
      "title": "7. CONCLUSION",
      "start_index": 12,
      "end_index": 12,
      "nodes": [],
      "node_id": "0018",
      "text": "Forexample, thechoiceofgrounddistancecouldbeapplication- [6] M.H.Coen,M.H.Ansari,andN.Fillmore.Comparingclusterings\ndependent[19,22,24]. Notethatourproposedtechniquesdonot inspace.InICML,pages231–238,2010.\nhaveanyoftheaboverestrictions. Moreover,thereisnostudyon [7] S.CohenandL.Guibas.Theearthmover”sdistance:Lowerbounds\nfiltering bounds and indexing structures on top of these approxi- andinvarianceundertranslation.Technicalreport,Stanford\nUniversity,1997.\nmation techniques. Therefore, using the approximation methods,\n[8] T.DasuandJ.M.Loh.Statisticaldistortion:Consequencesofdata\nasimilarityquerymayhavetocomputeEMDsbetweenthequery\ncleaning.PVLDB,5(11):1674–1683,2012.\nandalltheobjectsinthedatabase,whichisnotscalableforlarge\n[9] N.Ferns,P.S.Castro,D.Precup,andP.Panangaden.Methodsfor\ndatasets. Finally, the acceleration of EMD under Manhattan net- computingstatesimilarityinmarkovdecisionprocesses.InUAI,\nworkwhenusingL 1 asthegrounddistanceisstudiedin[18]. pages174–181,2006.\n[10] A.Y.Fu,L.Wenyin,andX.Deng.Detectingphishingwebpages\nwithvisualsimilarityassessmentbasedonearthmover’sdistance\n7. CONCLUSION\n(EMD).IEEETrans.DependableSec.Comput.,3(4):301–311,2006.\nIn this paper, we studied the efficient evaluation of similarity [11] K.GraumanandT.Darrell.Fastcontourmatchingusingapproximate\nqueries using Earth Mover’s Distance (EMD). First, we showed earthmover’sdistance.InCVPR(1),pages220–227,2004.\nhowwecanadaptSIA,analgorithmoriginallyproposedforspatial [12] F.S.HillierandG.J.Lieberman.IntroductiontoMathematical\nProgramming.McGraw-Hill,1990.\nmatchingproblems,tocomputetheEMDbetweentwohistograms\n[13] M.-H.Jang,S.-W.Kim,C.Faloutsos,andS.Park.Alinear-time\nefficiently. Then, we proposed a progressive refinement strategy,\napproximationoftheearthmover’sdistance.InCIKM,pages\nwhichupdatesalowerboundforEMDduringitscomputation,in\n505–514,2011.\nordertoabandonearlyapartialEMDrefinement,iftheobjectcan- [14] H.J.Karloff,S.Khot,A.Mehta,andY.Rabani.Onearthmover\nnotmakeitinthequeryresult. Finally, weproposedatechnique distance,metriclabeling,and0-extension.InSTOC,pages547–556,\nwhichconcurrentlyhandlestherefinementofmultiplecandidates, 2006.\nbydynamicallyreorderingthemandcomputingupperboundsthat [15] E.LevinaandP.J.Bickel.Theearthmover’sdistanceisthemallows\nhelptotightenthepruningthresholdearly. Ourexperimentsshow distance:Someinsightsfromstatistics.InICCV,pages251–256,\n2001.\nthatourmethodsareveryeffectiveinpractice,decreasingtheover-\n[16] N.Li,T.Li,andS.Venkatasubramanian.t-closeness:Privacybeyond\nall cost of EMD-based similarity queries by up to two orders of\nk-anonymityandl-diversity.InICDE,pages106–115,2007.\nmagnitude,comparedtothestate-of-the-artsolution[25].\n[17] P.Li,Q.Wang,andL.Zhang.Anovelearthmover’sdistance\nNote that although our discussion assumes that the histograms methodologyforimagematchingwithgaussianmixturemodels.In\narenormalizedtosumuptothesamevalues,EMDcanalsobeap- ICCV,2013(toappear).\npliedincaseswherehistogramsarenotnormalized(inthiscase,a [18] H.LingandK.Okada.Anefficientearthmover’sdistancealgorithm\nslightlydifferentdefinitionthanthatofEquation2isusedtoreflect forrobusthistogramcomparison.IEEETrans.PatternAnal.Mach.\nthemaximumflowthatcouldbesentfromqtop). Inaddition,it Intell.,29(5):840–853,2007.\nisnotnecessarythatthetwohistogramshavethesamenumberor [19] O.PeleandM.Werman.Fastandrobustearthmover’sdistances.In\nICCV,pages460–467,2009.\nlocationsofbins.Ourframeworkandsolutionsarenotsensitiveto\n[20] J.Puzicha,Y.Rubner,C.Tomasi,andJ.M.Buhmann.Empirical\ntheseproblemvariants. Finally,notethatoursolutioncanalsobe\nevaluationofdissimilaritymeasuresforcolorandtexture.InICCV,\nusedforevaluatingrangesimilarityqueries,wheretheobjectiveis pages1165–1172,1999.\ntoretrieveobjectswhoseEMDtoqdoesnotexceedagiventhresh- [21] Z.Ren,J.Yuan,andZ.Zhang.Robusthandgesturerecognition\nold(cid:15). Inthiscase,SIAandPBcandirectlybeapplied,however, basedonfinger-earthmover’sdistancewithacommoditydepth\nDROisnotrelevantbecausethethresholdisfixedandinsensitive camera.InACMMultimedia,pages1093–1096,2011.\ntotheexecutionorder. [22] Y.RubnerandC.Tomasi.PerceptualMetricsforImageDatabase\nInthefuture,weplantostudytheoptimizationoftherefinement\nNavigation.KluwerAcademicPublishers,2001.\n[23] Y.Rubner,C.Tomasi,andL.J.Guibas.Ametricfordistributions\nstepinsimilarityqueriesbasedonotherexpensivedistancemea-\nwithapplicationstoimagedatabases.InICCV,pages59–66,1998.\nsures(suchasdynamictimewarping).\n[24] Y.Rubner,C.Tomasi,andL.J.Guibas.Theearthmover’sdistance\nasametricforimageretrieval.InternationalJournalofComputer\n8. ACKNOWLEDGMENT Vision,40(2):99–121,2000.\n[25] B.E.RuttenbergandA.K.Singh.Indexingtheearthmover’s\nThis work is supported by grants HKU 714212E, 711110, and distanceusingnormaldistributions.PVLDB,5(3):205–216,2011.\n711309E from Hong Kong RGC. Leong Hou U is supported by [26] R.SandlerandM.Lindenbaum.Nonnegativematrixfactorization\ngrant MYRG109(Y1-L3)-FST12-ULH. We would like to thank withearthmover’sdistancemetric.InCVPR,pages1873–1880,\nBrian Ruttenberg for providing part of his code on [25] and the 2009.\nanonymousreviewersfortheirinsightfulcomments. [27] S.ShirdhonkarandD.W.Jacobs.Approximateearthmover’s\ndistanceinlineartime.InCVPR,pages1–8,2008.\n[28] R.Typke,P.Giannopoulos,R.C.Veltkamp,F.Wiering,andR.van\n9. REFERENCES Oostrum.Usingtransportationdistancesformeasuringmelodic\n[1] R.K.Ahuja,T.L.Magnanti,andJ.B.Orlin.Networkflows:theory, similarity.InISMIR,pages107–114,2003.\nalgorithmsandapplications.PrenticeHall,1993. [29] L.H.U,K.Mouratidis,M.L.Yiu,andN.Mamoulis.Optimal\n[2] A.Andoni,K.D.Ba,P.Indyk,andD.P.Woodruff.Efficientsketches matchingbetweenspatialdatasetsundercapacityconstraints.ACM\nforearth-moverdistance,withapplications.InFOCS,pages Trans.DatabaseSyst.,35(2),2010.\n324–330,2009. [30] M.Wichterich,I.Assent,P.Kranen,andT.Seidl.Efficient\n[3] A.Andoni,P.Indyk,andR.Krauthgamer.Earthmoverdistanceover EMD-basedsimilaritysearchinmultimediadatabasesviaflexible\nhigh-dimensionalspaces.InSODA,pages343–352,2008. dimensionalityreduction.InSIGMOD,pages199–212,2008.\n[4] D.Applegate,T.Dasu,S.Krishnan,andS.Urbanek.Unsupervised [31] J.Xu,Q.Bai,Y.Gu,A.K.H.Tung,G.Wang,G.Yu,andZ.Zhang.\nclusteringofmultidimensionaldistributionsusingearthmover EUDEMON:Asystemforonlinevideoframecopydetectionby\ndistance.InKDD,pages636–644,2011. earthmover’sdistance.InICDE,pages1233–1236,2012.\n[5] I.Assent,A.Wenning,andT.Seidl.Approximationtechniquesfor [32] J.Xu,Z.Zhang,A.K.H.Tung,andG.Yu.Efficientandeffective\nindexingtheearthmover’sdistanceinmultimediadatabases.In similaritysearchoverprobabilisticdatabasedonearthmover’s\nICDE,page11,2006. distance.PVLDB,3(1):758–769,2010.\n324\n",
      "summary": "This paper proposes efficient techniques for computing Earth Mover's Distance (EMD) in similarity queries by adapting spatial matching algorithms, introducing a progressive refinement strategy with early pruning, and concurrently processing multiple candidates to improve performance, especially for large datasets."
    },
    {
      "title": "8. ACKNOWLEDGMENT",
      "start_index": 12,
      "end_index": 12,
      "nodes": [],
      "node_id": "0019",
      "text": "Forexample, thechoiceofgrounddistancecouldbeapplication- [6] M.H.Coen,M.H.Ansari,andN.Fillmore.Comparingclusterings\ndependent[19,22,24]. Notethatourproposedtechniquesdonot inspace.InICML,pages231–238,2010.\nhaveanyoftheaboverestrictions. Moreover,thereisnostudyon [7] S.CohenandL.Guibas.Theearthmover”sdistance:Lowerbounds\nfiltering bounds and indexing structures on top of these approxi- andinvarianceundertranslation.Technicalreport,Stanford\nUniversity,1997.\nmation techniques. Therefore, using the approximation methods,\n[8] T.DasuandJ.M.Loh.Statisticaldistortion:Consequencesofdata\nasimilarityquerymayhavetocomputeEMDsbetweenthequery\ncleaning.PVLDB,5(11):1674–1683,2012.\nandalltheobjectsinthedatabase,whichisnotscalableforlarge\n[9] N.Ferns,P.S.Castro,D.Precup,andP.Panangaden.Methodsfor\ndatasets. Finally, the acceleration of EMD under Manhattan net- computingstatesimilarityinmarkovdecisionprocesses.InUAI,\nworkwhenusingL 1 asthegrounddistanceisstudiedin[18]. pages174–181,2006.\n[10] A.Y.Fu,L.Wenyin,andX.Deng.Detectingphishingwebpages\nwithvisualsimilarityassessmentbasedonearthmover’sdistance\n7. CONCLUSION\n(EMD).IEEETrans.DependableSec.Comput.,3(4):301–311,2006.\nIn this paper, we studied the efficient evaluation of similarity [11] K.GraumanandT.Darrell.Fastcontourmatchingusingapproximate\nqueries using Earth Mover’s Distance (EMD). First, we showed earthmover’sdistance.InCVPR(1),pages220–227,2004.\nhowwecanadaptSIA,analgorithmoriginallyproposedforspatial [12] F.S.HillierandG.J.Lieberman.IntroductiontoMathematical\nProgramming.McGraw-Hill,1990.\nmatchingproblems,tocomputetheEMDbetweentwohistograms\n[13] M.-H.Jang,S.-W.Kim,C.Faloutsos,andS.Park.Alinear-time\nefficiently. Then, we proposed a progressive refinement strategy,\napproximationoftheearthmover’sdistance.InCIKM,pages\nwhichupdatesalowerboundforEMDduringitscomputation,in\n505–514,2011.\nordertoabandonearlyapartialEMDrefinement,iftheobjectcan- [14] H.J.Karloff,S.Khot,A.Mehta,andY.Rabani.Onearthmover\nnotmakeitinthequeryresult. Finally, weproposedatechnique distance,metriclabeling,and0-extension.InSTOC,pages547–556,\nwhichconcurrentlyhandlestherefinementofmultiplecandidates, 2006.\nbydynamicallyreorderingthemandcomputingupperboundsthat [15] E.LevinaandP.J.Bickel.Theearthmover’sdistanceisthemallows\nhelptotightenthepruningthresholdearly. Ourexperimentsshow distance:Someinsightsfromstatistics.InICCV,pages251–256,\n2001.\nthatourmethodsareveryeffectiveinpractice,decreasingtheover-\n[16] N.Li,T.Li,andS.Venkatasubramanian.t-closeness:Privacybeyond\nall cost of EMD-based similarity queries by up to two orders of\nk-anonymityandl-diversity.InICDE,pages106–115,2007.\nmagnitude,comparedtothestate-of-the-artsolution[25].\n[17] P.Li,Q.Wang,andL.Zhang.Anovelearthmover’sdistance\nNote that although our discussion assumes that the histograms methodologyforimagematchingwithgaussianmixturemodels.In\narenormalizedtosumuptothesamevalues,EMDcanalsobeap- ICCV,2013(toappear).\npliedincaseswherehistogramsarenotnormalized(inthiscase,a [18] H.LingandK.Okada.Anefficientearthmover’sdistancealgorithm\nslightlydifferentdefinitionthanthatofEquation2isusedtoreflect forrobusthistogramcomparison.IEEETrans.PatternAnal.Mach.\nthemaximumflowthatcouldbesentfromqtop). Inaddition,it Intell.,29(5):840–853,2007.\nisnotnecessarythatthetwohistogramshavethesamenumberor [19] O.PeleandM.Werman.Fastandrobustearthmover’sdistances.In\nICCV,pages460–467,2009.\nlocationsofbins.Ourframeworkandsolutionsarenotsensitiveto\n[20] J.Puzicha,Y.Rubner,C.Tomasi,andJ.M.Buhmann.Empirical\ntheseproblemvariants. Finally,notethatoursolutioncanalsobe\nevaluationofdissimilaritymeasuresforcolorandtexture.InICCV,\nusedforevaluatingrangesimilarityqueries,wheretheobjectiveis pages1165–1172,1999.\ntoretrieveobjectswhoseEMDtoqdoesnotexceedagiventhresh- [21] Z.Ren,J.Yuan,andZ.Zhang.Robusthandgesturerecognition\nold(cid:15). Inthiscase,SIAandPBcandirectlybeapplied,however, basedonfinger-earthmover’sdistancewithacommoditydepth\nDROisnotrelevantbecausethethresholdisfixedandinsensitive camera.InACMMultimedia,pages1093–1096,2011.\ntotheexecutionorder. [22] Y.RubnerandC.Tomasi.PerceptualMetricsforImageDatabase\nInthefuture,weplantostudytheoptimizationoftherefinement\nNavigation.KluwerAcademicPublishers,2001.\n[23] Y.Rubner,C.Tomasi,andL.J.Guibas.Ametricfordistributions\nstepinsimilarityqueriesbasedonotherexpensivedistancemea-\nwithapplicationstoimagedatabases.InICCV,pages59–66,1998.\nsures(suchasdynamictimewarping).\n[24] Y.Rubner,C.Tomasi,andL.J.Guibas.Theearthmover’sdistance\nasametricforimageretrieval.InternationalJournalofComputer\n8. ACKNOWLEDGMENT Vision,40(2):99–121,2000.\n[25] B.E.RuttenbergandA.K.Singh.Indexingtheearthmover’s\nThis work is supported by grants HKU 714212E, 711110, and distanceusingnormaldistributions.PVLDB,5(3):205–216,2011.\n711309E from Hong Kong RGC. Leong Hou U is supported by [26] R.SandlerandM.Lindenbaum.Nonnegativematrixfactorization\ngrant MYRG109(Y1-L3)-FST12-ULH. We would like to thank withearthmover’sdistancemetric.InCVPR,pages1873–1880,\nBrian Ruttenberg for providing part of his code on [25] and the 2009.\nanonymousreviewersfortheirinsightfulcomments. [27] S.ShirdhonkarandD.W.Jacobs.Approximateearthmover’s\ndistanceinlineartime.InCVPR,pages1–8,2008.\n[28] R.Typke,P.Giannopoulos,R.C.Veltkamp,F.Wiering,andR.van\n9. REFERENCES Oostrum.Usingtransportationdistancesformeasuringmelodic\n[1] R.K.Ahuja,T.L.Magnanti,andJ.B.Orlin.Networkflows:theory, similarity.InISMIR,pages107–114,2003.\nalgorithmsandapplications.PrenticeHall,1993. [29] L.H.U,K.Mouratidis,M.L.Yiu,andN.Mamoulis.Optimal\n[2] A.Andoni,K.D.Ba,P.Indyk,andD.P.Woodruff.Efficientsketches matchingbetweenspatialdatasetsundercapacityconstraints.ACM\nforearth-moverdistance,withapplications.InFOCS,pages Trans.DatabaseSyst.,35(2),2010.\n324–330,2009. [30] M.Wichterich,I.Assent,P.Kranen,andT.Seidl.Efficient\n[3] A.Andoni,P.Indyk,andR.Krauthgamer.Earthmoverdistanceover EMD-basedsimilaritysearchinmultimediadatabasesviaflexible\nhigh-dimensionalspaces.InSODA,pages343–352,2008. dimensionalityreduction.InSIGMOD,pages199–212,2008.\n[4] D.Applegate,T.Dasu,S.Krishnan,andS.Urbanek.Unsupervised [31] J.Xu,Q.Bai,Y.Gu,A.K.H.Tung,G.Wang,G.Yu,andZ.Zhang.\nclusteringofmultidimensionaldistributionsusingearthmover EUDEMON:Asystemforonlinevideoframecopydetectionby\ndistance.InKDD,pages636–644,2011. earthmover’sdistance.InICDE,pages1233–1236,2012.\n[5] I.Assent,A.Wenning,andT.Seidl.Approximationtechniquesfor [32] J.Xu,Z.Zhang,A.K.H.Tung,andG.Yu.Efficientandeffective\nindexingtheearthmover’sdistanceinmultimediadatabases.In similaritysearchoverprobabilisticdatabasedonearthmover’s\nICDE,page11,2006. distance.PVLDB,3(1):758–769,2010.\n324\n",
      "summary": "This paper proposes efficient techniques for computing Earth Mover's Distance (EMD) in similarity queries by adapting spatial matching algorithms, introducing a progressive refinement strategy with early pruning, and concurrently processing multiple candidates to improve performance, especially for large datasets."
    },
    {
      "title": "9. REFERENCES",
      "start_index": 12,
      "end_index": 12,
      "nodes": [],
      "node_id": "0020",
      "text": "Forexample, thechoiceofgrounddistancecouldbeapplication- [6] M.H.Coen,M.H.Ansari,andN.Fillmore.Comparingclusterings\ndependent[19,22,24]. Notethatourproposedtechniquesdonot inspace.InICML,pages231–238,2010.\nhaveanyoftheaboverestrictions. Moreover,thereisnostudyon [7] S.CohenandL.Guibas.Theearthmover”sdistance:Lowerbounds\nfiltering bounds and indexing structures on top of these approxi- andinvarianceundertranslation.Technicalreport,Stanford\nUniversity,1997.\nmation techniques. Therefore, using the approximation methods,\n[8] T.DasuandJ.M.Loh.Statisticaldistortion:Consequencesofdata\nasimilarityquerymayhavetocomputeEMDsbetweenthequery\ncleaning.PVLDB,5(11):1674–1683,2012.\nandalltheobjectsinthedatabase,whichisnotscalableforlarge\n[9] N.Ferns,P.S.Castro,D.Precup,andP.Panangaden.Methodsfor\ndatasets. Finally, the acceleration of EMD under Manhattan net- computingstatesimilarityinmarkovdecisionprocesses.InUAI,\nworkwhenusingL 1 asthegrounddistanceisstudiedin[18]. pages174–181,2006.\n[10] A.Y.Fu,L.Wenyin,andX.Deng.Detectingphishingwebpages\nwithvisualsimilarityassessmentbasedonearthmover’sdistance\n7. CONCLUSION\n(EMD).IEEETrans.DependableSec.Comput.,3(4):301–311,2006.\nIn this paper, we studied the efficient evaluation of similarity [11] K.GraumanandT.Darrell.Fastcontourmatchingusingapproximate\nqueries using Earth Mover’s Distance (EMD). First, we showed earthmover’sdistance.InCVPR(1),pages220–227,2004.\nhowwecanadaptSIA,analgorithmoriginallyproposedforspatial [12] F.S.HillierandG.J.Lieberman.IntroductiontoMathematical\nProgramming.McGraw-Hill,1990.\nmatchingproblems,tocomputetheEMDbetweentwohistograms\n[13] M.-H.Jang,S.-W.Kim,C.Faloutsos,andS.Park.Alinear-time\nefficiently. Then, we proposed a progressive refinement strategy,\napproximationoftheearthmover’sdistance.InCIKM,pages\nwhichupdatesalowerboundforEMDduringitscomputation,in\n505–514,2011.\nordertoabandonearlyapartialEMDrefinement,iftheobjectcan- [14] H.J.Karloff,S.Khot,A.Mehta,andY.Rabani.Onearthmover\nnotmakeitinthequeryresult. Finally, weproposedatechnique distance,metriclabeling,and0-extension.InSTOC,pages547–556,\nwhichconcurrentlyhandlestherefinementofmultiplecandidates, 2006.\nbydynamicallyreorderingthemandcomputingupperboundsthat [15] E.LevinaandP.J.Bickel.Theearthmover’sdistanceisthemallows\nhelptotightenthepruningthresholdearly. Ourexperimentsshow distance:Someinsightsfromstatistics.InICCV,pages251–256,\n2001.\nthatourmethodsareveryeffectiveinpractice,decreasingtheover-\n[16] N.Li,T.Li,andS.Venkatasubramanian.t-closeness:Privacybeyond\nall cost of EMD-based similarity queries by up to two orders of\nk-anonymityandl-diversity.InICDE,pages106–115,2007.\nmagnitude,comparedtothestate-of-the-artsolution[25].\n[17] P.Li,Q.Wang,andL.Zhang.Anovelearthmover’sdistance\nNote that although our discussion assumes that the histograms methodologyforimagematchingwithgaussianmixturemodels.In\narenormalizedtosumuptothesamevalues,EMDcanalsobeap- ICCV,2013(toappear).\npliedincaseswherehistogramsarenotnormalized(inthiscase,a [18] H.LingandK.Okada.Anefficientearthmover’sdistancealgorithm\nslightlydifferentdefinitionthanthatofEquation2isusedtoreflect forrobusthistogramcomparison.IEEETrans.PatternAnal.Mach.\nthemaximumflowthatcouldbesentfromqtop). Inaddition,it Intell.,29(5):840–853,2007.\nisnotnecessarythatthetwohistogramshavethesamenumberor [19] O.PeleandM.Werman.Fastandrobustearthmover’sdistances.In\nICCV,pages460–467,2009.\nlocationsofbins.Ourframeworkandsolutionsarenotsensitiveto\n[20] J.Puzicha,Y.Rubner,C.Tomasi,andJ.M.Buhmann.Empirical\ntheseproblemvariants. Finally,notethatoursolutioncanalsobe\nevaluationofdissimilaritymeasuresforcolorandtexture.InICCV,\nusedforevaluatingrangesimilarityqueries,wheretheobjectiveis pages1165–1172,1999.\ntoretrieveobjectswhoseEMDtoqdoesnotexceedagiventhresh- [21] Z.Ren,J.Yuan,andZ.Zhang.Robusthandgesturerecognition\nold(cid:15). Inthiscase,SIAandPBcandirectlybeapplied,however, basedonfinger-earthmover’sdistancewithacommoditydepth\nDROisnotrelevantbecausethethresholdisfixedandinsensitive camera.InACMMultimedia,pages1093–1096,2011.\ntotheexecutionorder. [22] Y.RubnerandC.Tomasi.PerceptualMetricsforImageDatabase\nInthefuture,weplantostudytheoptimizationoftherefinement\nNavigation.KluwerAcademicPublishers,2001.\n[23] Y.Rubner,C.Tomasi,andL.J.Guibas.Ametricfordistributions\nstepinsimilarityqueriesbasedonotherexpensivedistancemea-\nwithapplicationstoimagedatabases.InICCV,pages59–66,1998.\nsures(suchasdynamictimewarping).\n[24] Y.Rubner,C.Tomasi,andL.J.Guibas.Theearthmover’sdistance\nasametricforimageretrieval.InternationalJournalofComputer\n8. ACKNOWLEDGMENT Vision,40(2):99–121,2000.\n[25] B.E.RuttenbergandA.K.Singh.Indexingtheearthmover’s\nThis work is supported by grants HKU 714212E, 711110, and distanceusingnormaldistributions.PVLDB,5(3):205–216,2011.\n711309E from Hong Kong RGC. Leong Hou U is supported by [26] R.SandlerandM.Lindenbaum.Nonnegativematrixfactorization\ngrant MYRG109(Y1-L3)-FST12-ULH. We would like to thank withearthmover’sdistancemetric.InCVPR,pages1873–1880,\nBrian Ruttenberg for providing part of his code on [25] and the 2009.\nanonymousreviewersfortheirinsightfulcomments. [27] S.ShirdhonkarandD.W.Jacobs.Approximateearthmover’s\ndistanceinlineartime.InCVPR,pages1–8,2008.\n[28] R.Typke,P.Giannopoulos,R.C.Veltkamp,F.Wiering,andR.van\n9. REFERENCES Oostrum.Usingtransportationdistancesformeasuringmelodic\n[1] R.K.Ahuja,T.L.Magnanti,andJ.B.Orlin.Networkflows:theory, similarity.InISMIR,pages107–114,2003.\nalgorithmsandapplications.PrenticeHall,1993. [29] L.H.U,K.Mouratidis,M.L.Yiu,andN.Mamoulis.Optimal\n[2] A.Andoni,K.D.Ba,P.Indyk,andD.P.Woodruff.Efficientsketches matchingbetweenspatialdatasetsundercapacityconstraints.ACM\nforearth-moverdistance,withapplications.InFOCS,pages Trans.DatabaseSyst.,35(2),2010.\n324–330,2009. [30] M.Wichterich,I.Assent,P.Kranen,andT.Seidl.Efficient\n[3] A.Andoni,P.Indyk,andR.Krauthgamer.Earthmoverdistanceover EMD-basedsimilaritysearchinmultimediadatabasesviaflexible\nhigh-dimensionalspaces.InSODA,pages343–352,2008. dimensionalityreduction.InSIGMOD,pages199–212,2008.\n[4] D.Applegate,T.Dasu,S.Krishnan,andS.Urbanek.Unsupervised [31] J.Xu,Q.Bai,Y.Gu,A.K.H.Tung,G.Wang,G.Yu,andZ.Zhang.\nclusteringofmultidimensionaldistributionsusingearthmover EUDEMON:Asystemforonlinevideoframecopydetectionby\ndistance.InKDD,pages636–644,2011. earthmover’sdistance.InICDE,pages1233–1236,2012.\n[5] I.Assent,A.Wenning,andT.Seidl.Approximationtechniquesfor [32] J.Xu,Z.Zhang,A.K.H.Tung,andG.Yu.Efficientandeffective\nindexingtheearthmover’sdistanceinmultimediadatabases.In similaritysearchoverprobabilisticdatabasedonearthmover’s\nICDE,page11,2006. distance.PVLDB,3(1):758–769,2010.\n324\n",
      "summary": "This paper proposes efficient techniques for computing Earth Mover's Distance (EMD) in similarity queries by adapting spatial matching algorithms, introducing a progressive refinement strategy with early pruning, and concurrently processing multiple candidates to improve performance, especially for large datasets."
    }
  ]
}